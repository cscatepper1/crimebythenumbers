<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Scraping Tables from PDFs | R 4 Criminology</title>
  <meta name="description" content="These notes introduce the programming language R and are meant for undergrads or graduate students studying criminology. R is a programming language that is well-suited to the type of work frequently done in criminology - taking messy data and turning it into useful information such as cleaning the data, graphing it, or running statistical tests on the data. While R is a useful tool for many fields of study, this book focuses on the skills criminologists should know and uses crime data for the example data sets." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Scraping Tables from PDFs | R 4 Criminology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r4crim.com" />
  <meta property="og:image" content="https://r4crim.comRuby-throated_HummingBird.jpg" />
  <meta property="og:description" content="These notes introduce the programming language R and are meant for undergrads or graduate students studying criminology. R is a programming language that is well-suited to the type of work frequently done in criminology - taking messy data and turning it into useful information such as cleaning the data, graphing it, or running statistical tests on the data. While R is a useful tool for many fields of study, this book focuses on the skills criminologists should know and uses crime data for the example data sets." />
  <meta name="github-repo" content="jacobkap/r4crim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Scraping Tables from PDFs | R 4 Criminology" />
  
  <meta name="twitter:description" content="These notes introduce the programming language R and are meant for undergrads or graduate students studying criminology. R is a programming language that is well-suited to the type of work frequently done in criminology - taking messy data and turning it into useful information such as cleaning the data, graphing it, or running statistical tests on the data. While R is a useful tool for many fields of study, this book focuses on the skills criminologists should know and uses crime data for the example data sets." />
  <meta name="twitter:image" content="https://r4crim.comRuby-throated_HummingBird.jpg" />

<meta name="author" content="Jacob Kaplan" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scraping-data-from-pdfs.html">
<link rel="next" href="geocoding.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99359926-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99359926-6');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Criminology</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-will-learn"><i class="fa fa-check"></i>What you will learn</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i>Skills</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i>Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-wont-learn"><i class="fa fa-check"></i>What you won’t learn</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#simple-vs-easy"><i class="fa fa-check"></i>Simple vs Easy</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to Contribute</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#why-learn-to-program"><i class="fa fa-check"></i><b>1.1</b> Why learn to program?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#scale"><i class="fa fa-check"></i><b>1.1.1</b> Scale</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#reproducibility"><i class="fa fa-check"></i><b>1.1.2</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-rstudio"><i class="fa fa-check"></i><b>1.2</b> Using RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#opening-an-r-script"><i class="fa fa-check"></i><b>1.2.1</b> Opening an R Script</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#setting-the-working-directory"><i class="fa fa-check"></i><b>1.2.2</b> Setting the working directory</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#changing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Changing RStudio</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#helpful-cheatsheets"><i class="fa fa-check"></i><b>1.2.4</b> Helpful cheatsheets</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.3</b> Reading data into R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#loading-data"><i class="fa fa-check"></i><b>1.3.1</b> Loading data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#first-steps-to-exploring-data"><i class="fa fa-check"></i><b>1.4</b> First steps to exploring data</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#finding-help-about-functions"><i class="fa fa-check"></i><b>1.5</b> Finding help about functions</a></li>
</ul></li>
<li class="part"><span><b>I Clean</b></span></li>
<li class="chapter" data-level="2" data-path="subsetting-intro.html"><a href="subsetting-intro.html"><i class="fa fa-check"></i><b>2</b> Subsetting: Making big things small</a><ul>
<li class="chapter" data-level="2.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-values"><i class="fa fa-check"></i><b>2.1</b> Select specific values</a></li>
<li class="chapter" data-level="2.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#assignment"><i class="fa fa-check"></i><b>2.2</b> Assignment values to objects (Making “things”)</a></li>
<li class="chapter" data-level="2.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#vectors"><i class="fa fa-check"></i><b>2.3</b> Vectors (collections of “things”)</a></li>
<li class="chapter" data-level="2.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#logical-values-and-operations"><i class="fa fa-check"></i><b>2.4</b> Logical values and operations</a><ul>
<li class="chapter" data-level="2.4.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#matching-a-single-value"><i class="fa fa-check"></i><b>2.4.1</b> Matching a single value</a></li>
<li class="chapter" data-level="2.4.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#matching-multiple-values"><i class="fa fa-check"></i><b>2.4.2</b> Matching multiple values</a></li>
<li class="chapter" data-level="2.4.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#does-not-match"><i class="fa fa-check"></i><b>2.4.3</b> Does not match</a></li>
<li class="chapter" data-level="2.4.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#greater-than-or-less-than"><i class="fa fa-check"></i><b>2.4.4</b> Greater than or less than</a></li>
<li class="chapter" data-level="2.4.5" data-path="subsetting-intro.html"><a href="subsetting-intro.html#combining-conditional-statements---or-and"><i class="fa fa-check"></i><b>2.4.5</b> Combining conditional statements - or, and</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="subsetting-intro.html"><a href="subsetting-intro.html#subsetting-a-data.frame"><i class="fa fa-check"></i><b>2.5</b> Subsetting a data.frame</a><ul>
<li class="chapter" data-level="2.5.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-columns"><i class="fa fa-check"></i><b>2.5.1</b> Select specific columns</a></li>
<li class="chapter" data-level="2.5.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-rows"><i class="fa fa-check"></i><b>2.5.2</b> Select specific rows</a></li>
<li class="chapter" data-level="2.5.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#battleships"><i class="fa fa-check"></i><b>2.5.3</b> Battleships</a></li>
<li class="chapter" data-level="2.5.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#subset-colorado-data"><i class="fa fa-check"></i><b>2.5.4</b> Subset Colorado data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="explore.html"><a href="explore.html"><i class="fa fa-check"></i><b>3</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="explore.html"><a href="explore.html#summary-and-table"><i class="fa fa-check"></i><b>3.1</b> Summary and Table</a></li>
<li class="chapter" data-level="3.2" data-path="explore.html"><a href="explore.html#graphing"><i class="fa fa-check"></i><b>3.2</b> Graphing</a></li>
<li class="chapter" data-level="3.3" data-path="explore.html"><a href="explore.html#aggregate"><i class="fa fa-check"></i><b>3.3</b> Aggregating (summaries of groups)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>4</b> Dates and times</a><ul>
<li class="chapter" data-level="4.1" data-path="dates-and-times.html"><a href="dates-and-times.html#why-do-dates-and-times-matter"><i class="fa fa-check"></i><b>4.1</b> Why do dates and times matter?</a></li>
<li class="chapter" data-level="4.2" data-path="dates-and-times.html"><a href="dates-and-times.html#lubridate"><i class="fa fa-check"></i><b>4.2</b> <code>lubridate</code></a></li>
<li class="chapter" data-level="4.3" data-path="dates-and-times.html"><a href="dates-and-times.html#working-with-dates"><i class="fa fa-check"></i><b>4.3</b> Working with dates</a></li>
<li class="chapter" data-level="4.4" data-path="dates-and-times.html"><a href="dates-and-times.html#chicago-crime-data"><i class="fa fa-check"></i><b>4.4</b> Chicago crime data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises"><i class="fa fa-check"></i><b>4.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>5</b> Regular Expressions</a><ul>
<li class="chapter" data-level="5.1" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-patterns-in-text-with-grep"><i class="fa fa-check"></i><b>5.1</b> Finding patterns in text with <code>grep()</code></a></li>
<li class="chapter" data-level="5.2" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-and-replacing-patterns-in-text-with-gsub"><i class="fa fa-check"></i><b>5.2</b> Finding and replacing patterns in text with <code>gsub()</code></a></li>
<li class="chapter" data-level="5.3" data-path="regular-expressions.html"><a href="regular-expressions.html#useful-special-characters"><i class="fa fa-check"></i><b>5.3</b> Useful special characters</a><ul>
<li class="chapter" data-level="5.3.1" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-characters"><i class="fa fa-check"></i><b>5.3.1</b> Multiple characters <code>[]</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-of-previous-character-n"><i class="fa fa-check"></i><b>5.3.2</b> n-many of previous character <code>{n}</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-to-m-many-of-previous-character-nm"><i class="fa fa-check"></i><b>5.3.3</b> n-many to m-many of previous character <code>{n,m}</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="regular-expressions.html"><a href="regular-expressions.html#start-of-string-and-not"><i class="fa fa-check"></i><b>5.3.4</b> Start of string and “not” <code>^</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="regular-expressions.html"><a href="regular-expressions.html#end-of-string"><i class="fa fa-check"></i><b>5.3.5</b> End of string <code>$</code></a></li>
<li class="chapter" data-level="5.3.6" data-path="regular-expressions.html"><a href="regular-expressions.html#anything-."><i class="fa fa-check"></i><b>5.3.6</b> Anything <code>.</code></a></li>
<li class="chapter" data-level="5.3.7" data-path="regular-expressions.html"><a href="regular-expressions.html#one-or-more-of-previous"><i class="fa fa-check"></i><b>5.3.7</b> One or more of previous <code>+</code></a></li>
<li class="chapter" data-level="5.3.8" data-path="regular-expressions.html"><a href="regular-expressions.html#zero-or-more-of-previous"><i class="fa fa-check"></i><b>5.3.8</b> Zero or more of previous <code>*</code></a></li>
<li class="chapter" data-level="5.3.9" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-patterns"><i class="fa fa-check"></i><b>5.3.9</b> Multiple patterns <code>|</code></a></li>
<li class="chapter" data-level="5.3.10" data-path="regular-expressions.html"><a href="regular-expressions.html#parentheses"><i class="fa fa-check"></i><b>5.3.10</b> Parentheses <code>()</code></a></li>
<li class="chapter" data-level="5.3.11" data-path="regular-expressions.html"><a href="regular-expressions.html#optional-text"><i class="fa fa-check"></i><b>5.3.11</b> Optional text <code>?</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regular-expressions.html"><a href="regular-expressions.html#changing-capitalization"><i class="fa fa-check"></i><b>5.4</b> Changing capitalization</a></li>
</ul></li>
<li class="part"><span><b>II Collect</b></span></li>
<li class="chapter" data-level="6" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html"><i class="fa fa-check"></i><b>6</b> Webscraping with <code>rvest</code></a><ul>
<li class="chapter" data-level="6.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#scraping-one-page"><i class="fa fa-check"></i><b>6.1</b> Scraping one page</a></li>
<li class="chapter" data-level="6.2" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#cleaning-the-webscraped-data"><i class="fa fa-check"></i><b>6.2</b> Cleaning the webscraped data</a></li>
<li class="chapter" data-level="6.3" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#fixing-names"><i class="fa fa-check"></i><b>6.3</b> Fixing names</a><ul>
<li class="chapter" data-level="6.3.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#exercises-1"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="functions.html"><a href="functions.html#a-simple-function"><i class="fa fa-check"></i><b>7.1</b> A simple function</a></li>
<li class="chapter" data-level="7.2" data-path="functions.html"><a href="functions.html#adding-parameters"><i class="fa fa-check"></i><b>7.2</b> Adding parameters</a></li>
<li class="chapter" data-level="7.3" data-path="functions.html"><a href="functions.html#movie_function"><i class="fa fa-check"></i><b>7.3</b> Making a function to scrape movie data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>8</b> For loops</a><ul>
<li class="chapter" data-level="8.1" data-path="for-loops.html"><a href="for-loops.html#basic-for-loops"><i class="fa fa-check"></i><b>8.1</b> Basic for loops</a></li>
<li class="chapter" data-level="8.2" data-path="for-loops.html"><a href="for-loops.html#scraping-multiple-days-of-movie-data"><i class="fa fa-check"></i><b>8.2</b> Scraping multiple days of movie data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>9</b> Reading and Writing Data</a><ul>
<li class="chapter" data-level="9.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-data-into-r-1"><i class="fa fa-check"></i><b>9.1</b> Reading Data into R</a><ul>
<li class="chapter" data-level="9.1.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r"><i class="fa fa-check"></i><b>9.1.1</b> R</a></li>
<li class="chapter" data-level="9.1.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel"><i class="fa fa-check"></i><b>9.1.2</b> Excel</a></li>
<li class="chapter" data-level="9.1.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata"><i class="fa fa-check"></i><b>9.1.3</b> Stata</a></li>
<li class="chapter" data-level="9.1.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas"><i class="fa fa-check"></i><b>9.1.4</b> SAS</a></li>
<li class="chapter" data-level="9.1.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#spss"><i class="fa fa-check"></i><b>9.1.5</b> SPSS</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-data"><i class="fa fa-check"></i><b>9.2</b> Writing Data</a><ul>
<li class="chapter" data-level="9.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-1"><i class="fa fa-check"></i><b>9.2.1</b> R</a></li>
<li class="chapter" data-level="9.2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-1"><i class="fa fa-check"></i><b>9.2.2</b> Excel</a></li>
<li class="chapter" data-level="9.2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-1"><i class="fa fa-check"></i><b>9.2.3</b> Stata</a></li>
<li class="chapter" data-level="9.2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-1"><i class="fa fa-check"></i><b>9.2.4</b> SAS</a></li>
<li class="chapter" data-level="9.2.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#spss-1"><i class="fa fa-check"></i><b>9.2.5</b> SPSS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html"><i class="fa fa-check"></i><b>10</b> Scraping data from PDFs</a><ul>
<li class="chapter" data-level="10.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#downloading-officer-involved-shooting-files"><i class="fa fa-check"></i><b>10.1</b> Downloading officer-involved Shooting Files</a></li>
<li class="chapter" data-level="10.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-information-from-the-page"><i class="fa fa-check"></i><b>10.2</b> Scraping information from the page</a><ul>
<li class="chapter" data-level="10.2.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#combining-the-data-sets"><i class="fa fa-check"></i><b>10.2.1</b> Combining the data sets</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#extracting-data-from-pdfs"><i class="fa fa-check"></i><b>10.3</b> Extracting data from PDFs</a><ul>
<li class="chapter" data-level="10.3.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-a-single-pdf"><i class="fa fa-check"></i><b>10.3.1</b> Scraping a single PDF</a></li>
<li class="chapter" data-level="10.3.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#making-a-function"><i class="fa fa-check"></i><b>10.3.2</b> Making a function</a></li>
<li class="chapter" data-level="10.3.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#looping-through-every-pdf"><i class="fa fa-check"></i><b>10.3.3</b> Looping through every PDF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="scrape-table.html"><a href="scrape-table.html"><i class="fa fa-check"></i><b>11</b> Scraping Tables from PDFs</a><ul>
<li class="chapter" data-level="11.1" data-path="scrape-table.html"><a href="scrape-table.html#scraping-the-first-table"><i class="fa fa-check"></i><b>11.1</b> Scraping the first table</a></li>
<li class="chapter" data-level="11.2" data-path="scrape-table.html"><a href="scrape-table.html#making-a-function-1"><i class="fa fa-check"></i><b>11.2</b> Making a function</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>12</b> Geocoding</a><ul>
<li class="chapter" data-level="12.1" data-path="geocoding.html"><a href="geocoding.html#geocoding-a-single-address"><i class="fa fa-check"></i><b>12.1</b> Geocoding a single address</a></li>
<li class="chapter" data-level="12.2" data-path="geocoding.html"><a href="geocoding.html#making-a-function-2"><i class="fa fa-check"></i><b>12.2</b> Making a function</a></li>
<li class="chapter" data-level="12.3" data-path="geocoding.html"><a href="geocoding.html#geocoding-officer-shooting-locations"><i class="fa fa-check"></i><b>12.3</b> Geocoding officer shooting locations</a></li>
</ul></li>
<li class="part"><span><b>III Visualize</b></span></li>
<li class="chapter" data-level="13" data-path="graphing-intro.html"><a href="graphing-intro.html"><i class="fa fa-check"></i><b>13</b> Graphing with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="13.1" data-path="graphing-intro.html"><a href="graphing-intro.html#what-does-the-data-look-like"><i class="fa fa-check"></i><b>13.1</b> What does the data look like?</a></li>
<li class="chapter" data-level="13.2" data-path="graphing-intro.html"><a href="graphing-intro.html#graphing-data"><i class="fa fa-check"></i><b>13.2</b> Graphing data</a></li>
<li class="chapter" data-level="13.3" data-path="graphing-intro.html"><a href="graphing-intro.html#time-series-plots"><i class="fa fa-check"></i><b>13.3</b> Time-Series Plots</a></li>
<li class="chapter" data-level="13.4" data-path="graphing-intro.html"><a href="graphing-intro.html#color-blindness"><i class="fa fa-check"></i><b>13.4</b> Color blindness</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hotspot-maps.html"><a href="hotspot-maps.html"><i class="fa fa-check"></i><b>14</b> Hotspot maps</a><ul>
<li class="chapter" data-level="14.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#a-simple-map"><i class="fa fa-check"></i><b>14.1</b> A simple map</a></li>
<li class="chapter" data-level="14.2" data-path="hotspot-maps.html"><a href="hotspot-maps.html#what-really-are-maps"><i class="fa fa-check"></i><b>14.2</b> What really are maps?</a></li>
<li class="chapter" data-level="14.3" data-path="hotspot-maps.html"><a href="hotspot-maps.html#making-a-hotspot-map"><i class="fa fa-check"></i><b>14.3</b> Making a hotspot map</a><ul>
<li class="chapter" data-level="14.3.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#colors"><i class="fa fa-check"></i><b>14.3.1</b> Colors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="hotspot-maps.html"><a href="hotspot-maps.html#looping-through-each-year"><i class="fa fa-check"></i><b>14.4</b> Looping through each year</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="choropleth-maps.html"><a href="choropleth-maps.html"><i class="fa fa-check"></i><b>15</b> Choropleth maps</a><ul>
<li class="chapter" data-level="15.1" data-path="choropleth-maps.html"><a href="choropleth-maps.html#spatial-joins"><i class="fa fa-check"></i><b>15.1</b> Spatial joins</a></li>
<li class="chapter" data-level="15.2" data-path="choropleth-maps.html"><a href="choropleth-maps.html#making-choropleth-maps"><i class="fa fa-check"></i><b>15.2</b> Making choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>16</b> Interactive maps</a><ul>
<li class="chapter" data-level="16.1" data-path="interactive-maps.html"><a href="interactive-maps.html#why-do-interactive-graphs-matter"><i class="fa fa-check"></i><b>16.1</b> Why do interactive graphs matter?</a><ul>
<li class="chapter" data-level="16.1.1" data-path="interactive-maps.html"><a href="interactive-maps.html#understanding-your-data"><i class="fa fa-check"></i><b>16.1.1</b> Understanding your data</a></li>
<li class="chapter" data-level="16.1.2" data-path="interactive-maps.html"><a href="interactive-maps.html#police-departments-use-them"><i class="fa fa-check"></i><b>16.1.2</b> Police departments use them</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="interactive-maps.html"><a href="interactive-maps.html#making-the-interactive-map"><i class="fa fa-check"></i><b>16.2</b> Making the interactive map</a></li>
<li class="chapter" data-level="16.3" data-path="interactive-maps.html"><a href="interactive-maps.html#adding-popup-information"><i class="fa fa-check"></i><b>16.3</b> Adding popup information</a></li>
<li class="chapter" data-level="16.4" data-path="interactive-maps.html"><a href="interactive-maps.html#dealing-with-too-many-markers"><i class="fa fa-check"></i><b>16.4</b> Dealing with too many markers</a></li>
<li class="chapter" data-level="16.5" data-path="interactive-maps.html"><a href="interactive-maps.html#interactive-choropleth-maps"><i class="fa fa-check"></i><b>16.5</b> Interactive choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ois-graphs.html"><a href="ois-graphs.html"><i class="fa fa-check"></i><b>17</b> More graphing with <code>ggplot</code></a><ul>
<li class="chapter" data-level="17.1" data-path="ois-graphs.html"><a href="ois-graphs.html#graphing-a-single-variable"><i class="fa fa-check"></i><b>17.1</b> Graphing a single variable</a><ul>
<li class="chapter" data-level="17.1.1" data-path="ois-graphs.html"><a href="ois-graphs.html#numeric-variable"><i class="fa fa-check"></i><b>17.1.1</b> Numeric variable</a></li>
<li class="chapter" data-level="17.1.2" data-path="ois-graphs.html"><a href="ois-graphs.html#categorical-variable"><i class="fa fa-check"></i><b>17.1.2</b> Categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="ois-graphs.html"><a href="ois-graphs.html#time-series"><i class="fa fa-check"></i><b>17.2</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>18</b> R Markdown</a><ul>
<li class="chapter" data-level="18.1" data-path="r-markdown.html"><a href="r-markdown.html#code-1"><i class="fa fa-check"></i><b>18.1</b> Code</a><ul>
<li class="chapter" data-level="18.1.1" data-path="r-markdown.html"><a href="r-markdown.html#hiding-code-in-the-output"><i class="fa fa-check"></i><b>18.1.1</b> Hiding code in the output</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="r-markdown.html"><a href="r-markdown.html#making-tables"><i class="fa fa-check"></i><b>18.2</b> Making tables</a></li>
<li class="chapter" data-level="18.3" data-path="r-markdown.html"><a href="r-markdown.html#making-the-output-file"><i class="fa fa-check"></i><b>18.3</b> Making the output file</a></li>
</ul></li>
<li class="part"><span><b>IV Data</b></span></li>
<li class="chapter" data-level="19" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>19</b> Introduction</a></li>
<li class="chapter" data-level="20" data-path="ucr.html"><a href="ucr.html"><i class="fa fa-check"></i><b>20</b> Uniform Crime Report (UCR) Data - Offenses Known and Clearances by Arrest</a><ul>
<li class="chapter" data-level="20.1" data-path="ucr.html"><a href="ucr.html#exploring-the-ucr-data"><i class="fa fa-check"></i><b>20.1</b> Exploring the UCR data</a></li>
<li class="chapter" data-level="20.2" data-path="ucr.html"><a href="ucr.html#oris---unique-agency-identifies"><i class="fa fa-check"></i><b>20.2</b> ORIs - Unique agency identifies</a></li>
<li class="chapter" data-level="20.3" data-path="ucr.html"><a href="ucr.html#hierarchy-rule"><i class="fa fa-check"></i><b>20.3</b> Hierarchy Rule</a></li>
<li class="chapter" data-level="20.4" data-path="ucr.html"><a href="ucr.html#which-crimes-are-included"><i class="fa fa-check"></i><b>20.4</b> Which crimes are included</a><ul>
<li class="chapter" data-level="20.4.1" data-path="ucr.html"><a href="ucr.html#index-crimes"><i class="fa fa-check"></i><b>20.4.1</b> Index Crimes</a></li>
<li class="chapter" data-level="20.4.2" data-path="ucr.html"><a href="ucr.html#the-problem-with-using-index-crimes"><i class="fa fa-check"></i><b>20.4.2</b> The problem with using index crimes</a></li>
<li class="chapter" data-level="20.4.3" data-path="ucr.html"><a href="ucr.html#rape-definition-change"><i class="fa fa-check"></i><b>20.4.3</b> Rape definition change</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="ucr.html"><a href="ucr.html#actual-offenses-clearances-and-unfounded-offenses"><i class="fa fa-check"></i><b>20.5</b> Actual offenses, clearances, and unfounded offenses</a><ul>
<li class="chapter" data-level="20.5.1" data-path="ucr.html"><a href="ucr.html#actual"><i class="fa fa-check"></i><b>20.5.1</b> Actual</a></li>
<li class="chapter" data-level="20.5.2" data-path="ucr.html"><a href="ucr.html#total-cleared"><i class="fa fa-check"></i><b>20.5.2</b> Total Cleared</a></li>
<li class="chapter" data-level="20.5.3" data-path="ucr.html"><a href="ucr.html#cleared-where-all-offenders-are-under-18"><i class="fa fa-check"></i><b>20.5.3</b> Cleared Where All Offenders Are Under 18</a></li>
<li class="chapter" data-level="20.5.4" data-path="ucr.html"><a href="ucr.html#unfounded"><i class="fa fa-check"></i><b>20.5.4</b> Unfounded</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="census-data-from-social-explorer.html"><a href="census-data-from-social-explorer.html"><i class="fa fa-check"></i><b>21</b> Census data from Social Explorer</a><ul>
<li class="chapter" data-level="21.1" data-path="census-data-from-social-explorer.html"><a href="census-data-from-social-explorer.html#getting-census-data-from-social-explorer"><i class="fa fa-check"></i><b>21.1</b> Getting Census data from Social Explorer</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html"><i class="fa fa-check"></i><b>22</b> Census data from IPUMS</a><ul>
<li class="chapter" data-level="22.1" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#getting-ipums-data"><i class="fa fa-check"></i><b>22.1</b> Getting IPUMS data</a></li>
<li class="chapter" data-level="22.2" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#cleaning-the-data"><i class="fa fa-check"></i><b>22.2</b> Cleaning the data</a></li>
<li class="chapter" data-level="22.3" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#aggregating-the-data"><i class="fa fa-check"></i><b>22.3</b> Aggregating the data</a></li>
<li class="chapter" data-level="22.4" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#graphing-the-data"><i class="fa fa-check"></i><b>22.4</b> Graphing the data</a></li>
<li class="chapter" data-level="22.5" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#mapping-the-data"><i class="fa fa-check"></i><b>22.5</b> Mapping the data</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="nibrs.html"><a href="nibrs.html"><i class="fa fa-check"></i><b>23</b> National Incident-Based Reporting System (NIBRS) Data</a><ul>
<li class="chapter" data-level="23.1" data-path="nibrs.html"><a href="nibrs.html#downloading-the-data"><i class="fa fa-check"></i><b>23.1</b> Downloading the data</a></li>
<li class="chapter" data-level="23.2" data-path="nibrs.html"><a href="nibrs.html#reading-the-data"><i class="fa fa-check"></i><b>23.2</b> Reading the data</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="useful-resources.html"><a href="useful-resources.html"><i class="fa fa-check"></i><b>A</b> Useful resources</a><ul>
<li class="chapter" data-level="A.0.1" data-path="useful-resources.html"><a href="useful-resources.html#learning-r-and-coding-issues"><i class="fa fa-check"></i><b>A.0.1</b> Learning R and coding issues</a></li>
<li class="chapter" data-level="A.0.2" data-path="useful-resources.html"><a href="useful-resources.html#data-1"><i class="fa fa-check"></i><b>A.0.2</b> Data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 4 Criminology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scrape-table" class="section level1">
<h1><span class="header-section-number">11</span> Scraping Tables from PDFs</h1>
<p>In Chapter <a href="scraping-data-from-pdfs.html#scraping-data-from-pdfs">10</a> we began working on scraping data from a PDF. We read in PDFs from Philadelphia’s officer-involved shooting data and grabbed a single line of text from each PDF. That data was written up like a report, with the date of the incident followed by a description of what happened. In the majority of cases when you want data from a PDF it will be in a table rather than descriptive paragraph. Essentially the data will be an Excel file inside of a PDF. This format is not altogether different than what we did before. We will be using regular expressions and <code>strsplit()</code> again to handle this data.</p>
<p>Let’s first take a look at the data we will be scraping. The first step in any PDF scraping should be looking at the PDF and try to think about the best way to approach this particular problem - while all PDF scraping follows a general format you cannot necessarily copy and paste your code, each situation is likely slightly different. Our data is from the U.S. Customs and Border Protection (CBP) and contains a wealth of information about apprehensions and contraband seizures in border sectors.</p>
<p>We will be using the Sector Profile 2017 PDF which has information in four tables which we’ll scrape and then combine together. The data was downloaded on the U.S. Customs and Border Protection “Stats and Summaries” page <a href="https://www.cbp.gov/newsroom/media-resources/stats">here</a>. If you’re interested in using more of their data, some of it has been cleaned and made available <a href="https://www.openicpsr.org/openicpsr/project/109522/version/V2/view">here</a>.</p>
<p>The file we want to use is called “usbp_stats_fy2017_sector_profile.pdf” and has four tables in the PDF. Let’s take a look at them one at a time, understanding what variable are available, and what units each row is in. Then we’ll start scraping the tables.</p>
<p>The first table is “Sector Profile - Fiscal Year 2017 (Oct. 1st through Sept. 30th)”. Before we even look down more at the table, the title is important. It is for fiscal year 2017, not calendar year 2017 which is more common in the data we usually use. This is important if we ever want to merge this data with other data sets. If possible we would have to get data that is monthly so we can just use October 2016 through September 2017 to match up properly.</p>
<p><img src="images/pdf_table_1.PNG" /></p>
<p>Now if we look more at the table we can see that each row is a section of the U.S. border. There are three main sections - Coastal, Northern, and Southwest, with subsections of each also available as rows. The bottom row is the sum of all these sections and gives us nationwide data. Many government data will be like this form with sections and subsections in the same table. Watch out when doing mathematical operations! Just summing any of these columns will give you triple the true value due to the presence of nationwide, sectional, and subsectional data.</p>
<p>There are 9 columns in the data other than the border section identifier. It looks like we have total apprehensions, apprehensions for people who are not Mexican citizens, marijuana and cocaine seizures (in pounds), the number of accepted prosecutions (presumably of those apprehended), and the number of CBP agents assaulted. The last two columns have the number of people rescued by CBP and the number of people who died (it is unclear from this data alone if this is solely people in custody or deaths during crossing the border). These two columns are also special as they only have data for the Southwest border.</p>
<p>Table 2 has a similar format with each row being a section or subsection. The columns now have the number of juveniles apprehended, subdivided by if they were accompanied by an adult or not, and the number of adults apprehended. The last column is total apprehensions which is a duplicated column as in Table 1.</p>
<p><img src="images/pdf_table_2.PNG" /></p>
<p>Table 3 follows the same format and the new columns are number of apprehensions by gender.</p>
<p><img src="images/pdf_table_3.PNG" /></p>
<p>Finally, Table 4 is a bit different in it’s format. The rows are now variables and the columns are the locations. In this table it doesn’t include subsections, only border sections and nationwide total. The data it has available are partially a repeat of Table 1 but with more drug types and the addition of the number of drug seizures and some firearm seizure information.</p>
<p><img src="images/pdf_table_4.PNG" /></p>
<div id="scraping-the-first-table" class="section level2">
<h2><span class="header-section-number">11.1</span> Scraping the first table</h2>
<p>We’ve now seen all four of the tables that we want to scrape so we can begin the process of actually scraping them. Note that each table is similar (particularly Tables 1-3), meaning we can reuse code to scrape as well as clean the data. That means that we will want to write some functions to make our work easier and avoid copy and pasting code three times. As earlier, we will use the <code>pdf_text()</code> function from the <code>pdftools</code> package to scrape the PDFs.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pdftools)</code></pre>
<p>We can save the output of the <code>pdf_text()</code> function as “border_patrol” and we’ll use it for each table.</p>
<pre class="sourceCode r"><code class="sourceCode r">border_patrol &lt;-<span class="st"> </span><span class="kw">pdf_text</span>(<span class="st">&quot;data/usbp_stats_fy2017_sector_profile.pdf&quot;</span>)</code></pre>
<p>We can take a look at the <code>head()</code> of the result.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(border_patrol)
<span class="co">#&gt; [1] &quot;                                                            United States Border Patrol\r\n                                                             Sector Profile - Fiscal Year 2017 (Oct. 1st through Sept. 30th)\r\n                                                  Agent                              Other Than Mexican           Marijuana          Cocaine         Accepted\r\n              SECTOR                            Staffing*\r\n                                                             Apprehensions\r\n                                                                                       Apprehensions                (pounds)          (pounds)    Prosecutions\r\n                                                                                                                                                                      Assaults Rescues       Deaths\r\n Miami                                             111               2,280                    1,646                   2,253             231              292               1           N/A     N/A\r\n New Orleans                                        63                920                      528                      21                6               10               0           N/A     N/A\r\n Ramey                                              38                388                      387                       3             2,932              89               0           N/A     N/A\r\n Coastal Border Sectors Total                      212               3,588                    2,561                   2,277            3,169             391               1        N/A **** N/A ****\r\n Blaine                                            296                288                      237                       0                0                9               0           N/A     N/A\r\n Buffalo                                           277                447                      293                     228               2                37               2           N/A     N/A\r\n Detroit                                           408               1,070                     322                     124               0                85               1           N/A     N/A\r\n Grand Forks                                       189                496                      202                       0                0               40               2           N/A     N/A\r\n Havre                                             183                 39                       28                      98                0                2               0           N/A     N/A\r\n Houlton                                           173                 30                       30                      17                0                2               0           N/A     N/A\r\n Spokane                                           230                208                       67                      68                0               24               0           N/A     N/A\r\n Swanton                                           292                449                      359                     531                1              103               6           N/A     N/A\r\n Northern Border Sectors Total                    2,048              3,027                    1,538                   1,066               3              302              11        N/A **** N/A ****\r\n Big Bend (formerly Marfa)                         500               6,002                   3,346                   40,852              45             2,847             11            26      1\r\n Del Rio                                          1,391             13,476                    6,156                   9,482              62             8,022             12            99     18\r\n El Centro                                         870              18,633                    5,812                   5,554             484             1,413             34             4      2\r\n El Paso                                          2,182             25,193                   15,337                  34,189             140             6,996             54            44      8\r\n Laredo                                           1,666             25,460                    7,891                  69,535             757             6,119             31          1,054    83\r\n Rio Grande Valley (formerly McAllen)             3,130            137,562                  107,909                260,020             1,192            7,979            422          1,190   104\r\n San Diego                                        2,199             26,086                    7,060                  10,985            2,903            3,099             84            48      4\r\n Tucson                                           3,691             38,657                   12,328                397,090              331            20,963             93           750     72\r\n Yuma                                              859              12,847                   10,139                  30,181             261             2,367             33             6      2\r\n Southwest Border Sectors Total**                16,605            303,916                  175,978                857,888             6,174           59,805            774          3,221   294\r\n Nationwide Total***                             19,437            310,531                  180,077                861,231             9,346           60,498            786          3,221   294\r\n* Agent staffing statistics depict FY17 on-board personnel data as of 9/30/2017\r\n** Southwest Border Sectors staffing statistics include: Big Bend, Del Rio, El Centro, El Paso, Laredo, Rio Grande Valley, San Diego, Tucson, Yuma, and the Special Operations Group.\r\n*** Nationwide staffing statistics include: All on-board Border Patrol agents in CBP\r\n**** Rescue and Death statistics are not tracked for Northern and Coastal Border Sectors.\r\n&quot;</span>
<span class="co">#&gt; [2] &quot;                                     United States Border Patrol\r\n                                     Juvenile (0-17 Years Old) and Adult Apprehensions - Fiscal Year 2017 (Oct. 1st through Sept. 30th)\r\n                                        Accompanied              Unaccompanied               Total           Total              Total\r\n              SECTOR                       Juveniles                 Juveniles             Juveniles        Adults        Apprehensions\r\nMiami                                            19                       42                   61            2,219              2,280\r\nNew Orleans                                       1                       22                   23              897               920\r\nRamey                                             7                        1                    8              380               388\r\nCoastal Border Sectors Total                     27                       65                   92            3,496              3,588\r\nBlaine                                           29                        7                   36              252               288\r\nBuffalo                                           3                        3                    6              441               447\r\nDetroit                                           5                       11                   16            1,054              1,070\r\nGrand Forks                                       5                        4                    9              487               496\r\nHavre                                             1                        3                    4              35                 39\r\nHoulton                                           1                        8                    9              21                 30\r\nSpokane                                           3                        0                    3              205               208\r\nSwanton                                          18                       10                   28              421               449\r\nNorthern Border Sectors Total                    65                       46                  111             2,916             3,027\r\nBig Bend (formerly Marfa)                       506                      811                 1,317           4,685              6,002\r\nDel Rio                                        1,348                    1,349                2,697           10,779             13,476\r\nEl Centro                                       968                     1,531                2,499           16,134             18,633\r\nEl Paso                                        4,642                    3,926                8,568           16,625             25,193\r\nLaredo                                          477                     2,033                2,510           22,950             25,460\r\nRio Grande Valley (formerly McAllen)          27,222                   23,708                50,930          86,632            137,562\r\nSan Diego                                      1,639                    1,551                3,190           22,896             26,086\r\nTucson                                         1,088                    3,659                4,747           33,910             38,657\r\nYuma                                           3,241                    2,867                6,108           6,739              12,847\r\nSouthwest Border Sectors Total                41,131                   41,435                82,566         221,350            303,916\r\nNationwide Total                              41,223                   41,546                82,769         227,762            310,531\r\n&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </span>
<span class="co">#&gt; [3] &quot;                                     United States Border Patrol\r\n                                     Apprehensions by Gender - Fiscal Year 2017 (Oct. 1st through Sept. 30th)\r\n             SECTOR                         Female                       Male            Total Apprehensions\r\nMiami                                          219                      2,061                     2,280\r\nNew Orleans                                    92                         828                      920\r\nRamey                                          65                         323                      388\r\nCoastal Border Sectors Total                   376                      3,212                     3,588\r\nBlaine                                         97                         191                      288\r\nBuffalo                                         69                        378                      447\r\nDetroit                                         78                        992                     1,070\r\nGrand Forks                                     56                        440                      496\r\nHavre                                           13                         26                       39\r\nHoulton                                         17                         13                       30\r\nSpokane                                         17                        191                      208\r\nSwanton                                        106                        343                      449\r\nNorthern Border Sectors Total                  453                       2,574                    3,027\r\nBig Bend (formerly Marfa)                      985                      5,017                     6,002\r\nDel Rio                                      2,622                      10,854                    13,476\r\nEl Centro                                    2,791                      15,842                    18,633\r\nEl Paso                                      7,364                      17,829                    25,193\r\nLaredo                                       3,651                      21,809                    25,460\r\nRio Grande Valley (formerly McAllen)         50,306                     87,256                   137,562\r\nSan Diego                                    4,117                      21,969                    26,086\r\nTucson                                       4,693                      33,964                    38,657\r\nYuma                                         4,328                      8,519                     12,847\r\nSouthwest Border Sectors Total               80,857                    223,059                   303,916\r\nNationwide Total                             81,686                    228,845                   310,531\r\n&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </span>
<span class="co">#&gt; [4] &quot;                                              United States Border Patrol\r\n                                               Apprehensions / Seizure Statistics - Fiscal Year 2017 (Oct. 1st through Sept. 30th)\r\n     Apprehension/Seizure Type                  Coastal Border Sectors       Northern Border Sectors        Southwest Border Sectors Nationwide Total\r\n Apprehensions                                           3,588                           3,027                        303,916             310,531\r\n Other Than Mexican Apprehensions                        2,561                           1,538                        175,978             180,077\r\n Marijuana (pounds)                                      2,277                           1,066                        857,888             861,231\r\n Cocaine (pounds)                                        3,169                              3                          6,174               9,346\r\n Heroin (ounces)                                            0                              62                          15,182              15,244\r\n Methamphetamine (pounds)                                  23                              32                          10,273              10,328\r\n Ecstasy (pounds)                                           0                               0                             1                   1\r\n Other Drugs* (pounds)                                      0                              14                           554                 568\r\n Marijuana Seizures                                       113                             255                          9,371               9,739\r\n Cocaine Seizures                                          33                              46                           463                 542\r\n Heroin Seizures                                            0                              29                           219                 248\r\n Methamphetamine Seizures                                   2                              68                           809                 879\r\n Ecstasy Seizures                                           1                               2                            48                  51\r\n Other Drugs* Seizures                                      6                              99                           735                 840\r\n Conveyances                                               86                              79                          7,388               7,553\r\n Firearms                                                   9                              45                           369                 423\r\n Ammunition (rounds)                                      217                             384                          13,938              14,539\r\n Currency (value)                                      $325,129                       $374,282                      $5,169,593          $5,869,004\r\n*Other Drugs include: All USBP drug seizures excluding marijuana, cocaine, heroin, methamphetamine, and ecstasy (MDMA).\r\nCoastal Border Sectors include: Miami, New Orleans, and Ramey, Puerto Rico.\r\nNorthern Border Sectors include: Blaine, Buffalo, Detroit, Grand Forks, Havre, Houlton, Spokane and Swanton.\r\nSouthwest Border Sectors include: Big Bend, Del Rio, El Centro, El Paso, Laredo, Rio Grande Valley, San Diego, Tucson, and Yuma.\r\nDrug quantities are rounded to the nearest whole number\r\n&quot;</span></code></pre>
<p>If you look closely in this huge amount of text output, you can see that it is a vector with each element being an element in the vector. We can see this further by checking the <code>length()</code> of “border_patrol” and just looking at the first element.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(border_patrol)
<span class="co">#&gt; [1] 4</span></code></pre>
<p>It is four elements long, one for each table.</p>
<pre class="sourceCode r"><code class="sourceCode r">border_patrol[<span class="dv">1</span>]
<span class="co">#&gt; [1] &quot;                                                            United States Border Patrol\r\n                                                             Sector Profile - Fiscal Year 2017 (Oct. 1st through Sept. 30th)\r\n                                                  Agent                              Other Than Mexican           Marijuana          Cocaine         Accepted\r\n              SECTOR                            Staffing*\r\n                                                             Apprehensions\r\n                                                                                       Apprehensions                (pounds)          (pounds)    Prosecutions\r\n                                                                                                                                                                      Assaults Rescues       Deaths\r\n Miami                                             111               2,280                    1,646                   2,253             231              292               1           N/A     N/A\r\n New Orleans                                        63                920                      528                      21                6               10               0           N/A     N/A\r\n Ramey                                              38                388                      387                       3             2,932              89               0           N/A     N/A\r\n Coastal Border Sectors Total                      212               3,588                    2,561                   2,277            3,169             391               1        N/A **** N/A ****\r\n Blaine                                            296                288                      237                       0                0                9               0           N/A     N/A\r\n Buffalo                                           277                447                      293                     228               2                37               2           N/A     N/A\r\n Detroit                                           408               1,070                     322                     124               0                85               1           N/A     N/A\r\n Grand Forks                                       189                496                      202                       0                0               40               2           N/A     N/A\r\n Havre                                             183                 39                       28                      98                0                2               0           N/A     N/A\r\n Houlton                                           173                 30                       30                      17                0                2               0           N/A     N/A\r\n Spokane                                           230                208                       67                      68                0               24               0           N/A     N/A\r\n Swanton                                           292                449                      359                     531                1              103               6           N/A     N/A\r\n Northern Border Sectors Total                    2,048              3,027                    1,538                   1,066               3              302              11        N/A **** N/A ****\r\n Big Bend (formerly Marfa)                         500               6,002                   3,346                   40,852              45             2,847             11            26      1\r\n Del Rio                                          1,391             13,476                    6,156                   9,482              62             8,022             12            99     18\r\n El Centro                                         870              18,633                    5,812                   5,554             484             1,413             34             4      2\r\n El Paso                                          2,182             25,193                   15,337                  34,189             140             6,996             54            44      8\r\n Laredo                                           1,666             25,460                    7,891                  69,535             757             6,119             31          1,054    83\r\n Rio Grande Valley (formerly McAllen)             3,130            137,562                  107,909                260,020             1,192            7,979            422          1,190   104\r\n San Diego                                        2,199             26,086                    7,060                  10,985            2,903            3,099             84            48      4\r\n Tucson                                           3,691             38,657                   12,328                397,090              331            20,963             93           750     72\r\n Yuma                                              859              12,847                   10,139                  30,181             261             2,367             33             6      2\r\n Southwest Border Sectors Total**                16,605            303,916                  175,978                857,888             6,174           59,805            774          3,221   294\r\n Nationwide Total***                             19,437            310,531                  180,077                861,231             9,346           60,498            786          3,221   294\r\n* Agent staffing statistics depict FY17 on-board personnel data as of 9/30/2017\r\n** Southwest Border Sectors staffing statistics include: Big Bend, Del Rio, El Centro, El Paso, Laredo, Rio Grande Valley, San Diego, Tucson, Yuma, and the Special Operations Group.\r\n*** Nationwide staffing statistics include: All on-board Border Patrol agents in CBP\r\n**** Rescue and Death statistics are not tracked for Northern and Coastal Border Sectors.\r\n&quot;</span></code></pre>
<p>And this gives us all the values in the first table plus a few sentences at the end detailing some features of the table. At the end of each line (where in the PDF it should end but doesn’t in our data yet) there is a <code>\r\n</code> indicating that there should be a new line. As we did last time, we want to use <code>strsplit()</code> to split at the <code>\n</code>. Let’s save a new object with the value in the first element of “border_patrol”, calling it “sector_profile” as that’s the name of that table, and then using <code>strsplit()</code> on it. <code>strsplit()</code> returns a list so we will also want to keep just the first element of that using double square bracket [[]] notation.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile &lt;-<span class="st"> </span>border_patrol[<span class="dv">1</span>]
sector_profile &lt;-<span class="st"> </span><span class="kw">strsplit</span>(sector_profile, <span class="st">&quot;</span><span class="ch">\r\n</span><span class="st">&quot;</span>)
sector_profile &lt;-<span class="st"> </span>sector_profile[[<span class="dv">1</span>]]</code></pre>
<p>Now we can look at the first six rows of this data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sector_profile)
<span class="co">#&gt; [1] &quot;                                                            United States Border Patrol&quot;                                                                       </span>
<span class="co">#&gt; [2] &quot;                                                             Sector Profile - Fiscal Year 2017 (Oct. 1st through Sept. 30th)&quot;                                  </span>
<span class="co">#&gt; [3] &quot;                                                  Agent                              Other Than Mexican           Marijuana          Cocaine         Accepted&quot; </span>
<span class="co">#&gt; [4] &quot;              SECTOR                            Staffing*&quot;                                                                                                     </span>
<span class="co">#&gt; [5] &quot;                                                             Apprehensions&quot;                                                                                    </span>
<span class="co">#&gt; [6] &quot;                                                                                       Apprehensions                (pounds)          (pounds)    Prosecutions&quot;</span></code></pre>
<p>Notice that there is a lot of empty white space at the beginning of the rows. We want to get rid of that to make our next steps easier. We can use <code>trimws()</code> and put the entire “sector_profile” data in the () and it’ll remove the white space at the ends of each line for us.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile &lt;-<span class="st"> </span><span class="kw">trimws</span>(sector_profile)</code></pre>
<p>We have more rows than we want so let’s look at the entire data and try to figure out how to keep just the necessary rows.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile
<span class="co">#&gt;  [1] &quot;United States Border Patrol&quot;                                                                                                                                                                         </span>
<span class="co">#&gt;  [2] &quot;Sector Profile - Fiscal Year 2017 (Oct. 1st through Sept. 30th)&quot;                                                                                                                                     </span>
<span class="co">#&gt;  [3] &quot;Agent                              Other Than Mexican           Marijuana          Cocaine         Accepted&quot;                                                                                         </span>
<span class="co">#&gt;  [4] &quot;SECTOR                            Staffing*&quot;                                                                                                                                                         </span>
<span class="co">#&gt;  [5] &quot;Apprehensions&quot;                                                                                                                                                                                       </span>
<span class="co">#&gt;  [6] &quot;Apprehensions                (pounds)          (pounds)    Prosecutions&quot;                                                                                                                             </span>
<span class="co">#&gt;  [7] &quot;Assaults Rescues       Deaths&quot;                                                                                                                                                                       </span>
<span class="co">#&gt;  [8] &quot;Miami                                             111               2,280                    1,646                   2,253             231              292               1           N/A     N/A&quot;   </span>
<span class="co">#&gt;  [9] &quot;New Orleans                                        63                920                      528                      21                6               10               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [10] &quot;Ramey                                              38                388                      387                       3             2,932              89               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [11] &quot;Coastal Border Sectors Total                      212               3,588                    2,561                   2,277            3,169             391               1        N/A **** N/A ****&quot;</span>
<span class="co">#&gt; [12] &quot;Blaine                                            296                288                      237                       0                0                9               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [13] &quot;Buffalo                                           277                447                      293                     228               2                37               2           N/A     N/A&quot;   </span>
<span class="co">#&gt; [14] &quot;Detroit                                           408               1,070                     322                     124               0                85               1           N/A     N/A&quot;   </span>
<span class="co">#&gt; [15] &quot;Grand Forks                                       189                496                      202                       0                0               40               2           N/A     N/A&quot;   </span>
<span class="co">#&gt; [16] &quot;Havre                                             183                 39                       28                      98                0                2               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [17] &quot;Houlton                                           173                 30                       30                      17                0                2               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [18] &quot;Spokane                                           230                208                       67                      68                0               24               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [19] &quot;Swanton                                           292                449                      359                     531                1              103               6           N/A     N/A&quot;   </span>
<span class="co">#&gt; [20] &quot;Northern Border Sectors Total                    2,048              3,027                    1,538                   1,066               3              302              11        N/A **** N/A ****&quot;</span>
<span class="co">#&gt; [21] &quot;Big Bend (formerly Marfa)                         500               6,002                   3,346                   40,852              45             2,847             11            26      1&quot;    </span>
<span class="co">#&gt; [22] &quot;Del Rio                                          1,391             13,476                    6,156                   9,482              62             8,022             12            99     18&quot;    </span>
<span class="co">#&gt; [23] &quot;El Centro                                         870              18,633                    5,812                   5,554             484             1,413             34             4      2&quot;    </span>
<span class="co">#&gt; [24] &quot;El Paso                                          2,182             25,193                   15,337                  34,189             140             6,996             54            44      8&quot;    </span>
<span class="co">#&gt; [25] &quot;Laredo                                           1,666             25,460                    7,891                  69,535             757             6,119             31          1,054    83&quot;    </span>
<span class="co">#&gt; [26] &quot;Rio Grande Valley (formerly McAllen)             3,130            137,562                  107,909                260,020             1,192            7,979            422          1,190   104&quot;    </span>
<span class="co">#&gt; [27] &quot;San Diego                                        2,199             26,086                    7,060                  10,985            2,903            3,099             84            48      4&quot;    </span>
<span class="co">#&gt; [28] &quot;Tucson                                           3,691             38,657                   12,328                397,090              331            20,963             93           750     72&quot;    </span>
<span class="co">#&gt; [29] &quot;Yuma                                              859              12,847                   10,139                  30,181             261             2,367             33             6      2&quot;    </span>
<span class="co">#&gt; [30] &quot;Southwest Border Sectors Total**                16,605            303,916                  175,978                857,888             6,174           59,805            774          3,221   294&quot;    </span>
<span class="co">#&gt; [31] &quot;Nationwide Total***                             19,437            310,531                  180,077                861,231             9,346           60,498            786          3,221   294&quot;    </span>
<span class="co">#&gt; [32] &quot;* Agent staffing statistics depict FY17 on-board personnel data as of 9/30/2017&quot;                                                                                                                     </span>
<span class="co">#&gt; [33] &quot;** Southwest Border Sectors staffing statistics include: Big Bend, Del Rio, El Centro, El Paso, Laredo, Rio Grande Valley, San Diego, Tucson, Yuma, and the Special Operations Group.&quot;               </span>
<span class="co">#&gt; [34] &quot;*** Nationwide staffing statistics include: All on-board Border Patrol agents in CBP&quot;                                                                                                                </span>
<span class="co">#&gt; [35] &quot;**** Rescue and Death statistics are not tracked for Northern and Coastal Border Sectors.&quot;</span></code></pre>
<p>Based on the PDF, we want every row from Miami to Nationwide Total. But here we have several rows with the title of the table and the column names, and at the end we have the sentences with some details that we don’t need.</p>
<p>To keep only the rows that we want, we can combine <code>grep()</code> and subsetting to find the rows from Miami to Nationwide Total and keep only those rows. We will use <code>grep()</code> to find which row has the text “Miami” and which has the text “Nationwide Total” and keep all rows between them (including those matched rows as well). Since each only appears once in the table we don’t need to worry about handling duplicate results.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;Miami&quot;</span>, sector_profile)
<span class="co">#&gt; [1] 8</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;Nationwide Total&quot;</span>, sector_profile)
<span class="co">#&gt; [1] 31</span></code></pre>
<p>We’ll use square bracket notation to keep all rows between those two values (including each value). Since the data is a vector, not a data.frame, we don’t need a comma.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile &lt;-<span class="st"> </span>sector_profile[<span class="kw">grep</span>(<span class="st">&quot;Miami&quot;</span>, sector_profile)<span class="op">:</span><span class="kw">grep</span>(<span class="st">&quot;Nationwide Total&quot;</span>, sector_profile)]</code></pre>
<p>Note that we’re getting rid of the rows which had the column names. It’s easier to make the names ourselves than to deal with that mess.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sector_profile)
<span class="co">#&gt; [1] &quot;Miami                                             111               2,280                    1,646                   2,253             231              292               1           N/A     N/A&quot;   </span>
<span class="co">#&gt; [2] &quot;New Orleans                                        63                920                      528                      21                6               10               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [3] &quot;Ramey                                              38                388                      387                       3             2,932              89               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [4] &quot;Coastal Border Sectors Total                      212               3,588                    2,561                   2,277            3,169             391               1        N/A **** N/A ****&quot;</span>
<span class="co">#&gt; [5] &quot;Blaine                                            296                288                      237                       0                0                9               0           N/A     N/A&quot;   </span>
<span class="co">#&gt; [6] &quot;Buffalo                                           277                447                      293                     228               2                37               2           N/A     N/A&quot;</span></code></pre>
<p>The data now has only the rows we want but still doesn’t have any columns, it’s currently just a vector of strings. We want to make it into a data.frame to be able to work on it like we usually do. When looking at this data it is clear that where the division between columns is a bunch of white space. Take the first row for example, it says “Miami” then after lots of white spaces “111” than again with “2,280” and so on for the rest of the row. We’ll use this pattern of columns differentiated by white space to make “sector_profile” into a data.frame.</p>
<p>We will use the function <code>str_split_fixed()</code> from the <code>stringr</code> package. This function is very similar to <code>strsplit()</code> except you can tell it how many columns to expect. We could have used this package earlier in Section <a href="scraping-data-from-pdfs.html#scraping-data-from-pdfs">10</a> but chose not to to avoid introducing too many new packages in one lesson.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;stringr&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stringr)</code></pre>
<p>The syntax of <code>str_split_fixed()</code> is similar to <code>strsplit()</code> except the new parameter of the number of splits to expect. Looking at the PDF shows us that there are 10 columns so that’s the number we’ll use. Our split will be " {2,}“. That is, a space that occurs two or more times. Since there are sectors with spaces in their name, we can’t have only one space, we need at least two. If you look carefully at the rows with sectors”Coast Border Sectors Total" and “Northern Border Sectors Total”, the final two columns actually do not have two spaces between them because of the amount of * they have. Normally we’d want to fix this using <code>gsub()</code>, but those values will turn to NA anyway so we won’t bother in this case.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile &lt;-<span class="st"> </span><span class="kw">str_split_fixed</span>(sector_profile, <span class="st">&quot; {2,}&quot;</span>, <span class="dv">10</span>)</code></pre>
<p>If we check the <code>head()</code> we can see that we have the proper columns now but this still isn’t a data.frame and has no column names.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sector_profile)
<span class="co">#&gt;      [,1]                           [,2]  [,3]    [,4]    [,5]    [,6]   </span>
<span class="co">#&gt; [1,] &quot;Miami&quot;                        &quot;111&quot; &quot;2,280&quot; &quot;1,646&quot; &quot;2,253&quot; &quot;231&quot;  </span>
<span class="co">#&gt; [2,] &quot;New Orleans&quot;                  &quot;63&quot;  &quot;920&quot;   &quot;528&quot;   &quot;21&quot;    &quot;6&quot;    </span>
<span class="co">#&gt; [3,] &quot;Ramey&quot;                        &quot;38&quot;  &quot;388&quot;   &quot;387&quot;   &quot;3&quot;     &quot;2,932&quot;</span>
<span class="co">#&gt; [4,] &quot;Coastal Border Sectors Total&quot; &quot;212&quot; &quot;3,588&quot; &quot;2,561&quot; &quot;2,277&quot; &quot;3,169&quot;</span>
<span class="co">#&gt; [5,] &quot;Blaine&quot;                       &quot;296&quot; &quot;288&quot;   &quot;237&quot;   &quot;0&quot;     &quot;0&quot;    </span>
<span class="co">#&gt; [6,] &quot;Buffalo&quot;                      &quot;277&quot; &quot;447&quot;   &quot;293&quot;   &quot;228&quot;   &quot;2&quot;    </span>
<span class="co">#&gt;      [,7]  [,8] [,9]                [,10]</span>
<span class="co">#&gt; [1,] &quot;292&quot; &quot;1&quot;  &quot;N/A&quot;               &quot;N/A&quot;</span>
<span class="co">#&gt; [2,] &quot;10&quot;  &quot;0&quot;  &quot;N/A&quot;               &quot;N/A&quot;</span>
<span class="co">#&gt; [3,] &quot;89&quot;  &quot;0&quot;  &quot;N/A&quot;               &quot;N/A&quot;</span>
<span class="co">#&gt; [4,] &quot;391&quot; &quot;1&quot;  &quot;N/A **** N/A ****&quot; &quot;&quot;   </span>
<span class="co">#&gt; [5,] &quot;9&quot;   &quot;0&quot;  &quot;N/A&quot;               &quot;N/A&quot;</span>
<span class="co">#&gt; [6,] &quot;37&quot;  &quot;2&quot;  &quot;N/A&quot;               &quot;N/A&quot;</span></code></pre>
<p>We can make it a data.frame just by putting it in <code>data.frame()</code>. To avoid making the columns into factors, we’ll set the parameter <code>stringsAsFactors</code> to FALSE. And we can assign the columns names using a vector of strings we can make. We’ll use the same column names as in the PDF but in lowercase and replacing spaces and parentheses with underscores.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sector_profile, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(sector_profile) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sector&quot;</span>,
                           <span class="st">&quot;agent_staffing&quot;</span>,
                           <span class="st">&quot;apprehensions&quot;</span>,
                           <span class="st">&quot;other_than_mexican_apprehensions&quot;</span>, 
                           <span class="st">&quot;marijuana_pounds&quot;</span>,
                           <span class="st">&quot;cocaine_pounds&quot;</span>,
                           <span class="st">&quot;accepted_prosecutions&quot;</span>,
                           <span class="st">&quot;assaults&quot;</span>,
                           <span class="st">&quot;rescues&quot;</span>,
                           <span class="st">&quot;deaths&quot;</span>)</code></pre>
<p>We have now take a table from a PDF and successfully scraped it using R to make a data.frame with all of it’s information.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(sector_profile)
<span class="co">#&gt;                         sector agent_staffing apprehensions</span>
<span class="co">#&gt; 1                        Miami            111         2,280</span>
<span class="co">#&gt; 2                  New Orleans             63           920</span>
<span class="co">#&gt; 3                        Ramey             38           388</span>
<span class="co">#&gt; 4 Coastal Border Sectors Total            212         3,588</span>
<span class="co">#&gt; 5                       Blaine            296           288</span>
<span class="co">#&gt; 6                      Buffalo            277           447</span>
<span class="co">#&gt;   other_than_mexican_apprehensions marijuana_pounds cocaine_pounds</span>
<span class="co">#&gt; 1                            1,646            2,253            231</span>
<span class="co">#&gt; 2                              528               21              6</span>
<span class="co">#&gt; 3                              387                3          2,932</span>
<span class="co">#&gt; 4                            2,561            2,277          3,169</span>
<span class="co">#&gt; 5                              237                0              0</span>
<span class="co">#&gt; 6                              293              228              2</span>
<span class="co">#&gt;   accepted_prosecutions assaults           rescues deaths</span>
<span class="co">#&gt; 1                   292        1               N/A    N/A</span>
<span class="co">#&gt; 2                    10        0               N/A    N/A</span>
<span class="co">#&gt; 3                    89        0               N/A    N/A</span>
<span class="co">#&gt; 4                   391        1 N/A **** N/A ****       </span>
<span class="co">#&gt; 5                     9        0               N/A    N/A</span>
<span class="co">#&gt; 6                    37        2               N/A    N/A</span></code></pre>
<p>To really be able to work on this we’ll want to clean the columns to turn the values to numeric type but we can leave that until later. For now let’s write a function that replicates much of this work for the next tables.</p>
</div>
<div id="making-a-function-1" class="section level2">
<h2><span class="header-section-number">11.2</span> Making a function</h2>
<p>As we’ve done before, we want to take the code we wrote for the specific case of the first table in this PDF and turn it into a function for the general case of other tables in the PDF. Let’s copy the code we used above then convert it to a function.</p>
<pre class="sourceCode r"><code class="sourceCode r">sector_profile &lt;-<span class="st"> </span>border_patrol[<span class="dv">1</span>]
sector_profile &lt;-<span class="st"> </span><span class="kw">strsplit</span>(sector_profile, <span class="st">&quot;</span><span class="ch">\r\n</span><span class="st">&quot;</span>)
sector_profile &lt;-<span class="st"> </span>sector_profile[[<span class="dv">1</span>]]
sector_profile &lt;-<span class="st"> </span>sector_profile[<span class="kw">grep</span>(<span class="st">&quot;Miami&quot;</span>, sector_profile)<span class="op">:</span><span class="kw">grep</span>(<span class="st">&quot;Nationwide Total&quot;</span>, sector_profile)]
sector_profile &lt;-<span class="st"> </span><span class="kw">str_split_fixed</span>(sector_profile, <span class="st">&quot; {2,}&quot;</span>, <span class="dv">10</span>)
sector_profile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sector_profile, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">names</span>(sector_profile) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sector&quot;</span>,
                           <span class="st">&quot;agent_staffing&quot;</span>,
                           <span class="st">&quot;apprehensions&quot;</span>,
                           <span class="st">&quot;other_than_mexican_apprehensions&quot;</span>, 
                           <span class="st">&quot;marijuana_pounds&quot;</span>,
                           <span class="st">&quot;cocaine_pounds&quot;</span>,
                           <span class="st">&quot;accepted_prosecutions&quot;</span>,
                           <span class="st">&quot;assaults&quot;</span>,
                           <span class="st">&quot;rescues&quot;</span>,
                           <span class="st">&quot;deaths&quot;</span>)</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scraping-data-from-pdfs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geocoding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacobkap/r4crim/edit/master/pdf-tables.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
