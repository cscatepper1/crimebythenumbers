<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 Hotspot maps | R 4 Criminology</title>
  <meta name="description" content="Notes for learning R for Criminology." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="14 Hotspot maps | R 4 Criminology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r4crim.com" />
  
  <meta property="og:description" content="Notes for learning R for Criminology." />
  <meta name="github-repo" content="jacobkap/r4crim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 Hotspot maps | R 4 Criminology" />
  
  <meta name="twitter:description" content="Notes for learning R for Criminology." />
  

<meta name="author" content="Jacob Kaplan" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="graphing-intro.html">
<link rel="next" href="choropleth-maps.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99359926-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99359926-6');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Criminology</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-will-learn"><i class="fa fa-check"></i>What you will learn</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i>Skills</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i>Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-wont-learn"><i class="fa fa-check"></i>What you won’t learn</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#simple-vs-easy"><i class="fa fa-check"></i>Simple vs Easy</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to Contribute</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#why-learn-to-program"><i class="fa fa-check"></i><b>1.1</b> Why learn to program?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#scale"><i class="fa fa-check"></i><b>1.1.1</b> Scale</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#reproducibility"><i class="fa fa-check"></i><b>1.1.2</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-rstudio"><i class="fa fa-check"></i><b>1.2</b> Using RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#opening-an-r-script"><i class="fa fa-check"></i><b>1.2.1</b> Opening an R Script</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#setting-the-working-directory"><i class="fa fa-check"></i><b>1.2.2</b> Setting the working directory</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#changing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Changing RStudio</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#helpful-cheatsheets"><i class="fa fa-check"></i><b>1.2.4</b> Helpful cheatsheets</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.3</b> Reading data into R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#loading-data"><i class="fa fa-check"></i><b>1.3.1</b> Loading data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#first-steps-to-exploring-data"><i class="fa fa-check"></i><b>1.4</b> First steps to exploring data</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#finding-help-about-functions"><i class="fa fa-check"></i><b>1.5</b> Finding help about functions</a></li>
</ul></li>
<li class="part"><span><b>I Clean</b></span></li>
<li class="chapter" data-level="2" data-path="subsetting-intro.html"><a href="subsetting-intro.html"><i class="fa fa-check"></i><b>2</b> Subsetting: Making big things small</a><ul>
<li class="chapter" data-level="2.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-values"><i class="fa fa-check"></i><b>2.1</b> Select specific values</a></li>
<li class="chapter" data-level="2.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#assignment"><i class="fa fa-check"></i><b>2.2</b> Assignment values to objects (Making “things”)</a></li>
<li class="chapter" data-level="2.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#vectors"><i class="fa fa-check"></i><b>2.3</b> Vectors (collections of “things”)</a></li>
<li class="chapter" data-level="2.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#logical-values-and-operations"><i class="fa fa-check"></i><b>2.4</b> Logical values and operations</a><ul>
<li class="chapter" data-level="2.4.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#matching-a-single-value"><i class="fa fa-check"></i><b>2.4.1</b> Matching a single value</a></li>
<li class="chapter" data-level="2.4.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#matching-multiple-values"><i class="fa fa-check"></i><b>2.4.2</b> Matching multiple values</a></li>
<li class="chapter" data-level="2.4.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#does-not-match"><i class="fa fa-check"></i><b>2.4.3</b> Does not match</a></li>
<li class="chapter" data-level="2.4.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#greater-than-or-less-than"><i class="fa fa-check"></i><b>2.4.4</b> Greater than or less than</a></li>
<li class="chapter" data-level="2.4.5" data-path="subsetting-intro.html"><a href="subsetting-intro.html#combining-conditional-statements---or-and"><i class="fa fa-check"></i><b>2.4.5</b> Combining conditional statements - or, and</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="subsetting-intro.html"><a href="subsetting-intro.html#subsetting-a-data.frame"><i class="fa fa-check"></i><b>2.5</b> Subsetting a data.frame</a><ul>
<li class="chapter" data-level="2.5.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-columns"><i class="fa fa-check"></i><b>2.5.1</b> Select specific columns</a></li>
<li class="chapter" data-level="2.5.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-rows"><i class="fa fa-check"></i><b>2.5.2</b> Select specific rows</a></li>
<li class="chapter" data-level="2.5.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#battleships"><i class="fa fa-check"></i><b>2.5.3</b> Battleships</a></li>
<li class="chapter" data-level="2.5.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#subset-colorado-data"><i class="fa fa-check"></i><b>2.5.4</b> Subset Colorado data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="explore.html"><a href="explore.html"><i class="fa fa-check"></i><b>3</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="explore.html"><a href="explore.html#summary-and-table"><i class="fa fa-check"></i><b>3.1</b> Summary and Table</a></li>
<li class="chapter" data-level="3.2" data-path="explore.html"><a href="explore.html#graphing"><i class="fa fa-check"></i><b>3.2</b> Graphing</a></li>
<li class="chapter" data-level="3.3" data-path="explore.html"><a href="explore.html#aggregate"><i class="fa fa-check"></i><b>3.3</b> Aggregating (summaries of groups)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>4</b> Dates and Times</a><ul>
<li class="chapter" data-level="4.1" data-path="dates-and-times.html"><a href="dates-and-times.html#why-do-dates-and-times-matter"><i class="fa fa-check"></i><b>4.1</b> Why do dates and times matter?</a></li>
<li class="chapter" data-level="4.2" data-path="dates-and-times.html"><a href="dates-and-times.html#lubridate"><i class="fa fa-check"></i><b>4.2</b> <code>lubridate</code></a></li>
<li class="chapter" data-level="4.3" data-path="dates-and-times.html"><a href="dates-and-times.html#working-with-dates"><i class="fa fa-check"></i><b>4.3</b> Working with dates</a></li>
<li class="chapter" data-level="4.4" data-path="dates-and-times.html"><a href="dates-and-times.html#chicago-crime-data"><i class="fa fa-check"></i><b>4.4</b> Chicago crime data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises"><i class="fa fa-check"></i><b>4.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>5</b> Regular Expressions</a><ul>
<li class="chapter" data-level="5.1" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-patterns-in-text-with-grep"><i class="fa fa-check"></i><b>5.1</b> Finding patterns in text with <code>grep()</code></a></li>
<li class="chapter" data-level="5.2" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-and-replacing-patterns-in-text-with-gsub"><i class="fa fa-check"></i><b>5.2</b> Finding and replacing patterns in text with <code>gsub()</code></a></li>
<li class="chapter" data-level="5.3" data-path="regular-expressions.html"><a href="regular-expressions.html#useful-special-characters"><i class="fa fa-check"></i><b>5.3</b> Useful special characters</a><ul>
<li class="chapter" data-level="5.3.1" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-characters"><i class="fa fa-check"></i><b>5.3.1</b> Multiple characters <code>[]</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-of-previous-character-n"><i class="fa fa-check"></i><b>5.3.2</b> n-many of previous character <code>{n}</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-to-m-many-of-previous-character-nm"><i class="fa fa-check"></i><b>5.3.3</b> n-many to m-many of previous character <code>{n,m}</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="regular-expressions.html"><a href="regular-expressions.html#start-of-string-and-not"><i class="fa fa-check"></i><b>5.3.4</b> Start of string and “not” <code>^</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="regular-expressions.html"><a href="regular-expressions.html#end-of-string"><i class="fa fa-check"></i><b>5.3.5</b> End of string <code>$</code></a></li>
<li class="chapter" data-level="5.3.6" data-path="regular-expressions.html"><a href="regular-expressions.html#anything-."><i class="fa fa-check"></i><b>5.3.6</b> Anything <code>.</code></a></li>
<li class="chapter" data-level="5.3.7" data-path="regular-expressions.html"><a href="regular-expressions.html#one-or-more-of-previous"><i class="fa fa-check"></i><b>5.3.7</b> One or more of previous <code>+</code></a></li>
<li class="chapter" data-level="5.3.8" data-path="regular-expressions.html"><a href="regular-expressions.html#zero-or-more-of-previous"><i class="fa fa-check"></i><b>5.3.8</b> Zero or more of previous <code>*</code></a></li>
<li class="chapter" data-level="5.3.9" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-patterns"><i class="fa fa-check"></i><b>5.3.9</b> Multiple patterns <code>|</code></a></li>
<li class="chapter" data-level="5.3.10" data-path="regular-expressions.html"><a href="regular-expressions.html#parentheses"><i class="fa fa-check"></i><b>5.3.10</b> Parentheses <code>()</code></a></li>
<li class="chapter" data-level="5.3.11" data-path="regular-expressions.html"><a href="regular-expressions.html#optional-text"><i class="fa fa-check"></i><b>5.3.11</b> Optional text <code>?</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regular-expressions.html"><a href="regular-expressions.html#changing-capitalization"><i class="fa fa-check"></i><b>5.4</b> Changing capitalization</a></li>
</ul></li>
<li class="part"><span><b>II Collect</b></span></li>
<li class="chapter" data-level="6" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html"><i class="fa fa-check"></i><b>6</b> Webscraping with <code>rvest</code></a><ul>
<li class="chapter" data-level="6.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#scraping-one-page"><i class="fa fa-check"></i><b>6.1</b> Scraping one page</a></li>
<li class="chapter" data-level="6.2" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#cleaning-the-webscraped-data"><i class="fa fa-check"></i><b>6.2</b> Cleaning the webscraped data</a></li>
<li class="chapter" data-level="6.3" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#fixing-names"><i class="fa fa-check"></i><b>6.3</b> Fixing names</a><ul>
<li class="chapter" data-level="6.3.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#exercises-1"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="functions.html"><a href="functions.html#a-simple-function"><i class="fa fa-check"></i><b>7.1</b> A simple function</a></li>
<li class="chapter" data-level="7.2" data-path="functions.html"><a href="functions.html#adding-parameters"><i class="fa fa-check"></i><b>7.2</b> Adding parameters</a></li>
<li class="chapter" data-level="7.3" data-path="functions.html"><a href="functions.html#movie_function"><i class="fa fa-check"></i><b>7.3</b> Making a function to scrape movie data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>8</b> For loops</a><ul>
<li class="chapter" data-level="8.1" data-path="for-loops.html"><a href="for-loops.html#basic-for-loops"><i class="fa fa-check"></i><b>8.1</b> Basic for loops</a></li>
<li class="chapter" data-level="8.2" data-path="for-loops.html"><a href="for-loops.html#scraping-multiple-days-of-movie-data"><i class="fa fa-check"></i><b>8.2</b> Scraping multiple days of movie data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>9</b> Reading and Writing Data</a><ul>
<li class="chapter" data-level="9.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-data-into-r-1"><i class="fa fa-check"></i><b>9.1</b> Reading Data into R</a><ul>
<li class="chapter" data-level="9.1.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r"><i class="fa fa-check"></i><b>9.1.1</b> R</a></li>
<li class="chapter" data-level="9.1.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel"><i class="fa fa-check"></i><b>9.1.2</b> Excel</a></li>
<li class="chapter" data-level="9.1.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata"><i class="fa fa-check"></i><b>9.1.3</b> Stata</a></li>
<li class="chapter" data-level="9.1.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas"><i class="fa fa-check"></i><b>9.1.4</b> SAS</a></li>
<li class="chapter" data-level="9.1.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#spss"><i class="fa fa-check"></i><b>9.1.5</b> SPSS</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-data"><i class="fa fa-check"></i><b>9.2</b> Writing Data</a><ul>
<li class="chapter" data-level="9.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-1"><i class="fa fa-check"></i><b>9.2.1</b> R</a></li>
<li class="chapter" data-level="9.2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-1"><i class="fa fa-check"></i><b>9.2.2</b> Excel</a></li>
<li class="chapter" data-level="9.2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-1"><i class="fa fa-check"></i><b>9.2.3</b> Stata</a></li>
<li class="chapter" data-level="9.2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-1"><i class="fa fa-check"></i><b>9.2.4</b> SAS</a></li>
<li class="chapter" data-level="9.2.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#spss-1"><i class="fa fa-check"></i><b>9.2.5</b> SPSS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html"><i class="fa fa-check"></i><b>10</b> Scraping data from PDFs</a><ul>
<li class="chapter" data-level="10.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#downloading-officer-involved-shooting-files"><i class="fa fa-check"></i><b>10.1</b> Downloading officer-involved Shooting Files</a></li>
<li class="chapter" data-level="10.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-information-from-the-page"><i class="fa fa-check"></i><b>10.2</b> Scraping information from the page</a><ul>
<li class="chapter" data-level="10.2.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#combining-the-data-sets"><i class="fa fa-check"></i><b>10.2.1</b> Combining the data sets</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#extracting-data-from-pdfs"><i class="fa fa-check"></i><b>10.3</b> Extracting data from PDFs</a><ul>
<li class="chapter" data-level="10.3.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-a-single-pdf"><i class="fa fa-check"></i><b>10.3.1</b> Scraping a single PDF</a></li>
<li class="chapter" data-level="10.3.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#making-a-function"><i class="fa fa-check"></i><b>10.3.2</b> Making a function</a></li>
<li class="chapter" data-level="10.3.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#looping-through-every-pdf"><i class="fa fa-check"></i><b>10.3.3</b> Looping through every PDF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="scrape-table.html"><a href="scrape-table.html"><i class="fa fa-check"></i><b>11</b> Scraping Tables from PDFs</a><ul>
<li class="chapter" data-level="11.1" data-path="scrape-table.html"><a href="scrape-table.html#scraping-the-first-table"><i class="fa fa-check"></i><b>11.1</b> Scraping the first table</a></li>
<li class="chapter" data-level="11.2" data-path="scrape-table.html"><a href="scrape-table.html#making-a-function-1"><i class="fa fa-check"></i><b>11.2</b> Making a function</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>12</b> Geocoding</a><ul>
<li class="chapter" data-level="12.1" data-path="geocoding.html"><a href="geocoding.html#geocoding-a-single-address"><i class="fa fa-check"></i><b>12.1</b> Geocoding a single address</a></li>
<li class="chapter" data-level="12.2" data-path="geocoding.html"><a href="geocoding.html#making-a-function-2"><i class="fa fa-check"></i><b>12.2</b> Making a function</a></li>
<li class="chapter" data-level="12.3" data-path="geocoding.html"><a href="geocoding.html#geocoding-officer-shooting-locations"><i class="fa fa-check"></i><b>12.3</b> Geocoding officer shooting locations</a></li>
</ul></li>
<li class="part"><span><b>III Visualize</b></span></li>
<li class="chapter" data-level="13" data-path="graphing-intro.html"><a href="graphing-intro.html"><i class="fa fa-check"></i><b>13</b> Graphing with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="13.1" data-path="graphing-intro.html"><a href="graphing-intro.html#what-does-the-data-look-like"><i class="fa fa-check"></i><b>13.1</b> What does the data look like?</a></li>
<li class="chapter" data-level="13.2" data-path="graphing-intro.html"><a href="graphing-intro.html#graphing-data"><i class="fa fa-check"></i><b>13.2</b> Graphing data</a></li>
<li class="chapter" data-level="13.3" data-path="graphing-intro.html"><a href="graphing-intro.html#time-series-plots"><i class="fa fa-check"></i><b>13.3</b> Time-Series Plots</a></li>
<li class="chapter" data-level="13.4" data-path="graphing-intro.html"><a href="graphing-intro.html#color-blindness"><i class="fa fa-check"></i><b>13.4</b> Color blindness</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hotspot-maps.html"><a href="hotspot-maps.html"><i class="fa fa-check"></i><b>14</b> Hotspot maps</a><ul>
<li class="chapter" data-level="14.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#a-simple-map"><i class="fa fa-check"></i><b>14.1</b> A simple map</a></li>
<li class="chapter" data-level="14.2" data-path="hotspot-maps.html"><a href="hotspot-maps.html#what-really-are-maps"><i class="fa fa-check"></i><b>14.2</b> What really are maps?</a></li>
<li class="chapter" data-level="14.3" data-path="hotspot-maps.html"><a href="hotspot-maps.html#making-a-hotspot-map"><i class="fa fa-check"></i><b>14.3</b> Making a hotspot map</a><ul>
<li class="chapter" data-level="14.3.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#colors"><i class="fa fa-check"></i><b>14.3.1</b> Colors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="hotspot-maps.html"><a href="hotspot-maps.html#looping-through-each-year"><i class="fa fa-check"></i><b>14.4</b> Looping through each year</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="choropleth-maps.html"><a href="choropleth-maps.html"><i class="fa fa-check"></i><b>15</b> Choropleth Maps</a><ul>
<li class="chapter" data-level="15.1" data-path="choropleth-maps.html"><a href="choropleth-maps.html#spatial-joins"><i class="fa fa-check"></i><b>15.1</b> Spatial joins</a></li>
<li class="chapter" data-level="15.2" data-path="choropleth-maps.html"><a href="choropleth-maps.html#making-choropleth-maps"><i class="fa fa-check"></i><b>15.2</b> Making choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>16</b> Interactive Maps</a><ul>
<li class="chapter" data-level="16.1" data-path="interactive-maps.html"><a href="interactive-maps.html#why-do-interactive-graphs-matter"><i class="fa fa-check"></i><b>16.1</b> Why do interactive graphs matter?</a><ul>
<li class="chapter" data-level="16.1.1" data-path="interactive-maps.html"><a href="interactive-maps.html#understanding-your-data"><i class="fa fa-check"></i><b>16.1.1</b> Understanding your data</a></li>
<li class="chapter" data-level="16.1.2" data-path="interactive-maps.html"><a href="interactive-maps.html#police-departments-use-them"><i class="fa fa-check"></i><b>16.1.2</b> Police departments use them</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="interactive-maps.html"><a href="interactive-maps.html#making-the-interactive-map"><i class="fa fa-check"></i><b>16.2</b> Making the interactive map</a></li>
<li class="chapter" data-level="16.3" data-path="interactive-maps.html"><a href="interactive-maps.html#adding-popup-information"><i class="fa fa-check"></i><b>16.3</b> Adding popup information</a></li>
<li class="chapter" data-level="16.4" data-path="interactive-maps.html"><a href="interactive-maps.html#dealing-with-too-many-markers"><i class="fa fa-check"></i><b>16.4</b> Dealing with too many markers</a></li>
<li class="chapter" data-level="16.5" data-path="interactive-maps.html"><a href="interactive-maps.html#interactive-polygons"><i class="fa fa-check"></i><b>16.5</b> Interactive polygons</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ois-graphs.html"><a href="ois-graphs.html"><i class="fa fa-check"></i><b>17</b> More Graphing with <code>ggplot</code></a><ul>
<li class="chapter" data-level="17.1" data-path="ois-graphs.html"><a href="ois-graphs.html#graphing-a-single-variable"><i class="fa fa-check"></i><b>17.1</b> Graphing a single variable</a><ul>
<li class="chapter" data-level="17.1.1" data-path="ois-graphs.html"><a href="ois-graphs.html#numeric-variable"><i class="fa fa-check"></i><b>17.1.1</b> Numeric variable</a></li>
<li class="chapter" data-level="17.1.2" data-path="ois-graphs.html"><a href="ois-graphs.html#categorical-variable"><i class="fa fa-check"></i><b>17.1.2</b> Categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="ois-graphs.html"><a href="ois-graphs.html#time-series"><i class="fa fa-check"></i><b>17.2</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>18</b> R Markdown</a><ul>
<li class="chapter" data-level="18.1" data-path="r-markdown.html"><a href="r-markdown.html#code-1"><i class="fa fa-check"></i><b>18.1</b> Code</a><ul>
<li class="chapter" data-level="18.1.1" data-path="r-markdown.html"><a href="r-markdown.html#only-use-code-to-make-output"><i class="fa fa-check"></i><b>18.1.1</b> Only use code to make output</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="r-markdown.html"><a href="r-markdown.html#figures-and-tables"><i class="fa fa-check"></i><b>18.2</b> Figures and Tables</a></li>
<li class="chapter" data-level="18.3" data-path="r-markdown.html"><a href="r-markdown.html#finally-making-the-output-file"><i class="fa fa-check"></i><b>18.3</b> Finally, making the output file</a></li>
</ul></li>
<li class="part"><span><b>IV Data</b></span></li>
<li class="chapter" data-level="19" data-path="ucr.html"><a href="ucr.html"><i class="fa fa-check"></i><b>19</b> Uniform Crime Report (UCR) Data</a><ul>
<li class="chapter" data-level="19.1" data-path="ucr.html"><a href="ucr.html#exploring-the-ucr-data"><i class="fa fa-check"></i><b>19.1</b> Exploring the UCR data</a></li>
<li class="chapter" data-level="19.2" data-path="ucr.html"><a href="ucr.html#finding-things-in-our-data"><i class="fa fa-check"></i><b>19.2</b> Finding things in our data</a></li>
<li class="chapter" data-level="19.3" data-path="ucr.html"><a href="ucr.html#manipulating-our-data"><i class="fa fa-check"></i><b>19.3</b> Manipulating our data</a><ul>
<li class="chapter" data-level="19.3.1" data-path="ucr.html"><a href="ucr.html#exercises-2"><i class="fa fa-check"></i><b>19.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="census-data-from-social-explorer.html"><a href="census-data-from-social-explorer.html"><i class="fa fa-check"></i><b>20</b> Census Data from Social Explorer</a><ul>
<li class="chapter" data-level="20.1" data-path="census-data-from-social-explorer.html"><a href="census-data-from-social-explorer.html#getting-census-data-from-social-explorer"><i class="fa fa-check"></i><b>20.1</b> Getting Census data from Social Explorer</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html"><i class="fa fa-check"></i><b>21</b> Census Data from IPUMS</a><ul>
<li class="chapter" data-level="21.1" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#getting-ipums-data"><i class="fa fa-check"></i><b>21.1</b> Getting IPUMS data</a></li>
<li class="chapter" data-level="21.2" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#cleaning-the-data"><i class="fa fa-check"></i><b>21.2</b> Cleaning the data</a></li>
<li class="chapter" data-level="21.3" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#aggregating-the-data"><i class="fa fa-check"></i><b>21.3</b> Aggregating the data</a></li>
<li class="chapter" data-level="21.4" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#graphing-the-data"><i class="fa fa-check"></i><b>21.4</b> Graphing the data</a></li>
<li class="chapter" data-level="21.5" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#mapping-the-data"><i class="fa fa-check"></i><b>21.5</b> Mapping the data</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nibrs.html"><a href="nibrs.html"><i class="fa fa-check"></i><b>22</b> National Incident-Based Reporting System (NIBRS) Data</a><ul>
<li class="chapter" data-level="22.1" data-path="nibrs.html"><a href="nibrs.html#downloading-the-data"><i class="fa fa-check"></i><b>22.1</b> Downloading the data</a></li>
<li class="chapter" data-level="22.2" data-path="nibrs.html"><a href="nibrs.html#reading-the-data"><i class="fa fa-check"></i><b>22.2</b> Reading the data</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="useful-resources.html"><a href="useful-resources.html"><i class="fa fa-check"></i><b>A</b> Useful Resources</a><ul>
<li class="chapter" data-level="A.0.1" data-path="useful-resources.html"><a href="useful-resources.html#learning-r-and-coding-issues"><i class="fa fa-check"></i><b>A.0.1</b> Learning R and coding issues</a></li>
<li class="chapter" data-level="A.0.2" data-path="useful-resources.html"><a href="useful-resources.html#data-1"><i class="fa fa-check"></i><b>A.0.2</b> Data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 4 Criminology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hotspot-maps" class="section level1">
<h1><span class="header-section-number">14</span> Hotspot maps</h1>
<p>Hotspot maps are used to find where events (officer-involved shootings, crimes, liquors stores) are especially prevalent. These maps are frequently used by police departments, particularly in determining where to do hotspot policing (which is focusing patrols on high-crime areas).</p>
<p>However, there are significant flaws with these kinds of maps. As we’ll see during this lesson, minor changes to how we make the maps can cause significant differences in interpretation. For example, determining the size of the clusters that make up the hotspots can make it seem like there are much larger or smaller areas with hotspots than there actually are. These clusters are also drawn fairly arbitrarily, without taking into account context such as neighborhoods (In Chapter <a href="choropleth-maps.html#choropleth-maps">15</a> we’ll make maps that try to account for these types of areas). This makes it more difficult to interpret because even though maps give us the context of location, it can combine different areas in an arbitrary way. We’ll explore these issues in more detail throughout the lesson but keep in mind these risks as you make your own hotspot maps.</p>
<p>Here, we will make hotspot maps with our officer_shootings_geocoded crime data. First we need to load the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;data/officer_shootings_geocoded.rda&quot;</span>)</code></pre>
<div id="a-simple-map" class="section level2">
<h2><span class="header-section-number">14.1</span> A simple map</h2>
<p>To make these maps we will use the package <code>ggmap</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ggmap&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap)
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Google&#39;s Terms of Service: https://cloud.google.com/maps-platform/terms/.</span>
<span class="co">#&gt; Please cite ggmap if you use it! See citation(&quot;ggmap&quot;) for details.</span></code></pre>
<p>We’ll start by making the background to our map, showing Philadelphia. We do so using the <code>get_map()</code> function from <code>ggmap</code> which gets a map background from a number of sources. We’ll set the source to “stamen” since Google no longer allows us to get a map without creating an account. The first parameter in <code>get_map()</code> is simply coordinates for Philadelphia to ensure we get a map of the right spot.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map &lt;-<span class="st"> </span><span class="kw">ggmap</span>(<span class="kw">get_map</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">75.288486</span>, <span class="fl">39.868285</span>, <span class="fl">-74.950965</span>, <span class="fl">40.138251</span>), 
                            <span class="dt">source =</span> <span class="st">&quot;stamen&quot;</span>))
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1191/1548.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1192/1548.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1193/1548.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1194/1548.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1195/1548.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1191/1549.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1192/1549.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1193/1549.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1194/1549.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1195/1549.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1191/1550.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1192/1550.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1193/1550.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1194/1550.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1195/1550.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1191/1551.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1192/1551.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1193/1551.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1194/1551.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1195/1551.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1191/1552.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1192/1552.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1193/1552.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1194/1552.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain/12/1195/1552.png</span>
philly_map</code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Since we saved the map output into “philly_map” we can reuse this map background for all the maps we’re making in this lesson. This saves us time as we don’t have to wait to download the map every time. Let’s plot the shootings from our data set. Just as with a scatterplot we use the <code>geom_point()</code> function from the <code>ggplot2</code> package and set our longitude and latitude variables on the x- and y-axis, respectively.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
             <span class="dt">data  =</span> officer_shootings_geocoded)
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we wanted to color the dots we can use “color =” and then select a color. Let’s try it with “forestgreen”.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
             <span class="dt">data  =</span> officer_shootings_geocoded,
             <span class="dt">color =</span> <span class="st">&quot;forestgreen&quot;</span>)
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As with other graphs we can change the size of the dot using “size =”.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
             <span class="dt">data  =</span> officer_shootings_geocoded,
             <span class="dt">color =</span> <span class="st">&quot;forestgreen&quot;</span>,
             <span class="dt">size  =</span> <span class="fl">0.5</span>)
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
             <span class="dt">data  =</span> officer_shootings_geocoded,
             <span class="dt">color =</span> <span class="st">&quot;forestgreen&quot;</span>,
             <span class="dt">size  =</span> <span class="dv">2</span>)
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>For maps like this - with one point per event - it is hard to tell if any events happen on the same, or nearly the same, location as each point is solid green. We want to make the dots semi-transparent so if multiple shootings happen at the same place that dot will be shaded darker than if only one shooting happened there. To do so we use the parameter “alpha =” which takes an input between 0 and 1 (inclusive). The lower the value the more transparent it is.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
             <span class="dt">data  =</span> officer_shootings_geocoded,
             <span class="dt">color =</span> <span class="st">&quot;forestgreen&quot;</span>,
             <span class="dt">size  =</span> <span class="dv">2</span>,
             <span class="dt">alpha =</span> <span class="fl">0.5</span>)
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_point).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This map is useful because it allows us to easily see where each officer-involved shooting in Philly happened between 2007 and early 2019. There are some limitations though. This shows all shootings in a single map, meaning that any time trends are lost - we’ll address this at the end of the lesson. While you can see some clusters, it is difficult to see if there are any hot spots indicating areas with especially high or low amounts of shootings. You’ll notice that it has a message saying “Removed 2 rows containing missing values (geom_point).” That just means that <code>ggplot()</code> automatically deleted 2 rows that didn’t contain any longitude or latitude data. Most data will have a small number of rows missing values, that is nothing to be concerned about unless the number of missing values gets large enough to affect your data.</p>
</div>
<div id="what-really-are-maps" class="section level2">
<h2><span class="header-section-number">14.2</span> What really are maps?</h2>
<p>Let’s pause for a moment to think about what a map really is. Below I made a simple scatterplot of our data with one dot per shooting (minus the two without coordinates). Compare this to the map above and you’ll see that they are the same except the map has a useful background while the plot has a blank background. That is all static maps are (in Chapter <a href="interactive-maps.html#interactive-maps">16</a> we’ll learn about interactive maps), scatterplots of coordinates overlayed on a map background. Basically, they are scatterplots with context. And this context is useful, we can interpret the map to see that there are lots of shootings in West Philly but not around University City, for example. The exact same pattern is present in the scatterplot but without the ability to tell “where” a dot is.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(officer_shootings_geocoded<span class="op">$</span>lon, officer_shootings_geocoded<span class="op">$</span>lat, <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>)</code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="making-a-hotspot-map" class="section level2">
<h2><span class="header-section-number">14.3</span> Making a hotspot map</h2>
<p>Now we can start making hotspot maps which help to show areas with clusters of events. We’ll do this using hexagonal bins which are an efficient way of showing clusters of events on a map. Our syntax will be similar to the map above but now we want to use the function <code>stat_binhex()</code> rather than <code>geom_point()</code>. It starts the same as before with <code>aex(x = lon, y = lat)</code> (or whatever the longitude and latitude columns are called in your data), as well as “data = officer_shootings_geocoded” outside of the <code>aes()</code> parameter.</p>
<p>There are two new things we need to make the hotspot map. First we can add the parameter “bins = number_of_bins” where “number_of_bins” is a number we select. bins essentially says how large or small we want each cluster of events to be. A smaller value for “bins” says we want more events clustered together, making larger bins. A larger value for bins has each bin be smaller on the map and capture fewer events. This will become more clear with examples.</p>
<p>The second thing is to add the function <code>coord_cartesian()</code> which just tells <code>ggplot()</code> we are going to do some spatial analysis in the making of the bins. We don’t need to add any parameters in this.</p>
<p>Let’s start with 60 bins and then try some other number of bins to see how it changes the map.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_binhex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
              <span class="dt">bins =</span> <span class="dv">60</span>,
              <span class="dt">data =</span> officer_shootings_geocoded) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>() 
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_binhex).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>From this map we can see that most areas which had a shooting had 1-2 shootings in that area (a limitation to this map is it is unclear just how wide these “areas” are). North Philly and North-West Philly have more areas with more shootings, and more shootings overall. But look right in the middle of Center City by City Hall, an area has 8 shootings, the most of any bin. Were there really 8 shootings outside of City Hall? No. Remember those addresses that couldn’t be properly located? The coordinates given to those addresses were to City Hall, causing this weird pattern in our map.</p>
<p>What happens when we drop the number of bins to 30?</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_binhex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
              <span class="dt">bins =</span> <span class="dv">30</span>,
              <span class="dt">data =</span> officer_shootings_geocoded) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>() 
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_binhex).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Each bin is much larger and covers nearly all of Philadelphia. Be careful with maps like these! This map is so broad that it appears that shootings are ubiquitous across the city. We know from the map showing each shooting as a dot, and that there are &lt;500 shootings, that this is not true. Making maps like this make it easy to mislead the reader, including yourself!</p>
<p>What about looking at 100 bins?</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_binhex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
              <span class="dt">bins =</span> <span class="dv">100</span>,
              <span class="dt">data =</span> officer_shootings_geocoded) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>() 
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_binhex).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now each bin is very small and a much smaller area in Philadelphia has had an officer-involved shooting. So what is the right number of bins to use? There is no correct universal answer - you must decide what the goal is with the data you are using. This opens up serious issues for manipulation - intentional or not - of the data as the map is so easily changeable without ever changing the data itself.</p>
<div id="colors" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Colors</h3>
<p>To change the bin colors we can use the parameter <code>scale_fill_gradient()</code>. This accepts a color for “low” which is when the events are rare and “high” for the bins with frequent events. We’ll use colors from <a href="http://colorbrewer2.org">ColorBrewer</a>, selecting the reddish theme (“3-class OrRd”) from the Multi-hue section of the “sequential” data on the page.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_binhex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
              <span class="dt">bins  =</span> <span class="dv">60</span>,
              <span class="dt">data =</span> officer_shootings_geocoded) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;#fee8c8&quot;</span>,
                      <span class="dt">high =</span> <span class="st">&quot;#e34a33&quot;</span>)
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_binhex).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>By default it labels the legend as “count”. Since we know these are counts of police shootings let’s relabel that as such.</p>
<pre class="sourceCode r"><code class="sourceCode r">philly_map <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_binhex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
              <span class="dt">bins  =</span> <span class="dv">60</span>,
              <span class="dt">data =</span> officer_shootings_geocoded) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="st">&#39;Police Shootings&#39;</span>,
                      <span class="dt">low =</span> <span class="st">&quot;#fee8c8&quot;</span>,
                      <span class="dt">high =</span> <span class="st">&quot;#e34a33&quot;</span>)
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (stat_binhex).</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="looping-through-each-year" class="section level2">
<h2><span class="header-section-number">14.4</span> Looping through each year</h2>
<p>Since our maps show every shooting on the same map, if there are different patterns depending on the year, we can’t pick up those patterns. As a check, let’s write a for loop that maps each year’s data separately. First we need to make a variable with the shooting’s year to be able to subset data for just that year. We can use the <code>year()</code> function from <code>lubridate</code> to do this.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: &#39;lubridate&#39;</span>
<span class="co">#&gt; The following object is masked from &#39;package:base&#39;:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     date</span>
officer_shootings_geocoded<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">year</span>(officer_shootings_geocoded<span class="op">$</span>dates)</code></pre>
<p>As a basic check, let’s just see how many shootings there were each year.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(officer_shootings_geocoded<span class="op">$</span>year)
<span class="co">#&gt; </span>
<span class="co">#&gt; 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 </span>
<span class="co">#&gt;   61   40   55   47   44   59   35   28   21   22   12   12    5</span></code></pre>
<p>It looks like the general pattern is that shootings are declining. Now we can map each year. We are looping through each year in the data, and reusing the map code before except instead of the full data, we subset data to be only rows matching the year in that iteration of the loop.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (year <span class="cf">in</span> <span class="kw">unique</span>(officer_shootings_geocoded<span class="op">$</span>year)) { 
  <span class="kw">print</span>(
    philly_map <span class="op">+</span>
<span class="st">      </span><span class="kw">stat_binhex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat),
                  <span class="dt">bins  =</span> <span class="dv">60</span>,
                  <span class="dt">alpha =</span> <span class="fl">0.75</span>,
                  <span class="dt">data =</span> officer_shootings_geocoded[officer_shootings_geocoded<span class="op">$</span>year <span class="op">==</span><span class="st"> </span>year, ]) <span class="op">+</span>
<span class="st">      </span><span class="kw">coord_cartesian</span>() <span class="op">+</span>
<span class="st">      </span><span class="kw">scale_fill_gradient</span>(<span class="st">&#39;Police Shootings&#39;</span>,
                          <span class="dt">low =</span> <span class="st">&quot;#fee8c8&quot;</span>,
                      <span class="dt">high =</span> <span class="st">&quot;#e34a33&quot;</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;Philadelphia Police Officer-Involved Shootings, &quot;</span>, year))
  )
}
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 1 rows containing non-finite values (stat_binhex).</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Warning: Removed 1 rows containing non-finite values (stat_binhex).</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="co">#&gt; Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span></code></pre>
<p><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-2.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-3.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-4.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-5.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-6.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-7.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-8.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-9.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-10.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-11.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-12.png" width="90%" style="display: block; margin: auto;" /><img src="hotspot-maps_files/figure-html/unnamed-chunk-19-13.png" width="90%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphing-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="choropleth-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacobkap/r4crim/edit/master/hotspot-maps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
