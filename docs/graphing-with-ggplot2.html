<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Graphing with ggplot2 | R 4 Criminology</title>
  <meta name="description" content="Notes for learning and applying R to questions about crime and the justice system." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Graphing with ggplot2 | R 4 Criminology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r4crim.com" />
  
  <meta property="og:description" content="Notes for learning and applying R to questions about crime and the justice system." />
  <meta name="github-repo" content="jacobkap/r4crim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Graphing with ggplot2 | R 4 Criminology" />
  
  <meta name="twitter:description" content="Notes for learning and applying R to questions about crime and the justice system." />
  

<meta name="author" content="Jacob Kaplan" />
<meta name="author" content="Greg Ridgeway" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regular-expressions.html">
<link rel="next" href="webscraping-with-rvest.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99359926-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99359926-6');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Criminology</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-math"><i class="fa fa-check"></i><b>1.1</b> Basic Math</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#combining-values-together-into-a-collection-or-vector"><i class="fa fa-check"></i><b>1.2</b> Combining values together into a collection (or vector)</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#assignment-of-values-to-variables-making-things"><i class="fa fa-check"></i><b>1.3</b> Assignment of values to variables (Making “things”)</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.4</b> Reading data into R</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#setting-the-working-directory"><i class="fa fa-check"></i><b>1.4.1</b> Setting the working directory</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#loading-data"><i class="fa fa-check"></i><b>1.4.2</b> Loading data</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#first-steps-to-explore-the-data"><i class="fa fa-check"></i><b>1.4.3</b> First steps to explore the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-rstudio.html"><a href="introduction-to-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to RStudio</a></li>
<li class="chapter" data-level="3" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html"><i class="fa fa-check"></i><b>3</b> Subsetting: Making big things small</a><ul>
<li class="chapter" data-level="3.1" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#select-specific-values"><i class="fa fa-check"></i><b>3.1</b> Select specific values</a></li>
<li class="chapter" data-level="3.2" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#logical-values-and-operations"><i class="fa fa-check"></i><b>3.2</b> Logical values and operations</a><ul>
<li class="chapter" data-level="3.2.1" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#matching-a-single-value"><i class="fa fa-check"></i><b>3.2.1</b> Matching a single value</a></li>
<li class="chapter" data-level="3.2.2" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#matching-multiple-values"><i class="fa fa-check"></i><b>3.2.2</b> Matching multiple values</a></li>
<li class="chapter" data-level="3.2.3" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#does-not-match"><i class="fa fa-check"></i><b>3.2.3</b> Does not match</a></li>
<li class="chapter" data-level="3.2.4" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#greater-than-or-less-than"><i class="fa fa-check"></i><b>3.2.4</b> Greater than or less than</a></li>
<li class="chapter" data-level="3.2.5" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#combining-conditional-statements---or-and"><i class="fa fa-check"></i><b>3.2.5</b> Combining conditional statements - or, and</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#subsetting-a-data.frame"><i class="fa fa-check"></i><b>3.3</b> Subsetting a data.frame</a></li>
<li class="chapter" data-level="3.4" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#select-a-specific-column"><i class="fa fa-check"></i><b>3.4</b> Select a specific column</a><ul>
<li class="chapter" data-level="3.4.1" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#select-specific-rows-in-a-data.frame"><i class="fa fa-check"></i><b>3.4.1</b> Select specific rows in a data.frame</a></li>
<li class="chapter" data-level="3.4.2" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#battleships"><i class="fa fa-check"></i><b>3.4.2</b> Battleships</a></li>
<li class="chapter" data-level="3.4.3" data-path="subsetting-making-big-things-small.html"><a href="subsetting-making-big-things-small.html#subset-colorado-data"><i class="fa fa-check"></i><b>3.4.3</b> Subset Colorado data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#summary-and-table"><i class="fa fa-check"></i><b>4.1</b> Summary and Table</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#graphing-data"><i class="fa fa-check"></i><b>4.2</b> Graphing Data</a></li>
<li class="chapter" data-level="4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#aggregating-summaries-of-groups"><i class="fa fa-check"></i><b>4.3</b> Aggregating (summaries of groups)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>5</b> Dates and Times</a><ul>
<li class="chapter" data-level="5.1" data-path="dates-and-times.html"><a href="dates-and-times.html#why-do-dates-and-times-matter"><i class="fa fa-check"></i><b>5.1</b> Why do dates and times matter?</a></li>
<li class="chapter" data-level="5.2" data-path="dates-and-times.html"><a href="dates-and-times.html#lubridate"><i class="fa fa-check"></i><b>5.2</b> <code>lubridate</code></a></li>
<li class="chapter" data-level="5.3" data-path="dates-and-times.html"><a href="dates-and-times.html#working-with-dates"><i class="fa fa-check"></i><b>5.3</b> Working with dates</a></li>
<li class="chapter" data-level="5.4" data-path="dates-and-times.html"><a href="dates-and-times.html#chicago-crime-data"><i class="fa fa-check"></i><b>5.4</b> Chicago crime data</a></li>
<li class="chapter" data-level="5.5" data-path="dates-and-times.html"><a href="dates-and-times.html#time-zones"><i class="fa fa-check"></i><b>5.5</b> Time zones</a><ul>
<li class="chapter" data-level="5.5.1" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises"><i class="fa fa-check"></i><b>5.5.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>6</b> Regular Expressions</a><ul>
<li class="chapter" data-level="6.1" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-patterns-in-text-with-grep"><i class="fa fa-check"></i><b>6.1</b> Finding patterns in text with <code>grep()</code></a></li>
<li class="chapter" data-level="6.2" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-and-replacing-patterns-in-text-with-gsub"><i class="fa fa-check"></i><b>6.2</b> Finding and replacing patterns in text with <code>gsub()</code></a></li>
<li class="chapter" data-level="6.3" data-path="regular-expressions.html"><a href="regular-expressions.html#useful-special-characters"><i class="fa fa-check"></i><b>6.3</b> Useful special characters</a><ul>
<li class="chapter" data-level="6.3.1" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-characters"><i class="fa fa-check"></i><b>6.3.1</b> Multiple characters <code>[]</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-of-previous-character-n"><i class="fa fa-check"></i><b>6.3.2</b> n-many of previous character <code>{n}</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-to-m-many-of-previous-character-nm"><i class="fa fa-check"></i><b>6.3.3</b> n-many to m-many of previous character <code>{n,m}</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="regular-expressions.html"><a href="regular-expressions.html#start-of-string-and-not"><i class="fa fa-check"></i><b>6.3.4</b> Start of string and “not” <code>^</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="regular-expressions.html"><a href="regular-expressions.html#end-of-string"><i class="fa fa-check"></i><b>6.3.5</b> End of string <code>$</code></a></li>
<li class="chapter" data-level="6.3.6" data-path="regular-expressions.html"><a href="regular-expressions.html#anything-."><i class="fa fa-check"></i><b>6.3.6</b> Anything <code>.</code></a></li>
<li class="chapter" data-level="6.3.7" data-path="regular-expressions.html"><a href="regular-expressions.html#one-or-more-of-previous"><i class="fa fa-check"></i><b>6.3.7</b> One or more of previous <code>+</code></a></li>
<li class="chapter" data-level="6.3.8" data-path="regular-expressions.html"><a href="regular-expressions.html#zero-or-more-of-previous"><i class="fa fa-check"></i><b>6.3.8</b> Zero or more of previous <code>*</code></a></li>
<li class="chapter" data-level="6.3.9" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-patterns"><i class="fa fa-check"></i><b>6.3.9</b> Multiple patterns <code>|</code></a></li>
<li class="chapter" data-level="6.3.10" data-path="regular-expressions.html"><a href="regular-expressions.html#parentheses"><i class="fa fa-check"></i><b>6.3.10</b> Parentheses <code>()</code></a></li>
<li class="chapter" data-level="6.3.11" data-path="regular-expressions.html"><a href="regular-expressions.html#optional-text"><i class="fa fa-check"></i><b>6.3.11</b> Optional text <code>?</code></a></li>
<li class="chapter" data-level="6.3.12" data-path="regular-expressions.html"><a href="regular-expressions.html#back-referencing"><i class="fa fa-check"></i><b>6.3.12</b> Back-referencing <code>()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regular-expressions.html"><a href="regular-expressions.html#changing-capitalization"><i class="fa fa-check"></i><b>6.4</b> Changing capitalization</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Graphing with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="7.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#what-does-the-data-look-like"><i class="fa fa-check"></i><b>7.1</b> What does the data look like?</a><ul>
<li class="chapter" data-level="7.1.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>7.1.1</b> Exercises</a></li>
<li class="chapter" data-level="7.1.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-2"><i class="fa fa-check"></i><b>7.1.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#graphing-data-1"><i class="fa fa-check"></i><b>7.2</b> Graphing data</a></li>
<li class="chapter" data-level="7.3" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#time-series-plots"><i class="fa fa-check"></i><b>7.3</b> Time-Series Plots</a><ul>
<li class="chapter" data-level="7.3.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-3"><i class="fa fa-check"></i><b>7.3.1</b> Exercises</a></li>
<li class="chapter" data-level="7.3.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-4"><i class="fa fa-check"></i><b>7.3.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#should-we-trust-this-data"><i class="fa fa-check"></i><b>7.4</b> Should we trust this data?</a><ul>
<li class="chapter" data-level="7.4.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-5"><i class="fa fa-check"></i><b>7.4.1</b> Exercises</a></li>
<li class="chapter" data-level="7.4.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-6"><i class="fa fa-check"></i><b>7.4.2</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html"><i class="fa fa-check"></i><b>8</b> Webscraping with <code>rvest</code></a><ul>
<li class="chapter" data-level="8.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#scraping-one-page"><i class="fa fa-check"></i><b>8.1</b> Scraping one page</a></li>
<li class="chapter" data-level="8.2" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#cleaning-the-webscraped-data"><i class="fa fa-check"></i><b>8.2</b> Cleaning the webscraped data</a></li>
<li class="chapter" data-level="8.3" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#fixing-names"><i class="fa fa-check"></i><b>8.3</b> Fixing names</a><ul>
<li class="chapter" data-level="8.3.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#exercises-7"><i class="fa fa-check"></i><b>8.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>9</b> Functions</a><ul>
<li class="chapter" data-level="9.1" data-path="functions.html"><a href="functions.html#a-simple-function"><i class="fa fa-check"></i><b>9.1</b> A simple function</a></li>
<li class="chapter" data-level="9.2" data-path="functions.html"><a href="functions.html#adding-parameters"><i class="fa fa-check"></i><b>9.2</b> Adding parameters</a></li>
<li class="chapter" data-level="9.3" data-path="functions.html"><a href="functions.html#making-a-function-to-scrape-movie-data"><i class="fa fa-check"></i><b>9.3</b> Making a function to scrape movie data</a></li>
<li class="chapter" data-level="9.4" data-path="functions.html"><a href="functions.html#the-benefits-of-functions"><i class="fa fa-check"></i><b>9.4</b> The benefits of functions</a></li>
<li class="chapter" data-level="9.5" data-path="functions.html"><a href="functions.html#understanding-other-peoples-functions"><i class="fa fa-check"></i><b>9.5</b> Understanding other people’s functions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>10</b> For loops</a><ul>
<li class="chapter" data-level="10.1" data-path="for-loops.html"><a href="for-loops.html#basic-for-loops"><i class="fa fa-check"></i><b>10.1</b> Basic for loops</a></li>
<li class="chapter" data-level="10.2" data-path="for-loops.html"><a href="for-loops.html#scraping-multiple-days-of-movie"><i class="fa fa-check"></i><b>10.2</b> Scraping multiple days of movie</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="types-of-objects.html"><a href="types-of-objects.html"><i class="fa fa-check"></i><b>11</b> Types of objects</a><ul>
<li class="chapter" data-level="11.1" data-path="types-of-objects.html"><a href="types-of-objects.html#vectors"><i class="fa fa-check"></i><b>11.1</b> Vectors</a></li>
<li class="chapter" data-level="11.2" data-path="types-of-objects.html"><a href="types-of-objects.html#data-frames"><i class="fa fa-check"></i><b>11.2</b> Data frames</a></li>
<li class="chapter" data-level="11.3" data-path="types-of-objects.html"><a href="types-of-objects.html#lists"><i class="fa fa-check"></i><b>11.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>12</b> Reading and Writing Data</a><ul>
<li class="chapter" data-level="12.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-data-into-r-1"><i class="fa fa-check"></i><b>12.1</b> Reading Data into R</a><ul>
<li class="chapter" data-level="12.1.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-files"><i class="fa fa-check"></i><b>12.1.1</b> R files</a></li>
<li class="chapter" data-level="12.1.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-files"><i class="fa fa-check"></i><b>12.1.2</b> Excel files</a></li>
<li class="chapter" data-level="12.1.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-files"><i class="fa fa-check"></i><b>12.1.3</b> Stata files</a></li>
<li class="chapter" data-level="12.1.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-files"><i class="fa fa-check"></i><b>12.1.4</b> SAS files</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-data"><i class="fa fa-check"></i><b>12.2</b> Writing Data</a><ul>
<li class="chapter" data-level="12.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-files-1"><i class="fa fa-check"></i><b>12.2.1</b> R files</a></li>
<li class="chapter" data-level="12.2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-files-1"><i class="fa fa-check"></i><b>12.2.2</b> Excel files</a></li>
<li class="chapter" data-level="12.2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-files-1"><i class="fa fa-check"></i><b>12.2.3</b> Stata files</a></li>
<li class="chapter" data-level="12.2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-files-1"><i class="fa fa-check"></i><b>12.2.4</b> SAS files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html"><i class="fa fa-check"></i><b>13</b> Scraping data from PDFs</a><ul>
<li class="chapter" data-level="13.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#downloading-officer-involved-shooting-files"><i class="fa fa-check"></i><b>13.1</b> Downloading officer-involved Shooting Files</a></li>
<li class="chapter" data-level="13.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-information-from-the-page"><i class="fa fa-check"></i><b>13.2</b> Scraping information from the page</a><ul>
<li class="chapter" data-level="13.2.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#combining-the-data-sets"><i class="fa fa-check"></i><b>13.2.1</b> Combining the data sets</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#extracting-data-from-pdfs"><i class="fa fa-check"></i><b>13.3</b> Extracting data from PDFs</a><ul>
<li class="chapter" data-level="13.3.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-a-single-pdf"><i class="fa fa-check"></i><b>13.3.1</b> Scraping a single PDF</a></li>
<li class="chapter" data-level="13.3.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#making-a-function"><i class="fa fa-check"></i><b>13.3.2</b> Making a function</a></li>
<li class="chapter" data-level="13.3.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#looping-through-every-pdf"><i class="fa fa-check"></i><b>13.3.3</b> Looping through every PDF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>14</b> Geocoding</a><ul>
<li class="chapter" data-level="14.1" data-path="geocoding.html"><a href="geocoding.html#geocoding-a-single-address"><i class="fa fa-check"></i><b>14.1</b> Geocoding a single address</a></li>
<li class="chapter" data-level="14.2" data-path="geocoding.html"><a href="geocoding.html#making-a-function-1"><i class="fa fa-check"></i><b>14.2</b> Making a function</a></li>
<li class="chapter" data-level="14.3" data-path="geocoding.html"><a href="geocoding.html#geocoding-officer-shooting-locations"><i class="fa fa-check"></i><b>14.3</b> Geocoding officer shooting locations</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="hotspot-maps.html"><a href="hotspot-maps.html"><i class="fa fa-check"></i><b>15</b> Hotspot maps</a><ul>
<li class="chapter" data-level="15.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#creating-the-maps"><i class="fa fa-check"></i><b>15.1</b> Creating the maps</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="choropleth-maps.html"><a href="choropleth-maps.html"><i class="fa fa-check"></i><b>16</b> Choropleth Maps</a><ul>
<li class="chapter" data-level="16.1" data-path="choropleth-maps.html"><a href="choropleth-maps.html#spatial-joins"><i class="fa fa-check"></i><b>16.1</b> Spatial joins</a></li>
<li class="chapter" data-level="16.2" data-path="choropleth-maps.html"><a href="choropleth-maps.html#making-choropleth-maps"><i class="fa fa-check"></i><b>16.2</b> Making choropleth maps</a></li>
<li class="chapter" data-level="16.3" data-path="choropleth-maps.html"><a href="choropleth-maps.html#getting-census-data-from-social-explorer"><i class="fa fa-check"></i><b>16.3</b> Getting Census data from Social Explorer</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>17</b> Interactive Maps</a><ul>
<li class="chapter" data-level="17.1" data-path="interactive-maps.html"><a href="interactive-maps.html#why-do-interactive-graphs-matter"><i class="fa fa-check"></i><b>17.1</b> Why do interactive graphs matter?</a><ul>
<li class="chapter" data-level="17.1.1" data-path="interactive-maps.html"><a href="interactive-maps.html#understanding-your-data"><i class="fa fa-check"></i><b>17.1.1</b> Understanding your data</a></li>
<li class="chapter" data-level="17.1.2" data-path="interactive-maps.html"><a href="interactive-maps.html#police-departments-use-them"><i class="fa fa-check"></i><b>17.1.2</b> Police departments use them</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="interactive-maps.html"><a href="interactive-maps.html#making-the-interactive-map"><i class="fa fa-check"></i><b>17.2</b> Making the interactive map</a></li>
<li class="chapter" data-level="17.3" data-path="interactive-maps.html"><a href="interactive-maps.html#adding-popup-information"><i class="fa fa-check"></i><b>17.3</b> Adding popup information</a></li>
<li class="chapter" data-level="17.4" data-path="interactive-maps.html"><a href="interactive-maps.html#dealing-with-too-many-markers"><i class="fa fa-check"></i><b>17.4</b> Dealing with too many markers</a></li>
<li class="chapter" data-level="17.5" data-path="interactive-maps.html"><a href="interactive-maps.html#interactive-polygons"><i class="fa fa-check"></i><b>17.5</b> Interactive polygons</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="graphing-officer-involved-shootings.html"><a href="graphing-officer-involved-shootings.html"><i class="fa fa-check"></i><b>18</b> Graphing Officer-Involved Shootings</a><ul>
<li class="chapter" data-level="18.1" data-path="graphing-officer-involved-shootings.html"><a href="graphing-officer-involved-shootings.html#graphing-a-single-variable"><i class="fa fa-check"></i><b>18.1</b> Graphing a single variable</a><ul>
<li class="chapter" data-level="18.1.1" data-path="graphing-officer-involved-shootings.html"><a href="graphing-officer-involved-shootings.html#numeric-variable"><i class="fa fa-check"></i><b>18.1.1</b> Numeric variable</a></li>
<li class="chapter" data-level="18.1.2" data-path="graphing-officer-involved-shootings.html"><a href="graphing-officer-involved-shootings.html#categorical-variable"><i class="fa fa-check"></i><b>18.1.2</b> Categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="graphing-officer-involved-shootings.html"><a href="graphing-officer-involved-shootings.html#time-series"><i class="fa fa-check"></i><b>18.2</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="scraping-tables-from-pdfs.html"><a href="scraping-tables-from-pdfs.html"><i class="fa fa-check"></i><b>19</b> Scraping Tables from PDFs</a></li>
<li class="chapter" data-level="20" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html"><i class="fa fa-check"></i><b>20</b> Uniform Crime Report (UCR) Data</a><ul>
<li class="chapter" data-level="20.1" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#exploring-the-ucr-data"><i class="fa fa-check"></i><b>20.1</b> Exploring the UCR data</a></li>
<li class="chapter" data-level="20.2" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#finding-things-in-our-data"><i class="fa fa-check"></i><b>20.2</b> Finding things in our data</a></li>
<li class="chapter" data-level="20.3" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#manipulating-our-data"><i class="fa fa-check"></i><b>20.3</b> Manipulating our data</a><ul>
<li class="chapter" data-level="20.3.1" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#exercises-8"><i class="fa fa-check"></i><b>20.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html"><i class="fa fa-check"></i><b>21</b> Census Data from IPUMS</a><ul>
<li class="chapter" data-level="21.1" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#getting-ipums-data"><i class="fa fa-check"></i><b>21.1</b> Getting IPUMS data</a></li>
<li class="chapter" data-level="21.2" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#cleaning-the-data"><i class="fa fa-check"></i><b>21.2</b> Cleaning the data</a></li>
<li class="chapter" data-level="21.3" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#aggregating-the-data"><i class="fa fa-check"></i><b>21.3</b> Aggregating the data</a></li>
<li class="chapter" data-level="21.4" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#graphing-the-data"><i class="fa fa-check"></i><b>21.4</b> Graphing the data</a></li>
<li class="chapter" data-level="21.5" data-path="census-data-from-ipums.html"><a href="census-data-from-ipums.html#mapping-the-data"><i class="fa fa-check"></i><b>21.5</b> Mapping the data</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="national-incident-based-reporting-system-nibrs-data.html"><a href="national-incident-based-reporting-system-nibrs-data.html"><i class="fa fa-check"></i><b>22</b> National Incident-Based Reporting System (NIBRS) Data</a><ul>
<li class="chapter" data-level="22.1" data-path="national-incident-based-reporting-system-nibrs-data.html"><a href="national-incident-based-reporting-system-nibrs-data.html#downloading-the-data"><i class="fa fa-check"></i><b>22.1</b> Downloading the data</a></li>
<li class="chapter" data-level="22.2" data-path="national-incident-based-reporting-system-nibrs-data.html"><a href="national-incident-based-reporting-system-nibrs-data.html#reading-the-data"><i class="fa fa-check"></i><b>22.2</b> Reading the data</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="useful-resources.html"><a href="useful-resources.html"><i class="fa fa-check"></i><b>A</b> Useful Resources</a><ul>
<li class="chapter" data-level="A.1" data-path="useful-resources.html"><a href="useful-resources.html#learning-r-and-coding-issues"><i class="fa fa-check"></i><b>A.1</b> Learning R and coding issues</a></li>
<li class="chapter" data-level="A.2" data-path="useful-resources.html"><a href="useful-resources.html#data"><i class="fa fa-check"></i><b>A.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i><b>B</b> Using R Markdown</a><ul>
<li class="chapter" data-level="B.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#code"><i class="fa fa-check"></i><b>B.1</b> Code</a><ul>
<li class="chapter" data-level="B.1.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#only-use-code-to-make-output"><i class="fa fa-check"></i><b>B.1.1</b> Only use code to make output</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#figures-and-tables"><i class="fa fa-check"></i><b>B.2</b> Figures and Tables</a></li>
<li class="chapter" data-level="B.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#finally-making-the-output-file"><i class="fa fa-check"></i><b>B.3</b> Finally, making the output file</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 4 Criminology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphing-with-ggplot2" class="section level1">
<h1><span class="header-section-number">7</span> Graphing with <code>ggplot2</code></h1>
<p><code>ggplot2</code> is the package we will use to make graphs. The ‘gg’ stands for ‘grammar of graphics’ which is the idea that most graphs can be made using the same few ‘pieces’. We’ll get into those pieces during this lesson. <a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">Cheat sheet for ggplot</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre>
<p>When working with new data, It’s often useful to quickly graph the data to try to understand what you’re working with. It is also useful when understanding how much to trust the data.</p>
<p>The data we will work on is data about alcohol consumption in U.S. states from 1977-2016 from the National Institute of Health. It contains the per capita alcohol consumption for each state for every year. More details on the data are available <a href="https://www.openicpsr.org/openicpsr/project/105583/version/V2/view">here</a>.</p>
<p>Their method to determine per capita consumption is amount of alcohol sold / number of people aged 14+ living in the state. We’ll return to this method at the end to discuss how much we trust the data.</p>
<p>Now we need to load the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;data/apparent_per_capita_alcohol_consumption.rda&quot;</span>)</code></pre>
<p>The name of the file is quite long so for convenience let’s copy it to a new object with a better name.</p>
<pre class="sourceCode r"><code class="sourceCode r">alcohol &lt;-<span class="st"> </span>apparent_per_capita_alcohol_consumption</code></pre>
<p>The original data has every state, region, and the US as a whole. For this lesson we’re using data subsetted to just include states. For now let’s just look at Pennsylvania</p>
<pre class="sourceCode r"><code class="sourceCode r">penn_alcohol &lt;-<span class="st"> </span>alcohol[alcohol<span class="op">$</span>state <span class="op">==</span><span class="st"> &quot;pennsylvania&quot;</span>, ]</code></pre>
<div id="what-does-the-data-look-like" class="section level2">
<h2><span class="header-section-number">7.1</span> What does the data look like?</h2>
<p>Before graphing, it’s helpful to see what the data includes. An important thing to check is what variables are available and the units of these variables.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(penn_alcohol)
<span class="co">#&gt;  [1] &quot;state&quot;                                </span>
<span class="co">#&gt;  [2] &quot;year&quot;                                 </span>
<span class="co">#&gt;  [3] &quot;ethanol_beer_gallons_per_capita&quot;      </span>
<span class="co">#&gt;  [4] &quot;ethanol_wine_gallons_per_capita&quot;      </span>
<span class="co">#&gt;  [5] &quot;ethanol_spirit_gallons_per_capita&quot;    </span>
<span class="co">#&gt;  [6] &quot;ethanol_all_drinks_gallons_per_capita&quot;</span>
<span class="co">#&gt;  [7] &quot;number_of_beers&quot;                      </span>
<span class="co">#&gt;  [8] &quot;number_of_glasses_wine&quot;               </span>
<span class="co">#&gt;  [9] &quot;number_of_shots_liquor&quot;               </span>
<span class="co">#&gt; [10] &quot;number_of_drinks_total&quot;</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(penn_alcohol)
<span class="co">#&gt;     state               year           ethanol_beer_gallons_per_capita</span>
<span class="co">#&gt;  Length:40          Length:40          Min.   :1.210                  </span>
<span class="co">#&gt;  Class :character   Class :character   1st Qu.:1.310                  </span>
<span class="co">#&gt;  Mode  :character   Mode  :character   Median :1.350                  </span>
<span class="co">#&gt;                                        Mean   :1.346                  </span>
<span class="co">#&gt;                                        3rd Qu.:1.380                  </span>
<span class="co">#&gt;                                        Max.   :1.450                  </span>
<span class="co">#&gt;  ethanol_wine_gallons_per_capita ethanol_spirit_gallons_per_capita</span>
<span class="co">#&gt;  Min.   :0.1700                  Min.   :0.4500                   </span>
<span class="co">#&gt;  1st Qu.:0.1875                  1st Qu.:0.5050                   </span>
<span class="co">#&gt;  Median :0.2100                  Median :0.5950                   </span>
<span class="co">#&gt;  Mean   :0.2250                  Mean   :0.5910                   </span>
<span class="co">#&gt;  3rd Qu.:0.2350                  3rd Qu.:0.6725                   </span>
<span class="co">#&gt;  Max.   :0.3300                  Max.   :0.7400                   </span>
<span class="co">#&gt;  ethanol_all_drinks_gallons_per_capita number_of_beers</span>
<span class="co">#&gt;  Min.   :1.850                         Min.   :286.8  </span>
<span class="co">#&gt;  1st Qu.:2.035                         1st Qu.:310.5  </span>
<span class="co">#&gt;  Median :2.200                         Median :320.0  </span>
<span class="co">#&gt;  Mean   :2.163                         Mean   :319.0  </span>
<span class="co">#&gt;  3rd Qu.:2.315                         3rd Qu.:327.1  </span>
<span class="co">#&gt;  Max.   :2.390                         Max.   :343.7  </span>
<span class="co">#&gt;  number_of_glasses_wine number_of_shots_liquor number_of_drinks_total</span>
<span class="co">#&gt;  Min.   :33.74          Min.   : 93.43         Min.   :394.7         </span>
<span class="co">#&gt;  1st Qu.:37.21          1st Qu.:104.85         1st Qu.:434.1         </span>
<span class="co">#&gt;  Median :41.67          Median :123.54         Median :469.3         </span>
<span class="co">#&gt;  Mean   :44.65          Mean   :122.71         Mean   :461.4         </span>
<span class="co">#&gt;  3rd Qu.:46.64          3rd Qu.:139.63         3rd Qu.:493.9         </span>
<span class="co">#&gt;  Max.   :65.49          Max.   :153.64         Max.   :509.9</span></code></pre>
<div id="exercises-1" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>What variables does this data include?</li>
<li>How does the units affect what kind of research we can do?
<ul>
<li>What kind of things can we do with this data?</li>
<li>What can’t we do?</li>
</ul></li>
<li>What variables would be nice to add to this data?</li>
</ol>
<ul>
<li>e.g. number of people age 14+ per state-year</li>
</ul>
<p>Looking at the correlation between numerical variables can help us understand their relationship.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(penn_alcohol<span class="op">$</span>number_of_beers,
    penn_alcohol<span class="op">$</span>number_of_glasses_wine)
<span class="co">#&gt; [1] 0.12204</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(penn_alcohol<span class="op">$</span>number_of_beers,
    penn_alcohol<span class="op">$</span>number_of_shots_liquor)
<span class="co">#&gt; [1] 0.6174096</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(penn_alcohol<span class="op">$</span>number_of_glasses_wine,
    penn_alcohol<span class="op">$</span>number_of_shots_liquor)
<span class="co">#&gt; [1] 0.6151015</span></code></pre>
</div>
<div id="exercises-2" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>What do these correlations tell us about the relationship between beer, wine, and liquor?</li>
<li>Why do you think these relationships exist?</li>
</ol>
<ul>
<li>Assuming you had no resource or time restrictions, how would you test your hypothesis?</li>
</ul>
<p>It’s also important to look for any possible outliers by checking very large or small values in the data. However, we’ll leave that until the end as it relates to our understanding of how “trustworthy” the data is.</p>
</div>
</div>
<div id="graphing-data-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Graphing data</h2>
<p>To make a simple plot using <code>ggplot()</code>, all you need to do is specify the data set and the variables you want to plot. From there you add on pieces of the graph using the + symbol and then specify what you want added.</p>
<p>In many cases, the graphs you’ll make are scatterplots of two variables and time-series plots. Time-series plots just show how a variable (e.g. crime) changes over time.</p>
</div>
<div id="time-series-plots" class="section level2">
<h2><span class="header-section-number">7.3</span> Time-Series Plots</h2>
<p>In time-series plots the x-axis is always the time variable while the y-axis is the variable whose trend over time is what we’re interested in. When you see a graph showing crime rates over time, this is the type of graph you’re looking at.</p>
<p>For <code>ggplot()</code> we need to specify 4 things</p>
<ol style="list-style-type: decimal">
<li>The data set - this is the very first thing you’ll write</li>
<li>The x-axis variable</li>
<li>The y-axis variable</li>
<li>The type of graph - e.g. line, point, etc.</li>
</ol>
<p>Some useful types of graphs are</p>
<ul>
<li>geom_point() A point graph, can be used for scatter plots</li>
<li>geom_line() A line graph</li>
<li>geom_smooth() Adds some regression lines</li>
<li>geom_bar() A barplot</li>
</ul>
<p>Let’s start with a time-series of beer consumption in Pennsylvania The code below starts by writing our data set name. Then says what our x- and y-axis variables are called. The x- and y-axis variables are within parentheses of the function called <code>aes()</code>. <code>aes()</code> stands for aesthetic and what’s included inside here describes how the graph will look. It’s not intuitive to remember, but you need to included this.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year,
                         <span class="dt">y =</span> number_of_beers))</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>When we run it we get our graph. It includes the variable names for each axis and shows the range of data through the tick marks. What is missing is the actual data. For that we need to specify what type of graph it is. We literally add it with the + followed by the type of graph we want.</p>
<p><em>YOU CANNOT START A NEW LINE WITH +</em></p>
<p>Note that on the x-axis it prints out every single year and makes it completely unreadable. That is because the “year” column is a character type, so R thinks each year is its own category. It prints every single year because it thinks we want every category shown. To fix this we can make the column numeric and <code>ggplot()</code> will be smarter about printing fewer years.</p>
<pre class="sourceCode r"><code class="sourceCode r">penn_alcohol<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(penn_alcohol<span class="op">$</span>year)</code></pre>
<p>Let’s start with point and line graphs.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can also combine different types of graphs.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It looks like there’s a huge change in beer consumption over time. But look at where they y-axis starts. It starts around 280 so really that change is only ~60 beers. That’s because when graphs don’t start at 0, it makes small changes appear big. We can fix this by forcing the y-axis to begin at 0. We add this to the graphs the same as adding anything else.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="dv">0</span>)</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now that graphs shows what looks like nearly no change even though that is also not true. Which graph is best? It’s hard to say.</p>
<p>Inside the types of graphs we can change how it is displayed</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;forestgreen&quot;</span>, <span class="dt">size =</span> <span class="fl">1.3</span>)</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Some other useful features are changing the axis labels and the graph title.</p>
<ul>
<li>xlab() x-axis label</li>
<li>ylab() y-axis label</li>
<li>ggtitle() graph title</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;forestgreen&quot;</span>, <span class="dt">size =</span> <span class="fl">1.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Beers&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;PA Annual Beer Consumption Per Capita (1977-2016)&quot;</span>)</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="exercises-3" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Exercises</h3>
<p>That’s a lot of new info so let’s stop for questions and some examples</p>
<ol style="list-style-type: decimal">
<li>Make a graph using some other variable or state</li>
<li>Add labels and a title to the graph</li>
</ol>
<p>Making a scatter plot simply requires changing the x-axis from year to another numerical variable and using geom_point().</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> number_of_shots_liquor,
                         <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This graph shows us that when liquor consumption increases, beer consumption also usually increases.</p>
</div>
<div id="exercises-4" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>What is the relationship between beer and wine consumption?</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> number_of_glasses_wine,
                         <span class="dt">y =</span> number_of_beers)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Make a scatterplot using some other pair of variables or a different state.</li>
</ol>
<p>While scatterplots can help show the relationship between variables, we lose the information of how consumption changes over time.</p>
<p>Many time-series plots show multiple variables over the same time period (e.g. murder and robbery over time). There are ways to change the data itself to make creating graphs like this easier, but let’s stick with the data we currently have and just change <code>ggplot()</code>.</p>
<p>Start with a normal line graph, this time looking at wine.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_glasses_wine)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-22-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Then include a second geom_line() with its own aes() for the second variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_glasses_wine)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_shots_liquor))</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>A problem with this is that both lines are the same color. We need to set a color for each line, and do so within <code>aes()</code>. Instead of providing a color name, we need to provide the name the color will have in the legend. Do so for both lines.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_glasses_wine,
                         <span class="dt">color =</span> <span class="st">&quot;Glasses of Wine&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_shots_liquor,
                <span class="dt">color =</span> <span class="st">&quot;number_of_shots_liquor of Liquor&quot;</span>))</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can change the legend title.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_glasses_wine,
                         <span class="dt">color =</span> <span class="st">&quot;Glasses of Wine&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_shots_liquor,
                <span class="dt">color =</span> <span class="st">&quot;number_of_shots_liquor&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Alcohol Type&quot;</span>)</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Finally, a useful option to to move the legend from the side to the bottom. This will allow the graph to be larger.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(penn_alcohol, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_glasses_wine,
                         <span class="dt">color =</span> <span class="st">&quot;Glasses of Wine&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> number_of_shots_liquor,
                <span class="dt">color =</span> <span class="st">&quot;number_of_shots_liquor&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Alcohol Type&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre>
<p><img src="graphing_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If our data was in a different format we could set colors if a different way. The way our data is setup is how most data you’ll encounter will be and, as our goal is understanding the data, this method works.</p>
</div>
</div>
<div id="should-we-trust-this-data" class="section level2">
<h2><span class="header-section-number">7.4</span> Should we trust this data?</h2>
<p>Trusting data is generally based on how well the data was collected (e.g. how much data is missing, errors in the data) as well as if we believe the method of collecting data is itself good.</p>
<p>Let’s look at how this data was collected to see how much we should trust it.</p>
<p>The National Institute of Health determined per capita consumption by dividing alcohol sales by people aged 14+ living in the state. So there’s two pieces: alcohol sales as a measure of consumption, and people aged 14+ as a measure of those doing the consuming. Alcohol sales data comes from sales or tax data for alcohol sold in that state.</p>
<div id="exercises-5" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>What assumptions are the NIH making when it comes to this data?</li>
</ol>
<ul>
<li>Do you believe these assumptions are the right ones to make?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>How would you handle alcohol use by tourists or other out-of-staters?</li>
</ol>
<p>If you have good content knowledge in the field, it’s useful to skim the data to see if it matches your expectations. This is a good gut check and fast test for any weird data.</p>
<p>Let’s take a look at the states with the highest and lowest alcohol consumption</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(alcohol)</code></pre>
</div>
<div id="exercises-6" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Are these results what you expected?</li>
<li>Does it make the data more or less trustworthy?</li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regular-expressions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="webscraping-with-rvest.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacobkap/r4crim/edit/master/graphing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
