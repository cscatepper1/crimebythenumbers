<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Regular Expressions (Find and Replace text) | R 4 Criminology</title>
  <meta name="description" content="Notes for learning and applying R to questions about crime and the justice system." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Regular Expressions (Find and Replace text) | R 4 Criminology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r4crim.com" />
  
  <meta property="og:description" content="Notes for learning and applying R to questions about crime and the justice system." />
  <meta name="github-repo" content="jacobkap/r4crim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Regular Expressions (Find and Replace text) | R 4 Criminology" />
  
  <meta name="twitter:description" content="Notes for learning and applying R to questions about crime and the justice system." />
  

<meta name="author" content="Jacob Kaplan" />
<meta name="author" content="Greg Ridgeway" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dates-and-times.html">
<link rel="next" href="graphing-with-ggplot2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99359926-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99359926-6');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Criminology</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-math"><i class="fa fa-check"></i><b>1.1</b> Basic Math</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#combining-values-together-into-a-collection-or-vector"><i class="fa fa-check"></i><b>1.2</b> Combining values together into a collection (or vector)</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#assignment-of-values-to-variables-making-things"><i class="fa fa-check"></i><b>1.3</b> Assignment of values to variables (Making “things”)</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>1.4</b> Reading data into R</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#setting-the-working-directory"><i class="fa fa-check"></i><b>1.4.1</b> Setting the working directory</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#loading-data"><i class="fa fa-check"></i><b>1.4.2</b> Loading data</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#first-steps-to-explore-the-data"><i class="fa fa-check"></i><b>1.4.3</b> First steps to explore the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html"><i class="fa fa-check"></i><b>2</b> Subsetting: Choosing specific rows and columns</a><ul>
<li class="chapter" data-level="2.1" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#select-specific-rows"><i class="fa fa-check"></i><b>2.1</b> Select specific rows</a></li>
<li class="chapter" data-level="2.2" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#logical-values-and-operations"><i class="fa fa-check"></i><b>2.2</b> Logical values and operations</a><ul>
<li class="chapter" data-level="2.2.1" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#matching-a-single-value"><i class="fa fa-check"></i><b>2.2.1</b> Matching a single value</a></li>
<li class="chapter" data-level="2.2.2" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#matching-multiple-values"><i class="fa fa-check"></i><b>2.2.2</b> Matching multiple values</a></li>
<li class="chapter" data-level="2.2.3" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#does-not-match"><i class="fa fa-check"></i><b>2.2.3</b> Does not match</a></li>
<li class="chapter" data-level="2.2.4" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#greater-than-or-less-than"><i class="fa fa-check"></i><b>2.2.4</b> Greater than or less than</a></li>
<li class="chapter" data-level="2.2.5" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#combining-conditional-statements---or-and"><i class="fa fa-check"></i><b>2.2.5</b> Combining conditional statements - or, and</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#subsetting-a-data.frame"><i class="fa fa-check"></i><b>2.3</b> Subsetting a data.frame</a></li>
<li class="chapter" data-level="2.4" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#select-a-specific-column"><i class="fa fa-check"></i><b>2.4</b> Select a specific column</a><ul>
<li class="chapter" data-level="2.4.1" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#select-specific-rows-in-a-data.frame"><i class="fa fa-check"></i><b>2.4.1</b> Select specific rows in a data.frame</a></li>
<li class="chapter" data-level="2.4.2" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#battleships"><i class="fa fa-check"></i><b>2.4.2</b> Battleships</a></li>
<li class="chapter" data-level="2.4.3" data-path="subsetting-choosing-specific-rows-and-columns.html"><a href="subsetting-choosing-specific-rows-and-columns.html#subset-colorado-data"><i class="fa fa-check"></i><b>2.4.3</b> Subset Colorado data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#summary-and-table"><i class="fa fa-check"></i><b>3.1</b> Summary and Table</a></li>
<li class="chapter" data-level="3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#graphing-data"><i class="fa fa-check"></i><b>3.2</b> Graphing Data</a></li>
<li class="chapter" data-level="3.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#aggregating-summaries-of-groups"><i class="fa fa-check"></i><b>3.3</b> Aggregating (summaries of groups)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>4</b> Dates and Times</a><ul>
<li class="chapter" data-level="4.1" data-path="dates-and-times.html"><a href="dates-and-times.html#why-do-dates-and-times-matter"><i class="fa fa-check"></i><b>4.1</b> Why do dates and times matter?</a></li>
<li class="chapter" data-level="4.2" data-path="dates-and-times.html"><a href="dates-and-times.html#lubridate"><i class="fa fa-check"></i><b>4.2</b> lubridate</a></li>
<li class="chapter" data-level="4.3" data-path="dates-and-times.html"><a href="dates-and-times.html#working-with-dates"><i class="fa fa-check"></i><b>4.3</b> Working with dates</a></li>
<li class="chapter" data-level="4.4" data-path="dates-and-times.html"><a href="dates-and-times.html#chicago-crime-data"><i class="fa fa-check"></i><b>4.4</b> Chicago crime data</a></li>
<li class="chapter" data-level="4.5" data-path="dates-and-times.html"><a href="dates-and-times.html#time-zones"><i class="fa fa-check"></i><b>4.5</b> Time zones</a><ul>
<li class="chapter" data-level="4.5.1" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises"><i class="fa fa-check"></i><b>4.5.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html"><i class="fa fa-check"></i><b>5</b> Regular Expressions (Find and Replace text)</a><ul>
<li class="chapter" data-level="5.1" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#finding-patterns-in-text-with-grep"><i class="fa fa-check"></i><b>5.1</b> Finding patterns in text with <code>grep()</code></a></li>
<li class="chapter" data-level="5.2" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#finding-and-replacing-patterns-in-text-with-gsub"><i class="fa fa-check"></i><b>5.2</b> Finding and replacing patterns in text with <code>gsub()</code></a></li>
<li class="chapter" data-level="5.3" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#more-symbols-that-help-us-with-grepping"><i class="fa fa-check"></i><b>5.3</b> More Symbols That Help Us with grepping</a><ul>
<li class="chapter" data-level="5.3.1" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#anything"><i class="fa fa-check"></i><b>5.3.1</b> Anything <code>*</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#carets"><i class="fa fa-check"></i><b>5.3.2</b> Carets <code>^</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#dollar-signs"><i class="fa fa-check"></i><b>5.3.3</b> Dollar Signs <code>$</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#plus-sign"><i class="fa fa-check"></i><b>5.3.4</b> Plus Sign <code>+</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#parentheses"><i class="fa fa-check"></i><b>5.3.5</b> Parentheses <code>()</code></a></li>
<li class="chapter" data-level="5.3.6" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#vertical-bar"><i class="fa fa-check"></i><b>5.3.6</b> Vertical Bar <code>|</code></a></li>
<li class="chapter" data-level="5.3.7" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#question-mark"><i class="fa fa-check"></i><b>5.3.7</b> Question Mark <code>?</code></a></li>
<li class="chapter" data-level="5.3.8" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#boundaries-b"><i class="fa fa-check"></i><b>5.3.8</b> Boundaries <code>\b</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#back-referencing"><i class="fa fa-check"></i><b>5.4</b> Back-Referencing</a></li>
<li class="chapter" data-level="5.5" data-path="regular-expressions-find-and-replace-text.html"><a href="regular-expressions-find-and-replace-text.html#lookaheads"><i class="fa fa-check"></i><b>5.5</b> Lookaheads</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Graphing with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="6.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#what-does-the-data-look-like"><i class="fa fa-check"></i><b>6.1</b> What does the data look like?</a><ul>
<li class="chapter" data-level="6.1.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-1"><i class="fa fa-check"></i><b>6.1.1</b> Exercises</a></li>
<li class="chapter" data-level="6.1.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-2"><i class="fa fa-check"></i><b>6.1.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#graphing-data-1"><i class="fa fa-check"></i><b>6.2</b> Graphing data</a></li>
<li class="chapter" data-level="6.3" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#time-series-plots"><i class="fa fa-check"></i><b>6.3</b> Time-Series Plots</a><ul>
<li class="chapter" data-level="6.3.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-3"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
<li class="chapter" data-level="6.3.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-4"><i class="fa fa-check"></i><b>6.3.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#should-we-trust-this-data"><i class="fa fa-check"></i><b>6.4</b> Should we trust this data?</a><ul>
<li class="chapter" data-level="6.4.1" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-5"><i class="fa fa-check"></i><b>6.4.1</b> Exercises</a></li>
<li class="chapter" data-level="6.4.2" data-path="graphing-with-ggplot2.html"><a href="graphing-with-ggplot2.html#exercises-6"><i class="fa fa-check"></i><b>6.4.2</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="webscraping.html"><a href="webscraping.html"><i class="fa fa-check"></i><b>7</b> Webscraping</a><ul>
<li class="chapter" data-level="7.1" data-path="webscraping.html"><a href="webscraping.html#scraping-one-page"><i class="fa fa-check"></i><b>7.1</b> Scraping one page</a></li>
<li class="chapter" data-level="7.2" data-path="webscraping.html"><a href="webscraping.html#cleaning-the-webscraped-data"><i class="fa fa-check"></i><b>7.2</b> Cleaning the webscraped data</a></li>
<li class="chapter" data-level="7.3" data-path="webscraping.html"><a href="webscraping.html#fixing-names"><i class="fa fa-check"></i><b>7.3</b> Fixing names</a><ul>
<li class="chapter" data-level="7.3.1" data-path="webscraping.html"><a href="webscraping.html#exercises-7"><i class="fa fa-check"></i><b>7.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>8</b> Functions</a><ul>
<li class="chapter" data-level="8.1" data-path="functions.html"><a href="functions.html#a-simple-function"><i class="fa fa-check"></i><b>8.1</b> A simple function</a></li>
<li class="chapter" data-level="8.2" data-path="functions.html"><a href="functions.html#adding-parameters"><i class="fa fa-check"></i><b>8.2</b> Adding parameters</a></li>
<li class="chapter" data-level="8.3" data-path="functions.html"><a href="functions.html#making-a-function-to-scrape-movie-data"><i class="fa fa-check"></i><b>8.3</b> Making a function to scrape movie data</a></li>
<li class="chapter" data-level="8.4" data-path="functions.html"><a href="functions.html#understanding-other-peoples-functions."><i class="fa fa-check"></i><b>8.4</b> Understanding other people’s functions.</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>9</b> For loops</a><ul>
<li class="chapter" data-level="9.1" data-path="for-loops.html"><a href="for-loops.html#basic-for-loops"><i class="fa fa-check"></i><b>9.1</b> Basic for loops</a></li>
<li class="chapter" data-level="9.2" data-path="for-loops.html"><a href="for-loops.html#scraping-multiple-days-of-movie"><i class="fa fa-check"></i><b>9.2</b> Scraping multiple days of movie</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="types-of-objects.html"><a href="types-of-objects.html"><i class="fa fa-check"></i><b>10</b> Types of objects</a><ul>
<li class="chapter" data-level="10.1" data-path="types-of-objects.html"><a href="types-of-objects.html#vectors"><i class="fa fa-check"></i><b>10.1</b> Vectors</a></li>
<li class="chapter" data-level="10.2" data-path="types-of-objects.html"><a href="types-of-objects.html#data-frames"><i class="fa fa-check"></i><b>10.2</b> Data frames</a></li>
<li class="chapter" data-level="10.3" data-path="types-of-objects.html"><a href="types-of-objects.html#lists"><i class="fa fa-check"></i><b>10.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>11</b> Reading and Writing Data</a><ul>
<li class="chapter" data-level="11.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-data-into-r-1"><i class="fa fa-check"></i><b>11.1</b> Reading Data into R</a><ul>
<li class="chapter" data-level="11.1.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-files"><i class="fa fa-check"></i><b>11.1.1</b> R files</a></li>
<li class="chapter" data-level="11.1.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-files"><i class="fa fa-check"></i><b>11.1.2</b> Excel files</a></li>
<li class="chapter" data-level="11.1.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-files"><i class="fa fa-check"></i><b>11.1.3</b> Stata files</a></li>
<li class="chapter" data-level="11.1.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-files"><i class="fa fa-check"></i><b>11.1.4</b> SAS files</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-data"><i class="fa fa-check"></i><b>11.2</b> Writing Data</a><ul>
<li class="chapter" data-level="11.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-files-1"><i class="fa fa-check"></i><b>11.2.1</b> R files</a></li>
<li class="chapter" data-level="11.2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-files-1"><i class="fa fa-check"></i><b>11.2.2</b> Excel files</a></li>
<li class="chapter" data-level="11.2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-files-1"><i class="fa fa-check"></i><b>11.2.3</b> Stata files</a></li>
<li class="chapter" data-level="11.2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-files-1"><i class="fa fa-check"></i><b>11.2.4</b> SAS files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html"><i class="fa fa-check"></i><b>12</b> Scraping data from PDFs</a><ul>
<li class="chapter" data-level="12.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#downloading-officer-involved-shooting-files"><i class="fa fa-check"></i><b>12.1</b> Downloading Officer Involved Shooting Files</a></li>
<li class="chapter" data-level="12.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-information-from-the-page"><i class="fa fa-check"></i><b>12.2</b> Scraping information from the page</a><ul>
<li class="chapter" data-level="12.2.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#combining-the-data-sets"><i class="fa fa-check"></i><b>12.2.1</b> Combining the data sets</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#extracting-data-from-pdfs"><i class="fa fa-check"></i><b>12.3</b> Extracting data from PDFs</a><ul>
<li class="chapter" data-level="12.3.1" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#scraping-a-single-pdf"><i class="fa fa-check"></i><b>12.3.1</b> Scraping a single PDF</a></li>
<li class="chapter" data-level="12.3.2" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#making-a-function"><i class="fa fa-check"></i><b>12.3.2</b> Making a function</a></li>
<li class="chapter" data-level="12.3.3" data-path="scraping-data-from-pdfs.html"><a href="scraping-data-from-pdfs.html#looping-through-every-pdf"><i class="fa fa-check"></i><b>12.3.3</b> Looping through every PDF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>13</b> Geocoding</a><ul>
<li class="chapter" data-level="13.1" data-path="geocoding.html"><a href="geocoding.html#geocoding-a-single-address"><i class="fa fa-check"></i><b>13.1</b> Geocoding a single address</a></li>
<li class="chapter" data-level="13.2" data-path="geocoding.html"><a href="geocoding.html#making-a-function-1"><i class="fa fa-check"></i><b>13.2</b> Making a function</a></li>
<li class="chapter" data-level="13.3" data-path="geocoding.html"><a href="geocoding.html#geocoding-officer-shooting-locations"><i class="fa fa-check"></i><b>13.3</b> Geocoding officer shooting locations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hotspot-maps.html"><a href="hotspot-maps.html"><i class="fa fa-check"></i><b>14</b> Hotspot maps</a><ul>
<li class="chapter" data-level="14.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#creating-the-maps"><i class="fa fa-check"></i><b>14.1</b> Creating the maps</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="choropleth-maps.html"><a href="choropleth-maps.html"><i class="fa fa-check"></i><b>15</b> Choropleth Maps</a></li>
<li class="chapter" data-level="16" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>16</b> Interactive Maps</a><ul>
<li class="chapter" data-level="16.1" data-path="interactive-maps.html"><a href="interactive-maps.html#why-do-interactive-graphs-matter"><i class="fa fa-check"></i><b>16.1</b> Why do interactive graphs matter?</a><ul>
<li class="chapter" data-level="16.1.1" data-path="interactive-maps.html"><a href="interactive-maps.html#understanding-your-data"><i class="fa fa-check"></i><b>16.1.1</b> Understanding your data</a></li>
<li class="chapter" data-level="16.1.2" data-path="interactive-maps.html"><a href="interactive-maps.html#police-departments-use-them"><i class="fa fa-check"></i><b>16.1.2</b> Police departments use them</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="interactive-maps.html"><a href="interactive-maps.html#making-the-interactive-map"><i class="fa fa-check"></i><b>16.2</b> Making the interactive map</a></li>
<li class="chapter" data-level="16.3" data-path="interactive-maps.html"><a href="interactive-maps.html#adding-popup-information"><i class="fa fa-check"></i><b>16.3</b> Adding popup information</a></li>
<li class="chapter" data-level="16.4" data-path="interactive-maps.html"><a href="interactive-maps.html#dealing-with-too-many-markers"><i class="fa fa-check"></i><b>16.4</b> Dealing with too many markers</a></li>
<li class="chapter" data-level="16.5" data-path="interactive-maps.html"><a href="interactive-maps.html#interactive-polygons"><i class="fa fa-check"></i><b>16.5</b> Interactive polygons</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html"><i class="fa fa-check"></i><b>17</b> Uniform Crime Report (UCR) Data</a><ul>
<li class="chapter" data-level="17.1" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#exploring-the-ucr-data"><i class="fa fa-check"></i><b>17.1</b> Exploring the UCR data</a></li>
<li class="chapter" data-level="17.2" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#finding-things-in-our-data"><i class="fa fa-check"></i><b>17.2</b> Finding things in our data</a></li>
<li class="chapter" data-level="17.3" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#manipulating-our-data"><i class="fa fa-check"></i><b>17.3</b> Manipulating our data</a><ul>
<li class="chapter" data-level="17.3.1" data-path="uniform-crime-report-ucr-data.html"><a href="uniform-crime-report-ucr-data.html#exercises-8"><i class="fa fa-check"></i><b>17.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="census-data.html"><a href="census-data.html"><i class="fa fa-check"></i><b>18</b> Census Data</a></li>
<li class="chapter" data-level="19" data-path="national-incident-based-reporting-system-nibrs-data.html"><a href="national-incident-based-reporting-system-nibrs-data.html"><i class="fa fa-check"></i><b>19</b> National Incident-Based Reporting System (NIBRS) Data</a><ul>
<li class="chapter" data-level="19.1" data-path="national-incident-based-reporting-system-nibrs-data.html"><a href="national-incident-based-reporting-system-nibrs-data.html#downloading-the-data"><i class="fa fa-check"></i><b>19.1</b> Downloading the data</a></li>
<li class="chapter" data-level="19.2" data-path="national-incident-based-reporting-system-nibrs-data.html"><a href="national-incident-based-reporting-system-nibrs-data.html#reading-the-data"><i class="fa fa-check"></i><b>19.2</b> Reading the data</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="useful-resources.html"><a href="useful-resources.html"><i class="fa fa-check"></i><b>A</b> Useful Resources</a><ul>
<li class="chapter" data-level="A.1" data-path="useful-resources.html"><a href="useful-resources.html#learning-r-and-coding-issues"><i class="fa fa-check"></i><b>A.1</b> Learning R and coding issues</a></li>
<li class="chapter" data-level="A.2" data-path="useful-resources.html"><a href="useful-resources.html#data"><i class="fa fa-check"></i><b>A.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="using-rmarkdown.html"><a href="using-rmarkdown.html"><i class="fa fa-check"></i><b>B</b> Using RMarkdown</a><ul>
<li class="chapter" data-level="B.1" data-path="using-rmarkdown.html"><a href="using-rmarkdown.html#code"><i class="fa fa-check"></i><b>B.1</b> Code</a><ul>
<li class="chapter" data-level="B.1.1" data-path="using-rmarkdown.html"><a href="using-rmarkdown.html#only-use-code-to-make-output"><i class="fa fa-check"></i><b>B.1.1</b> Only use code to make output</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="using-rmarkdown.html"><a href="using-rmarkdown.html#figures-and-tables"><i class="fa fa-check"></i><b>B.2</b> Figures and Tables</a></li>
<li class="chapter" data-level="B.3" data-path="using-rmarkdown.html"><a href="using-rmarkdown.html#finally-making-the-output-file"><i class="fa fa-check"></i><b>B.3</b> Finally, making the output file</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 4 Criminology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regular-expressions-find-and-replace-text" class="section level1">
<h1><span class="header-section-number">5</span> Regular Expressions (Find and Replace text)</h1>
<p>A regular expression is a sequence of characters that defines a search pattern. Sometimes we use regular expressions to help us find a pattern in text that we want, like the Find functionality in Word. Other times, we use a regular expression to help us find and <em>replace</em> a piece of text, like the Find and Replace functionality in Word. The two main R functions that we will learn about are <code>grep()</code> and <code>gsub()</code>. You may use them in verb form (e.g., “I need to grep all the gun cases,” “I was grepping like crazy to find all the opioid cases,” “I first had to gsub the commas with semicolons”). Regular expressions are available in numerous other software packages, so everything you learn here will port over to using regular expressions in Linux, Stata, Python, Java, ArcGIS, and many others.</p>
<p>We’ve already used regular expressions in previous work that we’ve done. We had to clean up the NCVS data since the text description of crime types changed from one year to the next. In 2012 the NCVS crime type had a leading 0, like “(01) Completed rape” and then in 2013 the crime type did not have the leading 0 like “(1) Completed rape”. In order to tabulate the number of rapes in the calendar year 2012, we had to combine the data collected in 2012 and 2013 and reformat the crime types with rather mysterious looking code <code>gsub("\\(([1-9])\\)", "(0\\1)", data.inc$V4529)</code>. This will all become clear in these notes.</p>
<div id="finding-patterns-in-text-with-grep" class="section level2">
<h2><span class="header-section-number">5.1</span> Finding patterns in text with <code>grep()</code></h2>
<p>First we’ll learn about <code>grep()</code>, which was first developed in the early 1970s. <code>grep()</code> searches data for lines that match a given expression. The name <code>grep</code> is an acronym for “<em>g</em>lobally search a <em>r</em>egular <em>e</em>xpression and <em>p</em>rint.” Some tangible examples will help us see how <code>grep()</code> works.</p>
<p>First, run the following line that provides a collect of text elements with a diverse range of capitalization, letters, punctuation, and other features.</p>
<pre class="sourceCode r"><code class="sourceCode r">dataText &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;suspect&quot;</span>,
              <span class="st">&quot;three suspects&quot;</span>,
              <span class="st">&quot;3 suspects&quot;</span>,
              <span class="st">&quot;9mm firearm&quot;</span>,
              <span class="st">&quot;483 McNeil Building&quot;</span>,
              <span class="st">&quot;3718 Locust Walk&quot;</span>,
              <span class="st">&quot;4 Privet Drive&quot;</span>,
              <span class="st">&quot;10880 Malibu Point&quot;</span>,
              <span class="st">&quot;Philadelphia, PA&quot;</span>,
              <span class="st">&quot;Philly&quot;</span>,
              <span class="st">&quot;Phila&quot;</span>,
              <span class="st">&quot;Phil.&quot;</span>,
              <span class="st">&quot;Phil Dunphy&quot;</span>,
              <span class="st">&quot;19104-6286&quot;</span>,
              <span class="st">&quot;20015&quot;</span>,
              <span class="st">&quot;90291&quot;</span>,
              <span class="st">&quot;90210&quot;</span>,
              <span class="st">&quot;(215) 573-9097&quot;</span>,
              <span class="st">&quot;215-573-9097&quot;</span>,
              <span class="st">&quot;2155739097&quot;</span>)</code></pre>
</div>
<div id="finding-and-replacing-patterns-in-text-with-gsub" class="section level2">
<h2><span class="header-section-number">5.2</span> Finding and replacing patterns in text with <code>gsub()</code></h2>
<p><code>gsub()</code> stands for “global substitution.” It is useful for automating the editing of text, including deleting characters from text or extracting only parts of text. For example, let’s try to remove all numbers from our <code>dataText</code> list.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;[0-9]&quot;</span>,<span class="st">&quot;&quot;</span>,dataText)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>          <span class="st">&quot;three suspects&quot;</span>   <span class="st">&quot; suspects&quot;</span>       
 [<span class="dv">4</span>] <span class="st">&quot;mm firearm&quot;</span>       <span class="st">&quot; McNeil Building&quot;</span> <span class="st">&quot; Locust Walk&quot;</span>    
 [<span class="dv">7</span>] <span class="st">&quot; Privet Drive&quot;</span>    <span class="st">&quot; Malibu Point&quot;</span>    <span class="st">&quot;Philadelphia, PA&quot;</span>
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>           <span class="st">&quot;Phila&quot;</span>            <span class="st">&quot;Phil.&quot;</span>           
[<span class="dv">13</span>] <span class="st">&quot;Phil Dunphy&quot;</span>      <span class="st">&quot;-&quot;</span>                <span class="st">&quot;&quot;</span>                
[<span class="dv">16</span>] <span class="st">&quot;&quot;</span>                 <span class="st">&quot;&quot;</span>                 <span class="st">&quot;() -&quot;</span>            
[<span class="dv">19</span>] <span class="st">&quot;--&quot;</span>               <span class="st">&quot;&quot;</span>                </code></pre>
<p>The first parameter of the <code>gsub()</code> function is the “find pattern,” what we are asking <code>gsub()</code> to find. The second parameter is a “replacement pattern” that will replace whatever <code>gsub()</code> matched with the find pattern. Lastly, like <code>grep()</code>, we need to tell <code>gsub()</code> the name of the data object in which it should look for the pattern.</p>
<p>With <code>gsub()</code> we will be using a lot of the same grammar, such as carats, brackets, and dashes, that we used with <code>grep()</code>. To illustrate, let’s remove anything that is not a number from text.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;[^0-9]&quot;</span>,<span class="st">&quot;&quot;</span>,dataText)
 [<span class="dv">1</span>] <span class="st">&quot;&quot;</span>           <span class="st">&quot;&quot;</span>           <span class="st">&quot;3&quot;</span>          <span class="st">&quot;9&quot;</span>          <span class="st">&quot;483&quot;</span>       
 [<span class="dv">6</span>] <span class="st">&quot;3718&quot;</span>       <span class="st">&quot;4&quot;</span>          <span class="st">&quot;10880&quot;</span>      <span class="st">&quot;&quot;</span>           <span class="st">&quot;&quot;</span>          
[<span class="dv">11</span>] <span class="st">&quot;&quot;</span>           <span class="st">&quot;&quot;</span>           <span class="st">&quot;&quot;</span>           <span class="st">&quot;191046286&quot;</span>  <span class="st">&quot;20015&quot;</span>     
[<span class="dv">16</span>] <span class="st">&quot;90291&quot;</span>      <span class="st">&quot;90210&quot;</span>      <span class="st">&quot;2155739097&quot;</span> <span class="st">&quot;2155739097&quot;</span> <span class="st">&quot;2155739097&quot;</span></code></pre>
<p>Let’s find all of the items that have the letter “a” in <code>dataText</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;a&quot;</span>, dataText)
[<span class="dv">1</span>]  <span class="dv">4</span>  <span class="dv">6</span>  <span class="dv">8</span>  <span class="dv">9</span> <span class="dv">11</span></code></pre>
<p>This shows the indices of which elements of <code>dataText</code> have an “a” in them. Sure enough the fourth element, “9mm firearm”, has an “a” and you can confirm that the other indices <code>grep()</code> returned also indicate elements of <code>dataText</code> that have an “a”.</p>
<p>For most of these notes we’re going to set <code>value = TRUE</code>, which will return the actual elements matched rather than their indices. This will make it easier to check that <code>grep()</code> is finding the elements that we are expecting to match.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;a&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;9mm firearm&quot;</span>        <span class="st">&quot;3718 Locust Walk&quot;</span>   <span class="st">&quot;10880 Malibu Point&quot;</span>
[<span class="dv">4</span>] <span class="st">&quot;Philadelphia, PA&quot;</span>   <span class="st">&quot;Phila&quot;</span>             </code></pre>
<p>As you can see, <code>grep()</code> uses the following general syntax: grep(“what we’re searching for”, the text, and an optional <code>value = TRUE</code> if we want to return text). If we put <code>value = FALSE</code> or don’t put <code>value = TRUE</code>, we will just receive the index in the text where we can find what we’re searching for.</p>
<p>Let’s try another example. Instead of a letter, let’s try to find a number such as “1”. Specifically, which items in <code>dataText</code> have a “1” in them?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;1&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;3718 Locust Walk&quot;</span>   <span class="st">&quot;10880 Malibu Point&quot;</span> <span class="st">&quot;19104-6286&quot;</span>        
[<span class="dv">4</span>] <span class="st">&quot;20015&quot;</span>              <span class="st">&quot;90291&quot;</span>              <span class="st">&quot;90210&quot;</span>             
[<span class="dv">7</span>] <span class="st">&quot;(215) 573-9097&quot;</span>     <span class="st">&quot;215-573-9097&quot;</span>       <span class="st">&quot;2155739097&quot;</span>        </code></pre>
<p>We can also search for multiple characters, instead of individual characters. We place our list of desired characters within square brackets <code>[  ]</code>. For example, let’s find items that contain numbers.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0123456789]&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
 [<span class="dv">1</span>] <span class="st">&quot;3 suspects&quot;</span>          <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span>
 [<span class="dv">4</span>] <span class="st">&quot;3718 Locust Walk&quot;</span>    <span class="st">&quot;4 Privet Drive&quot;</span>      <span class="st">&quot;10880 Malibu Point&quot;</span> 
 [<span class="dv">7</span>] <span class="st">&quot;19104-6286&quot;</span>          <span class="st">&quot;20015&quot;</span>               <span class="st">&quot;90291&quot;</span>              
[<span class="dv">10</span>] <span class="st">&quot;90210&quot;</span>               <span class="st">&quot;(215) 573-9097&quot;</span>      <span class="st">&quot;215-573-9097&quot;</span>       
[<span class="dv">13</span>] <span class="st">&quot;2155739097&quot;</span>         </code></pre>
<p>If we wanted items that contain an odd number, we could do this.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[13579]&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
 [<span class="dv">1</span>] <span class="st">&quot;3 suspects&quot;</span>          <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span>
 [<span class="dv">4</span>] <span class="st">&quot;3718 Locust Walk&quot;</span>    <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;19104-6286&quot;</span>         
 [<span class="dv">7</span>] <span class="st">&quot;20015&quot;</span>               <span class="st">&quot;90291&quot;</span>               <span class="st">&quot;90210&quot;</span>              
[<span class="dv">10</span>] <span class="st">&quot;(215) 573-9097&quot;</span>      <span class="st">&quot;215-573-9097&quot;</span>        <span class="st">&quot;2155739097&quot;</span>         </code></pre>
<p>So the <code>[]</code> in a regular expression means “match any of these characters.” We can also place square brackets next to each other. For example, let’s say we wanted to find an item in <code>dataText</code> that has four adjacent numbers.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9][0-9][0-9][0-9]&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;3718 Locust Walk&quot;</span>   <span class="st">&quot;10880 Malibu Point&quot;</span> <span class="st">&quot;19104-6286&quot;</span>        
[<span class="dv">4</span>] <span class="st">&quot;20015&quot;</span>              <span class="st">&quot;90291&quot;</span>              <span class="st">&quot;90210&quot;</span>             
[<span class="dv">7</span>] <span class="st">&quot;(215) 573-9097&quot;</span>     <span class="st">&quot;215-573-9097&quot;</span>       <span class="st">&quot;2155739097&quot;</span>        </code></pre>
<p>Note that we can use the shorthand <code>0-9</code> to mean any number between 0 and 9, including 0 and 9. This regular expression says “find a number, followed by a number, followed by another number, followed by another number.” Alternatively we can use <code>{4}</code> to mean “match four of the previous character”.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{4}&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;3718 Locust Walk&quot;</span>   <span class="st">&quot;10880 Malibu Point&quot;</span> <span class="st">&quot;19104-6286&quot;</span>        
[<span class="dv">4</span>] <span class="st">&quot;20015&quot;</span>              <span class="st">&quot;90291&quot;</span>              <span class="st">&quot;90210&quot;</span>             
[<span class="dv">7</span>] <span class="st">&quot;(215) 573-9097&quot;</span>     <span class="st">&quot;215-573-9097&quot;</span>       <span class="st">&quot;2155739097&quot;</span>        </code></pre>
<p>{n} means the preceding item will be matched exactly n times. Note that this also matches text that has five or more numbers in a row, since if they have five numbers in a row, then they will also have four numbers in a row. Later we will learn about how to find exactly four numbers in a row.</p>
<p>We can also use the squiggly brackets to make a range.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{5,10}&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;10880 Malibu Point&quot;</span> <span class="st">&quot;19104-6286&quot;</span>         <span class="st">&quot;20015&quot;</span>             
[<span class="dv">4</span>] <span class="st">&quot;90291&quot;</span>              <span class="st">&quot;90210&quot;</span>              <span class="st">&quot;2155739097&quot;</span>        </code></pre>
<p>Thus {n,m} will find something matched between n and m times. We’ve used examples above with numbers, but you can apply this syntax to letters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[a-zA-Z]{5}&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>             <span class="st">&quot;three suspects&quot;</span>      <span class="st">&quot;3 suspects&quot;</span>         
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span> <span class="st">&quot;3718 Locust Walk&quot;</span>   
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet Drive&quot;</span>      <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;Philadelphia, PA&quot;</span>   
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>              <span class="st">&quot;Phila&quot;</span>               <span class="st">&quot;Phil Dunphy&quot;</span>        </code></pre>
<p>Note how we used the shorthand <code>a-z</code> to mean any lowercase letter and <code>A-Z</code> to mean any uppercase letter. <code>grep()</code> will match a different set of elements if we just search for lower case letters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[a-z]{5}&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>             <span class="st">&quot;three suspects&quot;</span>      <span class="st">&quot;3 suspects&quot;</span>         
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span> <span class="st">&quot;3718 Locust Walk&quot;</span>   
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet Drive&quot;</span>      <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;Philadelphia, PA&quot;</span>   
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>              <span class="st">&quot;Phil Dunphy&quot;</span>        </code></pre>
<p>Searches using <code>grep()</code> are case-sensitive. For example, let’s find all items that contain capital letters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[A-Z]&quot;</span>, dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;483 McNeil Building&quot;</span> <span class="st">&quot;3718 Locust Walk&quot;</span>    <span class="st">&quot;4 Privet Drive&quot;</span>     
[<span class="dv">4</span>] <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;Philadelphia, PA&quot;</span>    <span class="st">&quot;Philly&quot;</span>             
[<span class="dv">7</span>] <span class="st">&quot;Phila&quot;</span>               <span class="st">&quot;Phil.&quot;</span>               <span class="st">&quot;Phil Dunphy&quot;</span>        </code></pre>
</div>
<div id="more-symbols-that-help-us-with-grepping" class="section level2">
<h2><span class="header-section-number">5.3</span> More Symbols That Help Us with grepping</h2>
<p>So far you have seen that we use <code>[]</code> to match any character listed between the <code>[]</code>, the <code>-</code> to specify a range to match like <code>0-9</code>, <code>a-z</code>, and <code>A-Z</code>, and the <code>{}</code> to match the previous character multiple times.</p>
<p>In additional to these, there are several more symbols or sequences of symbols that are useful. The number of symbols on the keyboard are fairly limited compared to the numerous combinations of patterns of text we might wish to find. As a result you will see that some of these symbols are used in very different ways depending on the context.</p>
<div id="anything" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Anything <code>*</code></h3>
</div>
<div id="carets" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Carets <code>^</code></h3>
<p>Let’s look at the caret <code>^</code> symbol. When we put a <code>^</code> within square brackets, it means “not”. Let’s try to find text in <code>dataText</code> that has something that is not a letter immediately followed by a letter.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[^A-Za-z ][A-Za-z]&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;9mm firearm&quot;</span></code></pre>
<p>“9mm firearm” has a character that is not a letter (9) immediately followed by a letter (m).</p>
<p>When we put the <code>^</code> outside of square bracket, it means “the beginning of the text”. For example, the following regular expression matches text where the first character is either an upper-case or a lower-case letter.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;^[A-Za-z]&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>          <span class="st">&quot;three suspects&quot;</span>   <span class="st">&quot;Philadelphia, PA&quot;</span>
[<span class="dv">4</span>] <span class="st">&quot;Philly&quot;</span>           <span class="st">&quot;Phila&quot;</span>            <span class="st">&quot;Phil.&quot;</span>           
[<span class="dv">7</span>] <span class="st">&quot;Phil Dunphy&quot;</span>     </code></pre>
</div>
<div id="dollar-signs" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Dollar Signs <code>$</code></h3>
<p>While we use carets to signal the beginning of the text, the dollar sign signals the end of the text. For example, to search for all items that end with either an upper-case or lower-case letter, we would do the following:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[A-Za-z]$&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>             <span class="st">&quot;three suspects&quot;</span>      <span class="st">&quot;3 suspects&quot;</span>         
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span> <span class="st">&quot;3718 Locust Walk&quot;</span>   
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet Drive&quot;</span>      <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;Philadelphia, PA&quot;</span>   
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>              <span class="st">&quot;Phila&quot;</span>               <span class="st">&quot;Phil Dunphy&quot;</span>        </code></pre>
<p>Note how all of these have a letter as the last character. We can be more specific and ask for text that end with the letter “y” or end with a 7.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;y$&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
<span class="kw">grep</span>(<span class="st">&quot;7$&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;Philly&quot;</span>      <span class="st">&quot;Phil Dunphy&quot;</span>
[<span class="dv">1</span>] <span class="st">&quot;(215) 573-9097&quot;</span> <span class="st">&quot;215-573-9097&quot;</span>   <span class="st">&quot;2155739097&quot;</span>    </code></pre>
</div>
<div id="plus-sign" class="section level3">
<h3><span class="header-section-number">5.3.4</span> Plus Sign <code>+</code></h3>
<p>The <code>+</code> means at least one of the previous. For example, suppose we wanted to find items in our list that have numbers and those numbers are followed by letters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9]+[A-Za-z]+&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;9mm firearm&quot;</span></code></pre>
<p>Or search for text that starts with some numbers, then has a space, followed by some letters, and then ends.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;^[0-9]+ [A-Za-z]+$&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;3 suspects&quot;</span></code></pre>
</div>
<div id="parentheses" class="section level3">
<h3><span class="header-section-number">5.3.5</span> Parentheses <code>()</code></h3>
<p>Parentheses group together characters as words. For example, suppose we wanted to find the word “suspects”.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;(suspects)&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;three suspects&quot;</span> <span class="st">&quot;3 suspects&quot;</span>    </code></pre>
<p>On its own the parentheses are no different than just running the regular expression “suspects” with no parentheses. However, in combination with <code>|</code> and <code>?</code> it gets more interesting and powerful.</p>
</div>
<div id="vertical-bar" class="section level3">
<h3><span class="header-section-number">5.3.6</span> Vertical Bar <code>|</code></h3>
<p>The vertical bar functions as an “or.” Suppose we wanted to get both the phrases “three suspects” and “3 suspects” from <code>dataText</code>. We would use parentheses as well as a vertical bar.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;(three|3) suspects&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;three suspects&quot;</span> <span class="st">&quot;3 suspects&quot;</span>    </code></pre>
<p>Let’s <code>grep()</code> both DC and LA ZIP codes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;(902|200)[0-9]{2}&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;20015&quot;</span> <span class="st">&quot;90291&quot;</span> <span class="st">&quot;90210&quot;</span></code></pre>
<p>Here’s how we can find words that have exactly four characters. To be exactly four characters, on either side of them there needs to be a space or the beginning or end of the line.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;( |^)[A-Za-z]{4}( |$)&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;3718 Locust Walk&quot;</span> <span class="st">&quot;Phil Dunphy&quot;</span>     </code></pre>
<p>Note that this did not select “Phil.” since it has a period following it. We’ll need a more general regular expression to select that one as well.</p>
<p>Let’s try to find phone numbers in <code>dataText</code>. The problem is that phone numbers have three different formats in our data. The easiest phone number pattern to find is the one with 10 digits in a row.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{10}&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;2155739097&quot;</span></code></pre>
<p>It is also not too hard to find the hypenated phone number pattern.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{3}-[0-9]{3}-[0-9]{4}&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;215-573-9097&quot;</span></code></pre>
<p>The phone number format with parentheses needs a little more caution. We pointed out earlier that parentheses have special meaning in regular expressions. In fact, there are several “special characters” in regular expressions, <code>\ ^ $ {} [] () . * + ? | -</code>. If you actually want to search for the symbol itself you need to “protect” it with a backslash <code>\</code>. However, the <code>\</code> is a special character for R too and R will think that something special is coming next after the <code>\</code>. So to tell R “no really, I really want a backslash here” you have to protect the backslash too. So to look for those phone numbers with parentheses we use a regular expression like this.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">([0-9]{3}</span><span class="ch">\\</span><span class="st">) [0-9]{3}-[0-9]{4}&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;(215) 573-9097&quot;</span></code></pre>
<p>Now, let’s put all of these patterns together use <code>|</code> to search for any phone number in any of the three formats.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;[0-9]{10}|[0-9]{3}-[0-9]{3}-[0-9]{4}|</span><span class="ch">\\</span><span class="st">([0-9]{3}</span><span class="ch">\\</span><span class="st">) [0-9]{3}-[0-9]{4}&quot;</span>,
     dataText, <span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;(215) 573-9097&quot;</span> <span class="st">&quot;215-573-9097&quot;</span>   <span class="st">&quot;2155739097&quot;</span>    </code></pre>
</div>
<div id="question-mark" class="section level3">
<h3><span class="header-section-number">5.3.7</span> Question Mark <code>?</code></h3>
<p>The question mark indicates optional text. To illustrate,</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;Phil(adelphia)&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
<span class="kw">grep</span>(<span class="st">&quot;Phil(adelphia)?&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;Philadelphia, PA&quot;</span>
[<span class="dv">1</span>] <span class="st">&quot;Philadelphia, PA&quot;</span> <span class="st">&quot;Philly&quot;</span>           <span class="st">&quot;Phila&quot;</span>           
[<span class="dv">4</span>] <span class="st">&quot;Phil.&quot;</span>            <span class="st">&quot;Phil Dunphy&quot;</span>     </code></pre>
<p>The first one is no different from searching for the word “Philadelphia,” but the second one says that the “adelphia” part is optional. Note that this regular expression also picked up “Phil Dunphy”. Again we will need a more careful regular expression to avoid matching this name and only select abbreviations and nicknames for Philadelphia.</p>
</div>
<div id="boundaries-b" class="section level3">
<h3><span class="header-section-number">5.3.8</span> Boundaries <code>\b</code></h3>
<p><code>\b</code> will try to find boundaries around words. This includes spaces, punctuation, and the beginning and end of the text. So another way to find all text with four letter words, including “Phil.”, is</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">b[A-Za-z]{4}</span><span class="ch">\\</span><span class="st">b&quot;</span>,dataText,<span class="dt">value =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;3718 Locust Walk&quot;</span> <span class="st">&quot;Phil.&quot;</span>            <span class="st">&quot;Phil Dunphy&quot;</span>     </code></pre>
<p>Remember, the <code>\</code> is a special character for R. To “protect” the backslash we put another backslash in front of it. If we did not include the <code>\b</code> in this regular expression, then we would have also matched words with five or more letters too.</p>
</div>
</div>
<div id="back-referencing" class="section level2">
<h2><span class="header-section-number">5.4</span> Back-Referencing</h2>
<p>A bit more complicated aspect of <code>gsub()</code> is “backreferencing.” Any part of the regular expression in the find pattern that is wrapped in parentheses gets stored in a “register.” You can have multiple pairs of parentheses and, therefore, save different parts of what gets matched in the find pattern. You can then recall what <code>gsub()</code> stored in the registers in the replacement pattern, using <code>\\1</code> for what was stored in the first register, <code>\\2</code> for what was stored in the second register, and so on.</p>
<p>For example, let’s delete the “plus four” part of the ZIP codes in our data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;([0-9]{5})-[0-9]{4}&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>,dataText)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>             <span class="st">&quot;three suspects&quot;</span>      <span class="st">&quot;3 suspects&quot;</span>         
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span> <span class="st">&quot;3718 Locust Walk&quot;</span>   
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet Drive&quot;</span>      <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;Philadelphia, PA&quot;</span>   
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>              <span class="st">&quot;Phila&quot;</span>               <span class="st">&quot;Phil.&quot;</span>              
[<span class="dv">13</span>] <span class="st">&quot;Phil Dunphy&quot;</span>         <span class="st">&quot;19104&quot;</span>               <span class="st">&quot;20015&quot;</span>              
[<span class="dv">16</span>] <span class="st">&quot;90291&quot;</span>               <span class="st">&quot;90210&quot;</span>               <span class="st">&quot;(215) 573-9097&quot;</span>     
[<span class="dv">19</span>] <span class="st">&quot;215-573-9097&quot;</span>        <span class="st">&quot;2155739097&quot;</span>         </code></pre>
<p>We wrapped the parentheses around the first five digits, so only those first five digits get stored in register 1. Then the replacement pattern replaces everything that the find pattern matched (the entirety of the five digits, the hyphen, and the plus four digits) with the contents of register 1, containing just the first five digits.</p>
<p>Let’s use <code>gsub()</code> to just keep the first two “words” in each element of <code>dataText</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;^([^ ]+ [^ ]+) .*$&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>,dataText)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>          <span class="st">&quot;three suspects&quot;</span>   <span class="st">&quot;3 suspects&quot;</span>      
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>      <span class="st">&quot;483 McNeil&quot;</span>       <span class="st">&quot;3718 Locust&quot;</span>     
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet&quot;</span>         <span class="st">&quot;10880 Malibu&quot;</span>     <span class="st">&quot;Philadelphia, PA&quot;</span>
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>           <span class="st">&quot;Phila&quot;</span>            <span class="st">&quot;Phil.&quot;</span>           
[<span class="dv">13</span>] <span class="st">&quot;Phil Dunphy&quot;</span>      <span class="st">&quot;19104-6286&quot;</span>       <span class="st">&quot;20015&quot;</span>           
[<span class="dv">16</span>] <span class="st">&quot;90291&quot;</span>            <span class="st">&quot;90210&quot;</span>            <span class="st">&quot;(215) 573-9097&quot;</span>  
[<span class="dv">19</span>] <span class="st">&quot;215-573-9097&quot;</span>     <span class="st">&quot;2155739097&quot;</span>      </code></pre>
<p>This regular expression says: start at the beginning of the text, find a bunch of characters that are not spaces (remember that the <code>+</code> means one or more of the previous), then find a space, then find another bunch of characters that are not spaces, followed by another space, followed by anything else until the end of the text. The <code>.</code> is like a wild card. It matches any one character. the <code>*</code> is like the <code>+</code> but it means zero or more of the previous character (the <code>+</code> matches or more of the previous character). Note how we have used the parentheses. They are wrapped around those first two words. Those words get stored in register 1 and the replacement pattern just recalls whatever got stored in register 1.</p>
<p>An alternative strategy is to use <code>\w</code>, which means a “word character”, any numbers of letters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;^(</span><span class="ch">\\</span><span class="st">w+ </span><span class="ch">\\</span><span class="st">w+) .*$&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>,dataText)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>          <span class="st">&quot;three suspects&quot;</span>   <span class="st">&quot;3 suspects&quot;</span>      
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>      <span class="st">&quot;483 McNeil&quot;</span>       <span class="st">&quot;3718 Locust&quot;</span>     
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet&quot;</span>         <span class="st">&quot;10880 Malibu&quot;</span>     <span class="st">&quot;Philadelphia, PA&quot;</span>
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>           <span class="st">&quot;Phila&quot;</span>            <span class="st">&quot;Phil.&quot;</span>           
[<span class="dv">13</span>] <span class="st">&quot;Phil Dunphy&quot;</span>      <span class="st">&quot;19104-6286&quot;</span>       <span class="st">&quot;20015&quot;</span>           
[<span class="dv">16</span>] <span class="st">&quot;90291&quot;</span>            <span class="st">&quot;90210&quot;</span>            <span class="st">&quot;(215) 573-9097&quot;</span>  
[<span class="dv">19</span>] <span class="st">&quot;215-573-9097&quot;</span>     <span class="st">&quot;2155739097&quot;</span>      </code></pre>
<p>When working with <code>grep()</code>, we wrote a regular expression to find all the phone numbers in all the various formats. Now let’s use <code>gsub()</code> to standardize all the phone numbers to have the hyphenated format, like 123-456-7890. We use the same regular expression we used when using <code>grep()</code> to find phone numbers, but we insert pairs of parentheses to capture the phone number digits.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;^</span><span class="ch">\\</span><span class="st">(?([0-9]{3})(</span><span class="ch">\\</span><span class="st">) |-)?([0-9]{3})-?([0-9]{4})&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">1-</span><span class="ch">\\</span><span class="st">3-</span><span class="ch">\\</span><span class="st">4&quot;</span>,dataText)
 [<span class="dv">1</span>] <span class="st">&quot;suspect&quot;</span>             <span class="st">&quot;three suspects&quot;</span>      <span class="st">&quot;3 suspects&quot;</span>         
 [<span class="dv">4</span>] <span class="st">&quot;9mm firearm&quot;</span>         <span class="st">&quot;483 McNeil Building&quot;</span> <span class="st">&quot;3718 Locust Walk&quot;</span>   
 [<span class="dv">7</span>] <span class="st">&quot;4 Privet Drive&quot;</span>      <span class="st">&quot;10880 Malibu Point&quot;</span>  <span class="st">&quot;Philadelphia, PA&quot;</span>   
[<span class="dv">10</span>] <span class="st">&quot;Philly&quot;</span>              <span class="st">&quot;Phila&quot;</span>               <span class="st">&quot;Phil.&quot;</span>              
[<span class="dv">13</span>] <span class="st">&quot;Phil Dunphy&quot;</span>         <span class="st">&quot;19104-6286&quot;</span>          <span class="st">&quot;20015&quot;</span>              
[<span class="dv">16</span>] <span class="st">&quot;90291&quot;</span>               <span class="st">&quot;90210&quot;</span>               <span class="st">&quot;215-573-9097&quot;</span>       
[<span class="dv">19</span>] <span class="st">&quot;215-573-9097&quot;</span>        <span class="st">&quot;215-573-9097&quot;</span>       </code></pre>
<p>Note that register 2 captures whatever text matches the optional text <code>(\\) |-)</code>. That’s why you don’t see <code>\\2</code> in the replacement pattern.</p>
</div>
<div id="lookaheads" class="section level2">
<h2><span class="header-section-number">5.5</span> Lookaheads</h2>
<p>Although not as commonly used as a backreference, a “lookahead” can be helpful to find what comes next - or more generally to <code>gsub()</code> items that are a bit more complicated. Here is an illustration of what a lookahead does. Let’s say you wanted to check that every q is followed by a u. If it’s not, then insert the u after the q.</p>
<p>Maybe you would do something like this</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;q[^u]&quot;</span>,<span class="st">&quot;qu&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;quiet&quot;</span>,<span class="st">&quot;quick&quot;</span>,<span class="st">&quot;quagmire&quot;</span>,<span class="st">&quot;qixotic&quot;</span>))
[<span class="dv">1</span>] <span class="st">&quot;quiet&quot;</span>    <span class="st">&quot;quick&quot;</span>    <span class="st">&quot;quagmire&quot;</span> <span class="st">&quot;quxotic&quot;</span> </code></pre>
<p>As you can see, it doesn’t quite do what we wanted. It problematically drops the “i” from “quixotic.” Remember that the replacement pattern will overwrite whatever matches the find pattern. This find pattern will match the “qi,” the q <em>and</em> the adjacent character that is not a u.</p>
<p>A “lookahead” just peeks at the next character to see what it is, but does not consider it part of the match. In parentheses we signal a lookahead with <code>?</code> and then to ask for a character that is not a “u” we use <code>!u</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsub</span>(<span class="st">&quot;q(?!u)&quot;</span>,<span class="st">&quot;qu&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;quiet&quot;</span>,<span class="st">&quot;quick&quot;</span>,<span class="st">&quot;quagmire&quot;</span>,<span class="st">&quot;qixotic&quot;</span>),<span class="dt">perl =</span> <span class="ot">TRUE</span>)
[<span class="dv">1</span>] <span class="st">&quot;quiet&quot;</span>    <span class="st">&quot;quick&quot;</span>    <span class="st">&quot;quagmire&quot;</span> <span class="st">&quot;quixotic&quot;</span></code></pre>
<p>Now we have “quixotic” spelled properly as <code>gsub()</code> looked ahead to check for a “u” but did not consider it part of the match to be replaced. Note that we have set <code>perl = TRUE</code>. There is not a single regular expression standard. Lookaheads (and there are lookbehinds too) are not part of the POSIX 1003.2 standard that R uses by default. However, you can ask R to use perl-style regular expressions that do support lookaheads (and lookbehinds) by simply setting <code>perl = TRUE</code>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dates-and-times.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphing-with-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacobkap/r4crim/edit/master/regular-expressions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
