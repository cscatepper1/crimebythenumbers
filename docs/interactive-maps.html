<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Interactive maps | Crime by the Numbers: A Criminologist’s Guide to R</title>
  <meta name="description" content="A guide to learning R for the purpose of conducting quantitative research. This covers collecting and cleaning data, and visualizing it in graphs and maps." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Interactive maps | Crime by the Numbers: A Criminologist’s Guide to R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A guide to learning R for the purpose of conducting quantitative research. This covers collecting and cleaning data, and visualizing it in graphs and maps." />
  <meta name="github-repo" content="jacobkap/crimebythenumbers" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Interactive maps | Crime by the Numbers: A Criminologist’s Guide to R" />
  
  <meta name="twitter:description" content="A guide to learning R for the purpose of conducting quantitative research. This covers collecting and cleaning data, and visualizing it in graphs and maps." />
  

<meta name="author" content="Jacob Kaplan" />


<meta name="date" content="2023-01-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="choropleth-maps.html"/>
<link rel="next" href="webscraping-with-rvest.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99359926-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99359926-6');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Crime by the Numbers: A Criminologist's Guide to R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-learn-to-program"><i class="fa fa-check"></i>Why learn to program?</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#scale"><i class="fa fa-check"></i>Scale</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-will-learn"><i class="fa fa-check"></i>What you will learn</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i>Skills</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-wont-learn"><i class="fa fa-check"></i>What you won’t learn</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#simple-vs-easy"><i class="fa fa-check"></i>Simple vs easy</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citing-this-book"><i class="fa fa-check"></i>Citing this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute-to-this-book"><i class="fa fa-check"></i>How to contribute to this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#where-to-find-data-included-in-this-book"><i class="fa fa-check"></i>Where to find data included in this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#where-to-find-code-included-in-this-book"><i class="fa fa-check"></i>Where to find code included in this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html"><i class="fa fa-check"></i><b>1</b> A soup to nuts project example</a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#big-picture-data-example"><i class="fa fa-check"></i><b>1.1</b> Big picture data example</a></li>
<li class="chapter" data-level="1.2" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#little-picture-data-example"><i class="fa fa-check"></i><b>1.2</b> Little picture data example</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#loading-packages"><i class="fa fa-check"></i><b>1.2.1</b> Loading packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#loading-data"><i class="fa fa-check"></i><b>1.2.2</b> Loading data</a></li>
<li class="chapter" data-level="1.2.3" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#cleaning"><i class="fa fa-check"></i><b>1.2.3</b> Cleaning</a></li>
<li class="chapter" data-level="1.2.4" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#aggregating"><i class="fa fa-check"></i><b>1.2.4</b> Aggregating</a></li>
<li class="chapter" data-level="1.2.5" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#graphing"><i class="fa fa-check"></i><b>1.2.5</b> Graphing</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="a-soup-to-nuts-project-example.html"><a href="a-soup-to-nuts-project-example.html#reusing-and-modifying-code"><i class="fa fa-check"></i><b>1.3</b> Reusing and modifying code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-to-r.html"><a href="intro-to-r.html#using-rstudio"><i class="fa fa-check"></i><b>2.1</b> Using RStudio</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro-to-r.html"><a href="intro-to-r.html#opening-an-r-script"><i class="fa fa-check"></i><b>2.1.1</b> Opening an R Script</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro-to-r.html"><a href="intro-to-r.html#setting-the-working-directory"><i class="fa fa-check"></i><b>2.1.2</b> Setting the working directory</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro-to-r.html"><a href="intro-to-r.html#changing-rstudio"><i class="fa fa-check"></i><b>2.1.3</b> Changing RStudio</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro-to-r.html"><a href="intro-to-r.html#helpful-cheat-sheets"><i class="fa fa-check"></i><b>2.1.4</b> Helpful cheat sheets</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro-to-r.html"><a href="intro-to-r.html#assignment"><i class="fa fa-check"></i><b>2.2</b> Assigning variables</a></li>
<li class="chapter" data-level="2.3" data-path="intro-to-r.html"><a href="intro-to-r.html#functions-intro"><i class="fa fa-check"></i><b>2.3</b> What are functions (and packages)?</a></li>
<li class="chapter" data-level="2.4" data-path="intro-to-r.html"><a href="intro-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro-to-r.html"><a href="intro-to-r.html#loading-data-intro"><i class="fa fa-check"></i><b>2.4.1</b> Loading data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro-to-r.html"><a href="intro-to-r.html#first-steps-to-exploring-data"><i class="fa fa-check"></i><b>2.5</b> First steps to exploring data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3</b> Data types and structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html#section-data-types"><i class="fa fa-check"></i><b>3.1</b> Data types</a></li>
<li class="chapter" data-level="3.2" data-path="data-types.html"><a href="data-types.html#numeric-character-and-logical-boolean"><i class="fa fa-check"></i><b>3.2</b> Numeric, character, and logical (boolean)</a></li>
<li class="chapter" data-level="3.3" data-path="data-types.html"><a href="data-types.html#data-structures"><i class="fa fa-check"></i><b>3.3</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-types.html"><a href="data-types.html#vectors"><i class="fa fa-check"></i><b>3.3.1</b> Vectors (collections of “things”)</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-types.html"><a href="data-types.html#dataframes"><i class="fa fa-check"></i><b>3.3.2</b> Data.frames</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-types.html"><a href="data-types.html#other-data-structures"><i class="fa fa-check"></i><b>3.3.3</b> Other data structures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>4</b> Reading and writing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-data-into-r-1"><i class="fa fa-check"></i><b>4.1</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r"><i class="fa fa-check"></i><b>4.1.1</b> R</a></li>
<li class="chapter" data-level="4.1.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel"><i class="fa fa-check"></i><b>4.1.2</b> Excel</a></li>
<li class="chapter" data-level="4.1.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata"><i class="fa fa-check"></i><b>4.1.3</b> Stata</a></li>
<li class="chapter" data-level="4.1.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas"><i class="fa fa-check"></i><b>4.1.4</b> SAS</a></li>
<li class="chapter" data-level="4.1.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#spss"><i class="fa fa-check"></i><b>4.1.5</b> SPSS</a></li>
<li class="chapter" data-level="4.1.6" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#fixed-width-ascii"><i class="fa fa-check"></i><b>4.1.6</b> Fixed-width ASCII</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-data"><i class="fa fa-check"></i><b>4.2</b> Writing data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#r-1"><i class="fa fa-check"></i><b>4.2.1</b> R</a></li>
<li class="chapter" data-level="4.2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#excel-1"><i class="fa fa-check"></i><b>4.2.2</b> Excel</a></li>
<li class="chapter" data-level="4.2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#stata-1"><i class="fa fa-check"></i><b>4.2.3</b> Stata</a></li>
<li class="chapter" data-level="4.2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#sas-1"><i class="fa fa-check"></i><b>4.2.4</b> SAS</a></li>
<li class="chapter" data-level="4.2.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#spss-1"><i class="fa fa-check"></i><b>4.2.5</b> SPSS</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Project Management</b></span></li>
<li class="chapter" data-level="5" data-path="mise-en-place.html"><a href="mise-en-place.html"><i class="fa fa-check"></i><b>5</b> <em>Mise en place</em></a>
<ul>
<li class="chapter" data-level="5.1" data-path="mise-en-place.html"><a href="mise-en-place.html#starting-with-a-pencil-and-paper"><i class="fa fa-check"></i><b>5.1</b> Starting with a pencil and paper</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mise-en-place.html"><a href="mise-en-place.html#tables-and-graphs"><i class="fa fa-check"></i><b>5.1.1</b> Tables and graphs</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mise-en-place.html"><a href="mise-en-place.html#r-projects"><i class="fa fa-check"></i><b>5.2</b> R Projects</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mise-en-place.html"><a href="mise-en-place.html#folders"><i class="fa fa-check"></i><b>5.2.1</b> Folders</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mise-en-place.html"><a href="mise-en-place.html#modular-r-scripts"><i class="fa fa-check"></i><b>5.3</b> Modular R scripts</a></li>
<li class="chapter" data-level="5.4" data-path="mise-en-place.html"><a href="mise-en-place.html#modular-code"><i class="fa fa-check"></i><b>5.4</b> Modular code</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="mise-en-place.html"><a href="mise-en-place.html#section-labels"><i class="fa fa-check"></i><b>5.4.1</b> Section labels</a></li>
<li class="chapter" data-level="5.4.2" data-path="mise-en-place.html"><a href="mise-en-place.html#helper-r-scripts"><i class="fa fa-check"></i><b>5.4.2</b> Helper R scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="collaboration.html"><a href="collaboration.html"><i class="fa fa-check"></i><b>6</b> Collaboration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="collaboration.html"><a href="collaboration.html#code-review"><i class="fa fa-check"></i><b>6.1</b> Code review</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="collaboration.html"><a href="collaboration.html#style-guidelines"><i class="fa fa-check"></i><b>6.1.1</b> Style guidelines</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="collaboration.html"><a href="collaboration.html#documentation"><i class="fa fa-check"></i><b>6.2</b> Documentation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="collaboration.html"><a href="collaboration.html#comments"><i class="fa fa-check"></i><b>6.2.1</b> Comments</a></li>
<li class="chapter" data-level="6.2.2" data-path="collaboration.html"><a href="collaboration.html#vignettes"><i class="fa fa-check"></i><b>6.2.2</b> Vignettes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>7</b> R Markdown</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-markdown.html"><a href="r-markdown.html#code-1"><i class="fa fa-check"></i><b>7.1</b> Code</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="r-markdown.html"><a href="r-markdown.html#hiding-code-in-the-output"><i class="fa fa-check"></i><b>7.1.1</b> Hiding code in the output</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="r-markdown.html"><a href="r-markdown.html#inline-code"><i class="fa fa-check"></i><b>7.2</b> Inline Code</a></li>
<li class="chapter" data-level="7.3" data-path="r-markdown.html"><a href="r-markdown.html#tables"><i class="fa fa-check"></i><b>7.3</b> Tables</a></li>
<li class="chapter" data-level="7.4" data-path="r-markdown.html"><a href="r-markdown.html#footnotes"><i class="fa fa-check"></i><b>7.4</b> Footnotes</a></li>
<li class="chapter" data-level="7.5" data-path="r-markdown.html"><a href="r-markdown.html#citation"><i class="fa fa-check"></i><b>7.5</b> Citation</a></li>
<li class="chapter" data-level="7.6" data-path="r-markdown.html"><a href="r-markdown.html#spell-check"><i class="fa fa-check"></i><b>7.6</b> Spell check</a></li>
<li class="chapter" data-level="7.7" data-path="r-markdown.html"><a href="r-markdown.html#making-the-output-file"><i class="fa fa-check"></i><b>7.7</b> Making the output file</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tests.html"><a href="tests.html"><i class="fa fa-check"></i><b>8</b> Testing your code</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tests.html"><a href="tests.html#why-test-your-code"><i class="fa fa-check"></i><b>8.1</b> Why test your code?</a></li>
<li class="chapter" data-level="8.2" data-path="tests.html"><a href="tests.html#unit-tests"><i class="fa fa-check"></i><b>8.2</b> Unit tests</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tests.html"><a href="tests.html#modular-test-scripts"><i class="fa fa-check"></i><b>8.2.1</b> Modular test scripts</a></li>
<li class="chapter" data-level="8.2.2" data-path="tests.html"><a href="tests.html#how-to-write-unit-tests"><i class="fa fa-check"></i><b>8.2.2</b> How to write unit tests</a></li>
<li class="chapter" data-level="8.2.3" data-path="tests.html"><a href="tests.html#what-to-test"><i class="fa fa-check"></i><b>8.2.3</b> What to test</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tests.html"><a href="tests.html#test-driven-development-tdd"><i class="fa fa-check"></i><b>8.3</b> Test-driven development (TDD)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>9</b> Git</a>
<ul>
<li class="chapter" data-level="9.1" data-path="git.html"><a href="git.html#what-is-git-and-why-do-i-need-it"><i class="fa fa-check"></i><b>9.1</b> What is Git, and why do I need it?</a></li>
<li class="chapter" data-level="9.2" data-path="git.html"><a href="git.html#git-basics"><i class="fa fa-check"></i><b>9.2</b> Git basics</a></li>
<li class="chapter" data-level="9.3" data-path="git.html"><a href="git.html#using-git"><i class="fa fa-check"></i><b>9.3</b> Using Git</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="git.html"><a href="git.html#setting-up-git"><i class="fa fa-check"></i><b>9.3.1</b> Setting up Git</a></li>
<li class="chapter" data-level="9.3.2" data-path="git.html"><a href="git.html#setting-up-github"><i class="fa fa-check"></i><b>9.3.2</b> Setting up GitHub</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="git.html"><a href="git.html#setting-up-git-on-an-already-made-r-project"><i class="fa fa-check"></i><b>9.4</b> Setting up Git on an already-made R Project</a></li>
<li class="chapter" data-level="9.5" data-path="git.html"><a href="git.html#using-git-through-rstudio"><i class="fa fa-check"></i><b>9.5</b> Using Git through RStudio</a></li>
<li class="chapter" data-level="9.6" data-path="git.html"><a href="git.html#when-to-commit"><i class="fa fa-check"></i><b>9.6</b> When to commit</a></li>
<li class="chapter" data-level="9.7" data-path="git.html"><a href="git.html#other-resources"><i class="fa fa-check"></i><b>9.7</b> Other resources</a></li>
</ul></li>
<li class="part"><span><b>III Clean</b></span></li>
<li class="chapter" data-level="10" data-path="subsetting-intro.html"><a href="subsetting-intro.html"><i class="fa fa-check"></i><b>10</b> Subsetting: Making big things small</a>
<ul>
<li class="chapter" data-level="10.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-values"><i class="fa fa-check"></i><b>10.1</b> Select specific values</a></li>
<li class="chapter" data-level="10.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#logical-values-and-operations"><i class="fa fa-check"></i><b>10.2</b> Logical values and operations</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#matching-a-single-value"><i class="fa fa-check"></i><b>10.2.1</b> Matching a single value</a></li>
<li class="chapter" data-level="10.2.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#matching-multiple-values"><i class="fa fa-check"></i><b>10.2.2</b> Matching multiple values</a></li>
<li class="chapter" data-level="10.2.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#does-not-match"><i class="fa fa-check"></i><b>10.2.3</b> Does not match</a></li>
<li class="chapter" data-level="10.2.4" data-path="subsetting-intro.html"><a href="subsetting-intro.html#greater-than-or-less-than"><i class="fa fa-check"></i><b>10.2.4</b> Greater than or less than</a></li>
<li class="chapter" data-level="10.2.5" data-path="subsetting-intro.html"><a href="subsetting-intro.html#combining-conditional-statements---or-and"><i class="fa fa-check"></i><b>10.2.5</b> Combining conditional statements - or, and</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#subsetting-a-data.frame"><i class="fa fa-check"></i><b>10.3</b> Subsetting a data.frame</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-columns"><i class="fa fa-check"></i><b>10.3.1</b> Select specific columns</a></li>
<li class="chapter" data-level="10.3.2" data-path="subsetting-intro.html"><a href="subsetting-intro.html#select-specific-rows"><i class="fa fa-check"></i><b>10.3.2</b> Select specific rows</a></li>
<li class="chapter" data-level="10.3.3" data-path="subsetting-intro.html"><a href="subsetting-intro.html#subset-colorado-data"><i class="fa fa-check"></i><b>10.3.3</b> Subset Colorado data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="explore.html"><a href="explore.html"><i class="fa fa-check"></i><b>11</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="explore.html"><a href="explore.html#summary-and-table"><i class="fa fa-check"></i><b>11.1</b> Summary and Table</a></li>
<li class="chapter" data-level="11.2" data-path="explore.html"><a href="explore.html#graphing-1"><i class="fa fa-check"></i><b>11.2</b> Graphing</a></li>
<li class="chapter" data-level="11.3" data-path="explore.html"><a href="explore.html#aggregate"><i class="fa fa-check"></i><b>11.3</b> Aggregating (summaries of groups)</a></li>
<li class="chapter" data-level="11.4" data-path="explore.html"><a href="explore.html#dplyr-pipes"><i class="fa fa-check"></i><b>11.4</b> Pipes in <code>dplyr</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>12</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-patterns-in-text-with-grep"><i class="fa fa-check"></i><b>12.1</b> Finding patterns in text with <code>grep()</code></a></li>
<li class="chapter" data-level="12.2" data-path="regular-expressions.html"><a href="regular-expressions.html#finding-and-replacing-patterns-in-text-with-gsub"><i class="fa fa-check"></i><b>12.2</b> Finding and replacing patterns in text with <code>gsub()</code></a></li>
<li class="chapter" data-level="12.3" data-path="regular-expressions.html"><a href="regular-expressions.html#useful-special-characters"><i class="fa fa-check"></i><b>12.3</b> Useful special characters</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-characters"><i class="fa fa-check"></i><b>12.3.1</b> Multiple characters <code>[]</code></a></li>
<li class="chapter" data-level="12.3.2" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-of-previous-character-n"><i class="fa fa-check"></i><b>12.3.2</b> n-many of previous character <code>{n}</code></a></li>
<li class="chapter" data-level="12.3.3" data-path="regular-expressions.html"><a href="regular-expressions.html#n-many-to-m-many-of-previous-character-nm"><i class="fa fa-check"></i><b>12.3.3</b> n-many to m-many of previous character <code>{n,m}</code></a></li>
<li class="chapter" data-level="12.3.4" data-path="regular-expressions.html"><a href="regular-expressions.html#start-of-string"><i class="fa fa-check"></i><b>12.3.4</b> Start of string</a></li>
<li class="chapter" data-level="12.3.5" data-path="regular-expressions.html"><a href="regular-expressions.html#end-of-string"><i class="fa fa-check"></i><b>12.3.5</b> End of string <code>$</code></a></li>
<li class="chapter" data-level="12.3.6" data-path="regular-expressions.html"><a href="regular-expressions.html#anything-."><i class="fa fa-check"></i><b>12.3.6</b> Anything <code>.</code></a></li>
<li class="chapter" data-level="12.3.7" data-path="regular-expressions.html"><a href="regular-expressions.html#one-or-more-of-previous"><i class="fa fa-check"></i><b>12.3.7</b> One or more of previous <code>+</code></a></li>
<li class="chapter" data-level="12.3.8" data-path="regular-expressions.html"><a href="regular-expressions.html#zero-or-more-of-previous"><i class="fa fa-check"></i><b>12.3.8</b> Zero or more of previous <code>*</code></a></li>
<li class="chapter" data-level="12.3.9" data-path="regular-expressions.html"><a href="regular-expressions.html#multiple-patterns"><i class="fa fa-check"></i><b>12.3.9</b> Multiple patterns <code>|</code></a></li>
<li class="chapter" data-level="12.3.10" data-path="regular-expressions.html"><a href="regular-expressions.html#parentheses"><i class="fa fa-check"></i><b>12.3.10</b> Parentheses <code>()</code></a></li>
<li class="chapter" data-level="12.3.11" data-path="regular-expressions.html"><a href="regular-expressions.html#optional-text"><i class="fa fa-check"></i><b>12.3.11</b> Optional text <code>?</code></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="regular-expressions.html"><a href="regular-expressions.html#changing-capitalization"><i class="fa fa-check"></i><b>12.4</b> Changing capitalization</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>13</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="reshaping.html"><a href="reshaping.html#reshaping-a-single-column"><i class="fa fa-check"></i><b>13.1</b> Reshaping a single column</a></li>
<li class="chapter" data-level="13.2" data-path="reshaping.html"><a href="reshaping.html#reshaping-multiple-columns"><i class="fa fa-check"></i><b>13.2</b> Reshaping multiple columns</a></li>
</ul></li>
<li class="part"><span><b>IV Visualize</b></span></li>
<li class="chapter" data-level="14" data-path="graphing-intro.html"><a href="graphing-intro.html"><i class="fa fa-check"></i><b>14</b> Graphing with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="14.1" data-path="graphing-intro.html"><a href="graphing-intro.html#what-does-the-data-look-like"><i class="fa fa-check"></i><b>14.1</b> What does the data look like?</a></li>
<li class="chapter" data-level="14.2" data-path="graphing-intro.html"><a href="graphing-intro.html#graphing-data"><i class="fa fa-check"></i><b>14.2</b> Graphing data</a></li>
<li class="chapter" data-level="14.3" data-path="graphing-intro.html"><a href="graphing-intro.html#time-series-plots"><i class="fa fa-check"></i><b>14.3</b> Time-series plots</a></li>
<li class="chapter" data-level="14.4" data-path="graphing-intro.html"><a href="graphing-intro.html#scatter-plots"><i class="fa fa-check"></i><b>14.4</b> Scatter plots</a></li>
<li class="chapter" data-level="14.5" data-path="graphing-intro.html"><a href="graphing-intro.html#color-blindness"><i class="fa fa-check"></i><b>14.5</b> Color blindness</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ois-graphs.html"><a href="ois-graphs.html"><i class="fa fa-check"></i><b>15</b> More graphing with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="15.1" data-path="ois-graphs.html"><a href="ois-graphs.html#exploring-data"><i class="fa fa-check"></i><b>15.1</b> Exploring data</a></li>
<li class="chapter" data-level="15.2" data-path="ois-graphs.html"><a href="ois-graphs.html#graphing-a-single-numeric-variable"><i class="fa fa-check"></i><b>15.2</b> Graphing a single numeric variable</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ois-graphs.html"><a href="ois-graphs.html#histogram"><i class="fa fa-check"></i><b>15.2.1</b> Histogram</a></li>
<li class="chapter" data-level="15.2.2" data-path="ois-graphs.html"><a href="ois-graphs.html#density-plot"><i class="fa fa-check"></i><b>15.2.2</b> Density plot</a></li>
<li class="chapter" data-level="15.2.3" data-path="ois-graphs.html"><a href="ois-graphs.html#count-graph"><i class="fa fa-check"></i><b>15.2.3</b> Count graph</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ois-graphs.html"><a href="ois-graphs.html#graphing-a-categorical-variable"><i class="fa fa-check"></i><b>15.3</b> Graphing a categorical variable</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ois-graphs.html"><a href="ois-graphs.html#bar-graph"><i class="fa fa-check"></i><b>15.3.1</b> Bar graph</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="ois-graphs.html"><a href="ois-graphs.html#graphing-data-over-time"><i class="fa fa-check"></i><b>15.4</b> Graphing data over time</a></li>
<li class="chapter" data-level="15.5" data-path="ois-graphs.html"><a href="ois-graphs.html#pretty-graphs"><i class="fa fa-check"></i><b>15.5</b> Pretty graphs</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="ois-graphs.html"><a href="ois-graphs.html#themes"><i class="fa fa-check"></i><b>15.5.1</b> Themes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="hotspot-maps.html"><a href="hotspot-maps.html"><i class="fa fa-check"></i><b>16</b> Hotspot maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#a-simple-map"><i class="fa fa-check"></i><b>16.1</b> A simple map</a></li>
<li class="chapter" data-level="16.2" data-path="hotspot-maps.html"><a href="hotspot-maps.html#what-really-are-maps"><i class="fa fa-check"></i><b>16.2</b> What really are maps?</a></li>
<li class="chapter" data-level="16.3" data-path="hotspot-maps.html"><a href="hotspot-maps.html#making-a-hotspot-map"><i class="fa fa-check"></i><b>16.3</b> Making a hotspot map</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="hotspot-maps.html"><a href="hotspot-maps.html#colors"><i class="fa fa-check"></i><b>16.3.1</b> Colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="choropleth-maps.html"><a href="choropleth-maps.html"><i class="fa fa-check"></i><b>17</b> Choropleth maps</a>
<ul>
<li class="chapter" data-level="17.1" data-path="choropleth-maps.html"><a href="choropleth-maps.html#spatial-joins"><i class="fa fa-check"></i><b>17.1</b> Spatial joins</a></li>
<li class="chapter" data-level="17.2" data-path="choropleth-maps.html"><a href="choropleth-maps.html#making-choropleth-maps"><i class="fa fa-check"></i><b>17.2</b> Making choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>18</b> Interactive maps</a>
<ul>
<li class="chapter" data-level="18.1" data-path="interactive-maps.html"><a href="interactive-maps.html#why-do-interactive-graphs-matter"><i class="fa fa-check"></i><b>18.1</b> Why do interactive graphs matter?</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="interactive-maps.html"><a href="interactive-maps.html#understanding-your-data"><i class="fa fa-check"></i><b>18.1.1</b> Understanding your data</a></li>
<li class="chapter" data-level="18.1.2" data-path="interactive-maps.html"><a href="interactive-maps.html#police-departments-use-them"><i class="fa fa-check"></i><b>18.1.2</b> Police departments use them</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="interactive-maps.html"><a href="interactive-maps.html#making-the-interactive-map"><i class="fa fa-check"></i><b>18.2</b> Making the interactive map</a></li>
<li class="chapter" data-level="18.3" data-path="interactive-maps.html"><a href="interactive-maps.html#adding-popup-information"><i class="fa fa-check"></i><b>18.3</b> Adding popup information</a></li>
<li class="chapter" data-level="18.4" data-path="interactive-maps.html"><a href="interactive-maps.html#dealing-with-too-many-markers"><i class="fa fa-check"></i><b>18.4</b> Dealing with too many markers</a></li>
<li class="chapter" data-level="18.5" data-path="interactive-maps.html"><a href="interactive-maps.html#interactive-choropleth-maps"><i class="fa fa-check"></i><b>18.5</b> Interactive choropleth maps</a></li>
</ul></li>
<li class="part"><span><b>V Collect</b></span></li>
<li class="chapter" data-level="19" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html"><i class="fa fa-check"></i><b>19</b> Webscraping with <code>rvest</code></a>
<ul>
<li class="chapter" data-level="19.1" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#scraping-one-page"><i class="fa fa-check"></i><b>19.1</b> Scraping one page</a></li>
<li class="chapter" data-level="19.2" data-path="webscraping-with-rvest.html"><a href="webscraping-with-rvest.html#cleaning-the-webscraped-data"><i class="fa fa-check"></i><b>19.2</b> Cleaning the webscraped data</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>20</b> Functions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="functions.html"><a href="functions.html#a-simple-function"><i class="fa fa-check"></i><b>20.1</b> A simple function</a></li>
<li class="chapter" data-level="20.2" data-path="functions.html"><a href="functions.html#adding-parameters"><i class="fa fa-check"></i><b>20.2</b> Adding parameters</a></li>
<li class="chapter" data-level="20.3" data-path="functions.html"><a href="functions.html#recipes-function"><i class="fa fa-check"></i><b>20.3</b> Making a function to scrape recipes</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>21</b> For loops</a>
<ul>
<li class="chapter" data-level="21.1" data-path="for-loops.html"><a href="for-loops.html#basic-for-loops"><i class="fa fa-check"></i><b>21.1</b> Basic for loops</a></li>
<li class="chapter" data-level="21.2" data-path="for-loops.html"><a href="for-loops.html#scraping-multiple-recipes"><i class="fa fa-check"></i><b>21.2</b> Scraping multiple recipes</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="scrape-table.html"><a href="scrape-table.html"><i class="fa fa-check"></i><b>22</b> Scraping tables from PDFs</a>
<ul>
<li class="chapter" data-level="22.1" data-path="scrape-table.html"><a href="scrape-table.html#scraping-the-first-table"><i class="fa fa-check"></i><b>22.1</b> Scraping the first table</a></li>
<li class="chapter" data-level="22.2" data-path="scrape-table.html"><a href="scrape-table.html#making-a-function"><i class="fa fa-check"></i><b>22.2</b> Making a function</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="scrape-table2.html"><a href="scrape-table2.html"><i class="fa fa-check"></i><b>23</b> More scraping tables from PDFs</a>
<ul>
<li class="chapter" data-level="23.1" data-path="scrape-table2.html"><a href="scrape-table2.html#texas-jail-data"><i class="fa fa-check"></i><b>23.1</b> Texas jail data</a></li>
<li class="chapter" data-level="23.2" data-path="scrape-table2.html"><a href="scrape-table2.html#pregnant-women-incarcerated"><i class="fa fa-check"></i><b>23.2</b> Pregnant women incarcerated</a></li>
<li class="chapter" data-level="23.3" data-path="scrape-table2.html"><a href="scrape-table2.html#making-pdf-scraped-data-available-to-others"><i class="fa fa-check"></i><b>23.3</b> Making PDF-scraped data available to others</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="geocoding.html"><a href="geocoding.html"><i class="fa fa-check"></i><b>24</b> Geocoding</a>
<ul>
<li class="chapter" data-level="24.1" data-path="geocoding.html"><a href="geocoding.html#geocoding-a-single-address"><i class="fa fa-check"></i><b>24.1</b> Geocoding a single address</a></li>
<li class="chapter" data-level="24.2" data-path="geocoding.html"><a href="geocoding.html#geocoding-san-francisco-marijuana-dispensary-locations"><i class="fa fa-check"></i><b>24.2</b> Geocoding San Francisco marijuana dispensary locations</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Crime by the Numbers: A Criminologist’s Guide to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactive-maps" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">18</span> Interactive maps<a href="interactive-maps.html#interactive-maps" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For this chapter you’ll need the following files, which are available for download <a href="https://github.com/jacobkap/crimebythenumbers/tree/master/data">here</a>: san_francisco_marijuana_geocoded.csv and sf_neighborhoods_suicide.rda.</p>
<p>While maps of data are useful, their ability to show incident-level information is quite limited. They tend to show broad trends - where crime happened in a city - rather than provide information about specific crime incidents. While broad trends are important, there are significant drawbacks about being unable to get important information about an incident without having to check the data. An interactive map bridges this gap by showing trends while allowing you to zoom into individual incidents and see information about each incident.</p>
<p>For this lesson we will be using data on every marijuana dispensary in San Francisco that has an active dispensary license as of late September 2019. The file is called “san_francisco_marijuana_geocoded.csv”.</p>
<p>When downloaded from California’s Bureau of Cannabis Control (<a href="https://aca5.accela.com/bcc/customization/bcc/cap/licenseSearch.aspx">here</a> if you’re interested) the data contains the address of each dispensary but does not have coordinates. Without coordinates we are unable to map points, meaning we need to geocode them. Geocoding is the process of taking an address and getting the longitude and latitude of that address for mapping. For this lesson I’ve already geocoded the data, and we’ll learn how to do so in Chapter <a href="geocoding.html#geocoding">24</a>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="interactive-maps.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb342-2"><a href="interactive-maps.html#cb342-2" aria-hidden="true" tabindex="-1"></a>marijuana <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/san_francisco_marijuana_geocoded.csv&quot;</span>)</span>
<span id="cb342-3"><a href="interactive-maps.html#cb342-3" aria-hidden="true" tabindex="-1"></a>marijuana <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(marijuana)</span></code></pre></div>
<div id="why-do-interactive-graphs-matter" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Why do interactive graphs matter?<a href="interactive-maps.html#why-do-interactive-graphs-matter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="understanding-your-data" class="section level3 hasAnchor" number="18.1.1">
<h3><span class="header-section-number">18.1.1</span> Understanding your data<a href="interactive-maps.html#understanding-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The most important thing to learn from this book is that understanding your data is crucial to good research. Making interactive maps is a very useful way to better understand your data as you can immediately see geographic patterns and quickly look at characteristics of those incidents to understand them.</p>
<p>In this lesson we will make a map of each marijuana dispensary in San Francisco that lets you click on the dispensary and see some information about it. If we see a cluster of dispensaries, we can click on each one to see if they are similar - for example, if owned by the same person. Though it is possible to find these patterns just looking at the data, it is easier to be able to see a geographic pattern and immediately look at information about each incident.</p>
</div>
<div id="police-departments-use-them" class="section level3 hasAnchor" number="18.1.2">
<h3><span class="header-section-number">18.1.2</span> Police departments use them<a href="interactive-maps.html#police-departments-use-them" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Interactive maps are popular in large police departments, such as Philadelphia and New York City. They allow easy understanding of geographic patterns in the data and, importantly, allow such access to people who do not have the technical skills necessary to interact with the data itself. If nothing else, learning interactive maps may help you with a future job.</p>
</div>
</div>
<div id="making-the-interactive-map" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Making the interactive map<a href="interactive-maps.html#making-the-interactive-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, let’s take a look at the top 6 rows of the data.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="interactive-maps.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(marijuana)</span>
<span id="cb343-2"><a href="interactive-maps.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    License_Number                License_Type   Business_Owner</span></span>
<span id="cb343-3"><a href="interactive-maps.html#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 C10-0000614-LIC Cannabis - Retailer License     Terry Muller</span></span>
<span id="cb343-4"><a href="interactive-maps.html#cb343-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 C10-0000586-LIC Cannabis - Retailer License    Jeremy Goodin</span></span>
<span id="cb343-5"><a href="interactive-maps.html#cb343-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 C10-0000587-LIC Cannabis - Retailer License     Justin Jarin</span></span>
<span id="cb343-6"><a href="interactive-maps.html#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 C10-0000539-LIC Cannabis - Retailer License Ondyn Herschelle</span></span>
<span id="cb343-7"><a href="interactive-maps.html#cb343-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 C10-0000522-LIC Cannabis - Retailer License      Ryan Hudson</span></span>
<span id="cb343-8"><a href="interactive-maps.html#cb343-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 C10-0000523-LIC Cannabis - Retailer License      Ryan Hudson</span></span>
<span id="cb343-9"><a href="interactive-maps.html#cb343-9" aria-hidden="true" tabindex="-1"></a><span class="co">#          Business_Structure                         Premise_Address Status</span></span>
<span id="cb343-10"><a href="interactive-maps.html#cb343-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 Limited Liability Company  2165 IRVING ST san francisco, CA 94122 Active</span></span>
<span id="cb343-11"><a href="interactive-maps.html#cb343-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2               Corporation 122 10TH ST SAN FRANCISCO, CA 941032605 Active</span></span>
<span id="cb343-12"><a href="interactive-maps.html#cb343-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3               Corporation   843 Howard ST SAN FRANCISCO, CA 94103 Active</span></span>
<span id="cb343-13"><a href="interactive-maps.html#cb343-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4               Corporation    70 SECOND ST SAN FRANCISCO, CA 94105 Active</span></span>
<span id="cb343-14"><a href="interactive-maps.html#cb343-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 Limited Liability Company   527 Howard ST San Francisco, CA 94105 Active</span></span>
<span id="cb343-15"><a href="interactive-maps.html#cb343-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 Limited Liability Company 2414 Lombard ST San Francisco, CA 94123 Active</span></span>
<span id="cb343-16"><a href="interactive-maps.html#cb343-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   Issue_Date Expiration_Date                Activities Adult-Use/Medicinal</span></span>
<span id="cb343-17"><a href="interactive-maps.html#cb343-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 1  9/13/2019       9/12/2020 N/A for this license type                BOTH</span></span>
<span id="cb343-18"><a href="interactive-maps.html#cb343-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2  8/26/2019       8/25/2020 N/A for this license type                BOTH</span></span>
<span id="cb343-19"><a href="interactive-maps.html#cb343-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3  8/26/2019       8/25/2020 N/A for this license type                BOTH</span></span>
<span id="cb343-20"><a href="interactive-maps.html#cb343-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 4   8/5/2019        8/4/2020 N/A for this license type                BOTH</span></span>
<span id="cb343-21"><a href="interactive-maps.html#cb343-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 5  7/29/2019       7/28/2020 N/A for this license type                BOTH</span></span>
<span id="cb343-22"><a href="interactive-maps.html#cb343-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 6  7/29/2019       7/28/2020 N/A for this license type                BOTH</span></span>
<span id="cb343-23"><a href="interactive-maps.html#cb343-23" aria-hidden="true" tabindex="-1"></a><span class="co">#        lat      long</span></span>
<span id="cb343-24"><a href="interactive-maps.html#cb343-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 37.76318 -122.4811</span></span>
<span id="cb343-25"><a href="interactive-maps.html#cb343-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 37.77480 -122.4157</span></span>
<span id="cb343-26"><a href="interactive-maps.html#cb343-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 37.78228 -122.4035</span></span>
<span id="cb343-27"><a href="interactive-maps.html#cb343-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 37.78823 -122.4004</span></span>
<span id="cb343-28"><a href="interactive-maps.html#cb343-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 37.78783 -122.3965</span></span>
<span id="cb343-29"><a href="interactive-maps.html#cb343-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 37.79944 -122.4414</span></span></code></pre></div>
<p>This data has information about the type of license, who the owner is, and where the dispensary is (as an address and as coordinates). We’ll be making a map showing every dispensary in the city and make it so when you click a dot it’ll make a popup showing information about that dispensary.</p>
<p>We will use the package <code>leaflet</code> for our interactive map. <code>leaflet</code> produces maps similar to Google Maps with circles (or any icon we choose) for each value we add to the map. It allows you to zoom in, scroll around, and provides context to each incident that isn’t available on a static map.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="interactive-maps.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;leaflet&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="interactive-maps.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span></code></pre></div>
<p>To make a <code>leaflet</code> map we need to run the function <code>leaflet()</code> and add a tile to the map. We can just use the default tile which doesn’t need an input. If you’re interested in other tiles, please see this <a href="https://leaflet-extras.github.io/leaflet-providers/preview/">website</a>.</p>
<p>We will use a standard tile from Open Street Maps. This tile gives street names and highlights important features such as parks and large stores which provides useful contexts for looking at the data.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="interactive-maps.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb346-2"><a href="interactive-maps.html#cb346-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>()</span></code></pre></div>
<p><img src="images/leaflet_map1.png" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>When you run the above code it shows a world map (copied several times). Zoom into it, and it’ll start showing relevant features of wherever you’re looking.</p>
<p>Note the <code>%&gt;%</code> between the <code>leaflet()</code> function and the <code>addTiles()</code> function. <code>leaflet</code> is one of the packages in R where we can use pipes.</p>
<p>To add the points to the graph we use the function <code>addMarkers()</code>, which has two parameters, <code>lng</code> and <code>lat</code>. For both parameters we put the column in which the longitude and latitude are, respectively.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="interactive-maps.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb347-2"><a href="interactive-maps.html#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb347-3"><a href="interactive-maps.html#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb347-4"><a href="interactive-maps.html#cb347-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">lat =</span> marijuana<span class="sc">$</span>lat)</span></code></pre></div>
<p><img src="images/leaflet_map2.png" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>It now adds an icon indicating where every dispensary in our data is. You can zoom in and scroll around to see more about where the dispensaries are. There are only a few dozen locations in the data so the popups overlapping a bit doesn’t affect our map too much. If we had more - such as crime data with millions of offenses - it would make it very hard to read. To change the icons to circles we can change the function <code>addMarkers()</code> to <code>addCircleMarkers()</code>, keeping the rest of the code the same.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="interactive-maps.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb348-2"><a href="interactive-maps.html#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb348-3"><a href="interactive-maps.html#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb348-4"><a href="interactive-maps.html#cb348-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat)</span></code></pre></div>
<p><img src="images/leaflet_map3.png" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>This makes the icon into circles, which take up less space than icons. To adjust the size of our icons we use the <code>radius</code> parameter in <code>addMarkers()</code> or <code>addCircleMarkers()</code>. The larger the radius, the larger the icons.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="interactive-maps.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb349-2"><a href="interactive-maps.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb349-3"><a href="interactive-maps.html#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb349-4"><a href="interactive-maps.html#cb349-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat,</span>
<span id="cb349-5"><a href="interactive-maps.html#cb349-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="images/leaflet_map4.png" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>Setting the <code>radius</code> option to 5 shrinks the size of the icon a lot. In your own maps you’ll have to fiddle with this option to get it to look the way you want. Let’s move on to adding information about each icon when clicked upon.</p>
</div>
<div id="adding-popup-information" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Adding popup information<a href="interactive-maps.html#adding-popup-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The parameter <code>popup</code> in the <code>addMarkers()</code> or <code>addCircleMarkers()</code> functions lets you input a character value (if not already a character value it will convert it to one) and that will be shown as a popup when you click on the icon. Let’s start simple here by inputting the business owner column in our data and then build it up to a more complicated popup.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="interactive-maps.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb350-2"><a href="interactive-maps.html#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb350-3"><a href="interactive-maps.html#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb350-4"><a href="interactive-maps.html#cb350-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat,</span>
<span id="cb350-5"><a href="interactive-maps.html#cb350-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb350-6"><a href="interactive-maps.html#cb350-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> marijuana<span class="sc">$</span>Business_Owner)</span></code></pre></div>
<p><img src="images/interactive_popup1.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>Try clicking around and you’ll see that the owner of the dispensary you clicked on appears over the dot. If you’re reading the print version of this book you won’t, of course, be able to click on the map. We usually want to have a title indicating what the value in the popup means. We can do this by using the <code>paste()</code> function to combine text explaining the value with the value itself. Let’s add the words “Business Owner:” before the business owner column.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="interactive-maps.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb351-2"><a href="interactive-maps.html#cb351-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb351-3"><a href="interactive-maps.html#cb351-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb351-4"><a href="interactive-maps.html#cb351-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat,</span>
<span id="cb351-5"><a href="interactive-maps.html#cb351-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb351-6"><a href="interactive-maps.html#cb351-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="fu">paste</span>(<span class="st">&quot;Business Owner:&quot;</span>,</span>
<span id="cb351-7"><a href="interactive-maps.html#cb351-7" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Business_Owner))</span></code></pre></div>
<p><img src="images/interactive_popup2.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>We don’t have too much information in the data, but let’s add the address and license number to the popup by adding them to the <code>paste()</code> function we’re using.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="interactive-maps.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb352-2"><a href="interactive-maps.html#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb352-3"><a href="interactive-maps.html#cb352-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb352-4"><a href="interactive-maps.html#cb352-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat,</span>
<span id="cb352-5"><a href="interactive-maps.html#cb352-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb352-6"><a href="interactive-maps.html#cb352-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="fu">paste</span>(<span class="st">&quot;Business Owner:&quot;</span>,</span>
<span id="cb352-7"><a href="interactive-maps.html#cb352-7" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Business_Owner,</span>
<span id="cb352-8"><a href="interactive-maps.html#cb352-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Address:&quot;</span>,</span>
<span id="cb352-9"><a href="interactive-maps.html#cb352-9" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Premise_Address,</span>
<span id="cb352-10"><a href="interactive-maps.html#cb352-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;License:&quot;</span>, </span>
<span id="cb352-11"><a href="interactive-maps.html#cb352-11" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>License_Number))</span></code></pre></div>
<p><img src="images/interactive_popup3.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>Just adding the location text makes it try to print out everything on one line, which is hard to read. If we add the text <code>&lt;br&gt;</code> where we want a line break, it will make one. <code>&lt;br&gt;</code> is the HTML tag for line-break, which is why it works making a new line in this case.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="interactive-maps.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb353-2"><a href="interactive-maps.html#cb353-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb353-3"><a href="interactive-maps.html#cb353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb353-4"><a href="interactive-maps.html#cb353-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat,</span>
<span id="cb353-5"><a href="interactive-maps.html#cb353-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb353-6"><a href="interactive-maps.html#cb353-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="fu">paste</span>(<span class="st">&quot;Business Owner:&quot;</span>,</span>
<span id="cb353-7"><a href="interactive-maps.html#cb353-7" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Business_Owner,</span>
<span id="cb353-8"><a href="interactive-maps.html#cb353-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb353-9"><a href="interactive-maps.html#cb353-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Address:&quot;</span>, </span>
<span id="cb353-10"><a href="interactive-maps.html#cb353-10" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Premise_Address,</span>
<span id="cb353-11"><a href="interactive-maps.html#cb353-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb353-12"><a href="interactive-maps.html#cb353-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;License:&quot;</span>,</span>
<span id="cb353-13"><a href="interactive-maps.html#cb353-13" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>License_Number))</span></code></pre></div>
<p><img src="images/interactive_popup4.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
</div>
<div id="dealing-with-too-many-markers" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Dealing with too many markers<a href="interactive-maps.html#dealing-with-too-many-markers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our case with only 33 rows of data, turning the markers to circles solves our visibility issue. In cases with many more rows of data, this doesn’t always work. A solution for this is to cluster the data into groups where the dots only show if you zoom in.</p>
<p>If we add the code <code>clusterOptions = markerClusterOptions()</code> to our <code>addCircleMarkers()</code> it will cluster for us.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="interactive-maps.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb354-2"><a href="interactive-maps.html#cb354-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb354-3"><a href="interactive-maps.html#cb354-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> marijuana<span class="sc">$</span>long, </span>
<span id="cb354-4"><a href="interactive-maps.html#cb354-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> marijuana<span class="sc">$</span>lat,</span>
<span id="cb354-5"><a href="interactive-maps.html#cb354-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb354-6"><a href="interactive-maps.html#cb354-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="fu">paste</span>(<span class="st">&quot;Business Owner:&quot;</span>, </span>
<span id="cb354-7"><a href="interactive-maps.html#cb354-7" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Business_Owner,</span>
<span id="cb354-8"><a href="interactive-maps.html#cb354-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb354-9"><a href="interactive-maps.html#cb354-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Address:&quot;</span>,</span>
<span id="cb354-10"><a href="interactive-maps.html#cb354-10" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>Premise_Address,</span>
<span id="cb354-11"><a href="interactive-maps.html#cb354-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb354-12"><a href="interactive-maps.html#cb354-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;License:&quot;</span>,</span>
<span id="cb354-13"><a href="interactive-maps.html#cb354-13" aria-hidden="true" tabindex="-1"></a>                                 marijuana<span class="sc">$</span>License_Number),</span>
<span id="cb354-14"><a href="interactive-maps.html#cb354-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">clusterOptions =</span> <span class="fu">markerClusterOptions</span>())</span></code></pre></div>
<p><img src="images/leaflet_map_temp.png" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>Locations close to each other are grouped together in fairly arbitrary groupings, and we can see how large each grouping is by moving our cursor over the circle. Click on a circle or zoom in and it will show smaller groupings at lower levels of aggregation. Keep clicking or zooming in, and it will eventually show each location as its own circle.</p>
<p>This method is very useful for dealing with huge amounts of data as it avoids overflowing the map with too many icons at one time. A downside, however, is that the clusters are created arbitrarily meaning that important context, such as neighborhood, can be lost.</p>
</div>
<div id="interactive-choropleth-maps" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> Interactive choropleth maps<a href="interactive-maps.html#interactive-choropleth-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter <a href="choropleth-maps.html#choropleth-maps">17</a> we worked on choropleth maps which are maps with shaded regions, such as states colored by which political party won them in an election. Here we will make interactive choropleth maps where you can click on a shaded region and see information about that region. We’ll make the same map as before - neighborhoods shaded by the number of suicides.</p>
<p>Let’s load the San Francisco suicides-by-neighborhood data that we made earlier. We’ll also want to project it to the standard longitude and latitude projection, otherwise our map won’t work right.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="interactive-maps.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb355-2"><a href="interactive-maps.html#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning: package &#39;sf&#39; was built under R version 4.2.2</span></span>
<span id="cb355-3"><a href="interactive-maps.html#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Linking to GEOS 3.9.3, GDAL 3.5.2, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span id="cb355-4"><a href="interactive-maps.html#cb355-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/sf_neighborhoods_suicide.rda&quot;</span>) </span>
<span id="cb355-5"><a href="interactive-maps.html#cb355-5" aria-hidden="true" tabindex="-1"></a>sf_neighborhoods_suicide <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(sf_neighborhoods_suicide, </span>
<span id="cb355-6"><a href="interactive-maps.html#cb355-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span></code></pre></div>
<p>We’ll begin the <code>leaflet</code> map similar to before but use the function <code>addPolygons()</code>, and our input here is the geometry column of <em>sf_neighborhoods_suicide</em>.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="interactive-maps.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb356-2"><a href="interactive-maps.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb356-3"><a href="interactive-maps.html#cb356-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry)</span></code></pre></div>
<p><img src="images/leaflet_choropleth1.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>It made a map with thick blue lines indicating each neighborhood. Let’s change the appearance of the graph a bit before making a popup or shading the neighborhoods The parameter <code>color</code> in <code>addPolygons()</code> changes the color of the lines - let’s change it to black. The lines are also very thick, blurring into each other and making the neighborhoods hard to see. We can change the <code>weight</code> parameter to alter the size of these lines - smaller values are thinner lines. Let’s try setting this to 1.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="interactive-maps.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb357-2"><a href="interactive-maps.html#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb357-3"><a href="interactive-maps.html#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry,</span>
<span id="cb357-4"><a href="interactive-maps.html#cb357-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb357-5"><a href="interactive-maps.html#cb357-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">weight =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="images/leaflet_choropleth2.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>That looks better and we can clearly distinguish each neighborhood now.</p>
<p>As we did earlier, we can add the popup text directly to the function which makes the geographic shapes, in this case <code>addPolygons()</code>. Let’s add the <em>nhood</em> column value - the name of that neighborhood - and the number of suicides that occurred in that neighborhood. As before, when we click on a neighborhood a popup appears with the output we specified.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="interactive-maps.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb358-2"><a href="interactive-maps.html#cb358-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb358-3"><a href="interactive-maps.html#cb358-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry,</span>
<span id="cb358-4"><a href="interactive-maps.html#cb358-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb358-5"><a href="interactive-maps.html#cb358-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb358-6"><a href="interactive-maps.html#cb358-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup =</span> <span class="fu">paste0</span>(<span class="st">&quot;Neighborhood: &quot;</span>, </span>
<span id="cb358-7"><a href="interactive-maps.html#cb358-7" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>nhood,</span>
<span id="cb358-8"><a href="interactive-maps.html#cb358-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb358-9"><a href="interactive-maps.html#cb358-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Number of Suicides: &quot;</span>,</span>
<span id="cb358-10"><a href="interactive-maps.html#cb358-10" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>number_suicides))</span></code></pre></div>
<p><img src="images/leaflet_choropleth3.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>For these types of maps we generally want to shade each polygon to indicate how frequently the event occurred in the polygon. We’ll use the function <code>colorNumeric()</code>, which takes a lot of the work out of the process of coloring in the map. This function takes two inputs, first a color palette, which we can get from the site <a href="http://colorbrewer2.org/#type=sequential&amp;scheme=OrRd&amp;n=3">Color Brewer.</a> Let’s use the fourth bar in the Sequential page, which is light orange to red. If you look in the section with each HEX value it says that the palette is “3-class OrRd.” The “3-class” just means we selected 3 colors, the “OrRd” is the part we want. That will tell <code>colorNumeric()</code> to make the palette using these colors. The second parameter is the column for our numeric variable, <em>number_suicides</em>.
We will save the output of <code>colorNumeric("OrRd", sf_neighborhoods_suicide$number_suicides)</code> as a new object, which we’ll call <em>pal</em> for convenience since it is a palette of colors. Then inside of <code>addPolygons()</code> we’ll set the parameter <code>fillColor</code> to <code>pal(sf_neighborhoods_suicide$number_suicides)</code>, running this function on the column. What this really does is determine which color every neighborhood should be based on the value in the <em>number_suicides</em> column.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="interactive-maps.html#cb359-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="st">&quot;OrRd&quot;</span>, sf_neighborhoods_suicide<span class="sc">$</span>number_suicides)</span>
<span id="cb359-2"><a href="interactive-maps.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb359-3"><a href="interactive-maps.html#cb359-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb359-4"><a href="interactive-maps.html#cb359-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry,</span>
<span id="cb359-5"><a href="interactive-maps.html#cb359-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb359-6"><a href="interactive-maps.html#cb359-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb359-7"><a href="interactive-maps.html#cb359-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup =</span> <span class="fu">paste0</span>(<span class="st">&quot;Neighborhood: &quot;</span>,</span>
<span id="cb359-8"><a href="interactive-maps.html#cb359-8" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>nhood,</span>
<span id="cb359-9"><a href="interactive-maps.html#cb359-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb359-10"><a href="interactive-maps.html#cb359-10" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Number of Suicides: &quot;</span>,</span>
<span id="cb359-11"><a href="interactive-maps.html#cb359-11" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb359-12"><a href="interactive-maps.html#cb359-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillColor =</span> <span class="fu">pal</span>(sf_neighborhoods_suicide<span class="sc">$</span>number_suicides))</span></code></pre></div>
<p><img src="images/leaflet_choropleth4.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>Since the neighborhoods are transparent, it is hard to distinguish which color is shown. We can make each neighborhood a solid color by setting the parameter <code>fillOpacity</code> inside of <code>addPolygons()</code> to 1.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="interactive-maps.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb360-2"><a href="interactive-maps.html#cb360-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb360-3"><a href="interactive-maps.html#cb360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry,</span>
<span id="cb360-4"><a href="interactive-maps.html#cb360-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb360-5"><a href="interactive-maps.html#cb360-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb360-6"><a href="interactive-maps.html#cb360-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup =</span> <span class="fu">paste0</span>(<span class="st">&quot;Neighborhood: &quot;</span>,</span>
<span id="cb360-7"><a href="interactive-maps.html#cb360-7" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>nhood,</span>
<span id="cb360-8"><a href="interactive-maps.html#cb360-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb360-9"><a href="interactive-maps.html#cb360-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Number of Suicides: &quot;</span>,</span>
<span id="cb360-10"><a href="interactive-maps.html#cb360-10" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb360-11"><a href="interactive-maps.html#cb360-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillColor =</span> <span class="fu">pal</span>(sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb360-12"><a href="interactive-maps.html#cb360-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillOpacity =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="images/leaflet_choropleth5.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>To add a legend to this we use the function <code>addLegend()</code>, which takes three parameters. <code>pal</code> asks which color palette we are using - we want it to be the exact same as we use to color the neighborhoods, so we’ll use the <em>pal</em> object we made. The <code>values</code> parameter is used for which column our numeric values are from, in our case the <em>number_suicides</em> column so we’ll input that. Finally <code>opacity</code> determines how transparent the legend will be. As each neighborhood is set to not be transparent at all, we’ll also set this to 1 to be consistent.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="interactive-maps.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb361-2"><a href="interactive-maps.html#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb361-3"><a href="interactive-maps.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry,</span>
<span id="cb361-4"><a href="interactive-maps.html#cb361-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb361-5"><a href="interactive-maps.html#cb361-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb361-6"><a href="interactive-maps.html#cb361-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup =</span> <span class="fu">paste0</span>(<span class="st">&quot;Neighborhood: &quot;</span>, </span>
<span id="cb361-7"><a href="interactive-maps.html#cb361-7" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>nhood,</span>
<span id="cb361-8"><a href="interactive-maps.html#cb361-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb361-9"><a href="interactive-maps.html#cb361-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Number of Suicides: &quot;</span>,</span>
<span id="cb361-10"><a href="interactive-maps.html#cb361-10" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb361-11"><a href="interactive-maps.html#cb361-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillColor =</span> <span class="fu">pal</span>(sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb361-12"><a href="interactive-maps.html#cb361-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillOpacity =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb361-13"><a href="interactive-maps.html#cb361-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">pal =</span> pal, </span>
<span id="cb361-14"><a href="interactive-maps.html#cb361-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> sf_neighborhoods_suicide<span class="sc">$</span>number_suicides,</span>
<span id="cb361-15"><a href="interactive-maps.html#cb361-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">opacity =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="images/leaflet_choropleth6.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>
<p>Finally, we can add a title to the legend using the <code>title</code> parameter inside of <code>addLegend()</code>.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="interactive-maps.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb362-2"><a href="interactive-maps.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb362-3"><a href="interactive-maps.html#cb362-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> sf_neighborhoods_suicide<span class="sc">$</span>geometry,</span>
<span id="cb362-4"><a href="interactive-maps.html#cb362-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb362-5"><a href="interactive-maps.html#cb362-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb362-6"><a href="interactive-maps.html#cb362-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup =</span> <span class="fu">paste0</span>(<span class="st">&quot;Neighborhood: &quot;</span>,</span>
<span id="cb362-7"><a href="interactive-maps.html#cb362-7" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>nhood,</span>
<span id="cb362-8"><a href="interactive-maps.html#cb362-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;&lt;br&gt;&quot;</span>,</span>
<span id="cb362-9"><a href="interactive-maps.html#cb362-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;Number of Suicides: &quot;</span>,</span>
<span id="cb362-10"><a href="interactive-maps.html#cb362-10" aria-hidden="true" tabindex="-1"></a>                             sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb362-11"><a href="interactive-maps.html#cb362-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillColor =</span> <span class="fu">pal</span>(sf_neighborhoods_suicide<span class="sc">$</span>number_suicides),</span>
<span id="cb362-12"><a href="interactive-maps.html#cb362-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillOpacity =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb362-13"><a href="interactive-maps.html#cb362-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">pal =</span> pal, </span>
<span id="cb362-14"><a href="interactive-maps.html#cb362-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> sf_neighborhoods_suicide<span class="sc">$</span>number_suicides,</span>
<span id="cb362-15"><a href="interactive-maps.html#cb362-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">opacity =</span> <span class="dv">1</span>,</span>
<span id="cb362-16"><a href="interactive-maps.html#cb362-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Suicides&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb362-17"><a href="interactive-maps.html#cb362-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron)  </span></code></pre></div>
<p><img src="images/leaflet_choropleth7.PNG" width="100%" height="45%"  style="display: block; margin: auto;" /></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="choropleth-maps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="webscraping-with-rvest.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacobkap/crimebythenumbers/edit/master/interactive-maps.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
