<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="9 Choropleth maps | Crime by the Numbers" />
<meta property="og:type" content="book" />
<meta property="og:url" content="https://crimebythenumbers.com" />
<meta property="og:image" content="https://crimebythenumbers.comimages/cover.png" />
<meta property="og:description" content="This book introduces the programming language R and is meant for undergrads or graduate students studying criminology. R is a programming language that is well-suited to the type of work frequently done in criminology - taking messy data and turning it into useful information. While R is a useful tool for many fields of study, this book focuses on the skills criminologists should know and uses crime data for the example data sets." />
<meta name="github-repo" content="jacobkap/crimebythenumbers" />

<meta name="author" content="Jacob Kaplan" />

<meta name="date" content="2020-07-20" />


<meta name="description" content="This book introduces the programming language R and is meant for undergrads or graduate students studying criminology. R is a programming language that is well-suited to the type of work frequently done in criminology - taking messy data and turning it into useful information. While R is a useful tool for many fields of study, this book focuses on the skills criminologists should know and uses crime data for the example data sets.">

<title>9 Choropleth maps | Crime by the Numbers</title>

<script src="libs/header-attrs-2.3.2/header-attrs.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#welcome">Welcome</a>
<ul>
<li><a href="why-learn-to-program.html#why-learn-to-program">Why learn to program?</a>
<ul>
<li><a href="why-learn-to-program.html#scale">Scale</a></li>
<li><a href="why-learn-to-program.html#reproducibility">Reproducibility</a></li>
</ul></li>
<li><a href="what-you-will-learn.html#what-you-will-learn">What you will learn</a>
<ul>
<li><a href="what-you-will-learn.html#skills">Skills</a></li>
<li><a href="what-you-will-learn.html#data">Data</a></li>
</ul></li>
<li><a href="what-you-wont-learn.html#what-you-wont-learn">What you won’t learn</a></li>
<li><a href="simple-vs-easy.html#simple-vs-easy">Simple vs Easy</a></li>
<li><a href="how-to-contribute.html#how-to-contribute">How to Contribute</a></li>
</ul></li>
<li><a href="about-the-author.html#about-the-author">About the author</a></li>
<li><a href="1-introduction-to-r-and-rstudio.html#introduction-to-r-and-rstudio"><span class="toc-section-number">1</span> Introduction to R and RStudio</a>
<ul>
<li><a href="1-1-using-rstudio.html#using-rstudio"><span class="toc-section-number">1.1</span> Using RStudio</a>
<ul>
<li><a href="1-1-using-rstudio.html#opening-an-r-script"><span class="toc-section-number">1.1.1</span> Opening an R Script</a></li>
<li><a href="1-1-using-rstudio.html#setting-the-working-directory"><span class="toc-section-number">1.1.2</span> Setting the working directory</a></li>
<li><a href="1-1-using-rstudio.html#changing-rstudio"><span class="toc-section-number">1.1.3</span> Changing RStudio</a></li>
<li><a href="1-1-using-rstudio.html#helpful-cheatsheets"><span class="toc-section-number">1.1.4</span> Helpful cheatsheets</a></li>
</ul></li>
<li><a href="1-2-reading-data-into-r.html#reading-data-into-r"><span class="toc-section-number">1.2</span> Reading data into R</a>
<ul>
<li><a href="1-2-reading-data-into-r.html#loading-data"><span class="toc-section-number">1.2.1</span> Loading data</a></li>
</ul></li>
<li><a href="1-3-first-steps-to-exploring-data.html#first-steps-to-exploring-data"><span class="toc-section-number">1.3</span> First steps to exploring data</a></li>
<li><a href="1-4-finding-help-about-functions.html#finding-help-about-functions"><span class="toc-section-number">1.4</span> Finding help about functions</a></li>
</ul></li>
<li class="part"><span><b>I Clean</b></span></li>
<li><a href="2-subsetting-intro.html#subsetting-intro"><span class="toc-section-number">2</span> Subsetting: Making big things small</a>
<ul>
<li><a href="2-1-select-specific-values.html#select-specific-values"><span class="toc-section-number">2.1</span> Select specific values</a></li>
<li><a href="2-2-assignment.html#assignment"><span class="toc-section-number">2.2</span> Assigning values to objects (Making “things”)</a></li>
<li><a href="2-3-vectors.html#vectors"><span class="toc-section-number">2.3</span> Vectors (collections of “things”)</a></li>
<li><a href="2-4-logical-values-and-operations.html#logical-values-and-operations"><span class="toc-section-number">2.4</span> Logical values and operations</a>
<ul>
<li><a href="2-4-logical-values-and-operations.html#matching-a-single-value"><span class="toc-section-number">2.4.1</span> Matching a single value</a></li>
<li><a href="2-4-logical-values-and-operations.html#matching-multiple-values"><span class="toc-section-number">2.4.2</span> Matching multiple values</a></li>
<li><a href="2-4-logical-values-and-operations.html#does-not-match"><span class="toc-section-number">2.4.3</span> Does not match</a></li>
<li><a href="2-4-logical-values-and-operations.html#greater-than-or-less-than"><span class="toc-section-number">2.4.4</span> Greater than or less than</a></li>
<li><a href="2-4-logical-values-and-operations.html#combining-conditional-statements---or-and"><span class="toc-section-number">2.4.5</span> Combining conditional statements - or, and</a></li>
</ul></li>
<li><a href="2-5-subsetting-a-data-frame.html#subsetting-a-data.frame"><span class="toc-section-number">2.5</span> Subsetting a data.frame</a>
<ul>
<li><a href="2-5-subsetting-a-data-frame.html#select-specific-columns"><span class="toc-section-number">2.5.1</span> Select specific columns</a></li>
<li><a href="2-5-subsetting-a-data-frame.html#select-specific-rows"><span class="toc-section-number">2.5.2</span> Select specific rows</a></li>
<li><a href="2-5-subsetting-a-data-frame.html#subset-colorado-data"><span class="toc-section-number">2.5.3</span> Subset Colorado data</a></li>
</ul></li>
</ul></li>
<li><a href="3-explore.html#explore"><span class="toc-section-number">3</span> Exploratory data analysis</a>
<ul>
<li><a href="3-1-summary-and-table.html#summary-and-table"><span class="toc-section-number">3.1</span> Summary and Table</a></li>
<li><a href="3-2-graphing.html#graphing"><span class="toc-section-number">3.2</span> Graphing</a></li>
<li><a href="3-3-aggregate.html#aggregate"><span class="toc-section-number">3.3</span> Aggregating (summaries of groups)</a></li>
</ul></li>
<li><a href="4-regular-expressions.html#regular-expressions"><span class="toc-section-number">4</span> Regular Expressions</a>
<ul>
<li><a href="4-1-finding-patterns-in-text-with-grep.html#finding-patterns-in-text-with-grep"><span class="toc-section-number">4.1</span> Finding patterns in text with <code>grep()</code></a></li>
<li><a href="4-2-finding-and-replacing-patterns-in-text-with-gsub.html#finding-and-replacing-patterns-in-text-with-gsub"><span class="toc-section-number">4.2</span> Finding and replacing patterns in text with <code>gsub()</code></a></li>
<li><a href="4-3-useful-special-characters.html#useful-special-characters"><span class="toc-section-number">4.3</span> Useful special characters</a>
<ul>
<li><a href="4-3-useful-special-characters.html#multiple-characters"><span class="toc-section-number">4.3.1</span> Multiple characters <code>[]</code></a></li>
<li><a href="4-3-useful-special-characters.html#n-many-of-previous-character-n"><span class="toc-section-number">4.3.2</span> n-many of previous character <code>{n}</code></a></li>
<li><a href="4-3-useful-special-characters.html#n-many-to-m-many-of-previous-character-nm"><span class="toc-section-number">4.3.3</span> n-many to m-many of previous character <code>{n,m}</code></a></li>
<li><a href="4-3-useful-special-characters.html#start-of-string"><span class="toc-section-number">4.3.4</span> Start of string</a></li>
<li><a href="4-3-useful-special-characters.html#end-of-string"><span class="toc-section-number">4.3.5</span> End of string <code>$</code></a></li>
<li><a href="4-3-useful-special-characters.html#anything-."><span class="toc-section-number">4.3.6</span> Anything <code>.</code></a></li>
<li><a href="4-3-useful-special-characters.html#one-or-more-of-previous"><span class="toc-section-number">4.3.7</span> One or more of previous <code>+</code></a></li>
<li><a href="4-3-useful-special-characters.html#zero-or-more-of-previous"><span class="toc-section-number">4.3.8</span> Zero or more of previous <code>*</code></a></li>
<li><a href="4-3-useful-special-characters.html#multiple-patterns"><span class="toc-section-number">4.3.9</span> Multiple patterns <code>|</code></a></li>
<li><a href="4-3-useful-special-characters.html#parentheses"><span class="toc-section-number">4.3.10</span> Parentheses <code>()</code></a></li>
<li><a href="4-3-useful-special-characters.html#optional-text"><span class="toc-section-number">4.3.11</span> Optional text <code>?</code></a></li>
</ul></li>
<li><a href="4-4-changing-capitalization.html#changing-capitalization"><span class="toc-section-number">4.4</span> Changing capitalization</a></li>
</ul></li>
<li><a href="5-reading-and-writing-data.html#reading-and-writing-data"><span class="toc-section-number">5</span> Reading and Writing Data</a>
<ul>
<li><a href="1-2-reading-data-into-r.html#reading-data-into-r"><span class="toc-section-number">5.1</span> Reading Data into R</a>
<ul>
<li><a href="5-1-reading-data-into-r.html#r"><span class="toc-section-number">5.1.1</span> R</a></li>
<li><a href="5-1-reading-data-into-r.html#excel"><span class="toc-section-number">5.1.2</span> Excel</a></li>
<li><a href="5-1-reading-data-into-r.html#stata"><span class="toc-section-number">5.1.3</span> Stata</a></li>
<li><a href="5-1-reading-data-into-r.html#sas"><span class="toc-section-number">5.1.4</span> SAS</a></li>
<li><a href="5-1-reading-data-into-r.html#spss"><span class="toc-section-number">5.1.5</span> SPSS</a></li>
</ul></li>
<li><a href="5-2-writing-data.html#writing-data"><span class="toc-section-number">5.2</span> Writing Data</a>
<ul>
<li><a href="5-2-writing-data.html#r-1"><span class="toc-section-number">5.2.1</span> R</a></li>
<li><a href="5-2-writing-data.html#excel-1"><span class="toc-section-number">5.2.2</span> Excel</a></li>
<li><a href="5-2-writing-data.html#stata-1"><span class="toc-section-number">5.2.3</span> Stata</a></li>
<li><a href="5-2-writing-data.html#sas-1"><span class="toc-section-number">5.2.4</span> SAS</a></li>
<li><a href="5-2-writing-data.html#spss-1"><span class="toc-section-number">5.2.5</span> SPSS</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Visualize</b></span></li>
<li><a href="6-graphing-intro.html#graphing-intro"><span class="toc-section-number">6</span> Graphing with <code>ggplot2</code></a>
<ul>
<li><a href="6-1-what-does-the-data-look-like.html#what-does-the-data-look-like"><span class="toc-section-number">6.1</span> What does the data look like?</a></li>
<li><a href="6-2-graphing-data.html#graphing-data"><span class="toc-section-number">6.2</span> Graphing data</a></li>
<li><a href="6-3-time-series-plots.html#time-series-plots"><span class="toc-section-number">6.3</span> Time-Series Plots</a></li>
<li><a href="6-4-scatter-plots.html#scatter-plots"><span class="toc-section-number">6.4</span> Scatter Plots</a></li>
<li><a href="6-5-color-blindness.html#color-blindness"><span class="toc-section-number">6.5</span> Color blindness</a></li>
</ul></li>
<li><a href="7-ois-graphs.html#ois_graphs"><span class="toc-section-number">7</span> More graphing with <code>ggplot2</code></a>
<ul>
<li><a href="7-1-exploring-data.html#exploring-data"><span class="toc-section-number">7.1</span> Exploring Data</a></li>
<li><a href="7-2-graphing-a-single-numeric-variable.html#graphing-a-single-numeric-variable"><span class="toc-section-number">7.2</span> Graphing a Single Numeric Variable</a>
<ul>
<li><a href="7-2-graphing-a-single-numeric-variable.html#histogram"><span class="toc-section-number">7.2.1</span> Histogram</a></li>
<li><a href="7-2-graphing-a-single-numeric-variable.html#density-plot"><span class="toc-section-number">7.2.2</span> Density plot</a></li>
<li><a href="7-2-graphing-a-single-numeric-variable.html#count-graph"><span class="toc-section-number">7.2.3</span> Count Graph</a></li>
</ul></li>
<li><a href="7-3-bar-graph.html#bar-graph"><span class="toc-section-number">7.3</span> Bar graph</a></li>
<li><a href="7-4-graphing-data-over-time.html#graphing-data-over-time"><span class="toc-section-number">7.4</span> Graphing Data Over Time</a></li>
<li><a href="7-5-pretty-graphs.html#pretty-graphs"><span class="toc-section-number">7.5</span> Pretty Graphs</a>
<ul>
<li><a href="7-5-pretty-graphs.html#themes"><span class="toc-section-number">7.5.1</span> Themes</a></li>
</ul></li>
</ul></li>
<li><a href="8-hotspot-maps.html#hotspot-maps"><span class="toc-section-number">8</span> Hotspot maps</a>
<ul>
<li><a href="8-1-a-simple-map.html#a-simple-map"><span class="toc-section-number">8.1</span> A simple map</a></li>
<li><a href="8-2-what-really-are-maps.html#what-really-are-maps"><span class="toc-section-number">8.2</span> What really are maps?</a></li>
<li><a href="8-3-making-a-hotspot-map.html#making-a-hotspot-map"><span class="toc-section-number">8.3</span> Making a hotspot map</a>
<ul>
<li><a href="8-3-making-a-hotspot-map.html#colors"><span class="toc-section-number">8.3.1</span> Colors</a></li>
</ul></li>
</ul></li>
<li><a href="9-choropleth-maps.html#choropleth-maps"><span class="toc-section-number">9</span> Choropleth maps</a>
<ul>
<li><a href="9-1-spatial-joins.html#spatial-joins"><span class="toc-section-number">9.1</span> Spatial joins</a></li>
<li><a href="9-2-making-choropleth-maps.html#making-choropleth-maps"><span class="toc-section-number">9.2</span> Making choropleth maps</a></li>
</ul></li>
<li><a href="10-interactive-maps.html#interactive-maps"><span class="toc-section-number">10</span> Interactive maps</a>
<ul>
<li><a href="10-1-why-do-interactive-graphs-matter.html#why-do-interactive-graphs-matter"><span class="toc-section-number">10.1</span> Why do interactive graphs matter?</a>
<ul>
<li><a href="10-1-why-do-interactive-graphs-matter.html#understanding-your-data"><span class="toc-section-number">10.1.1</span> Understanding your data</a></li>
<li><a href="10-1-why-do-interactive-graphs-matter.html#police-departments-use-them"><span class="toc-section-number">10.1.2</span> Police departments use them</a></li>
</ul></li>
<li><a href="10-2-making-the-interactive-map.html#making-the-interactive-map"><span class="toc-section-number">10.2</span> Making the interactive map</a></li>
<li><a href="10-3-adding-popup-information.html#adding-popup-information"><span class="toc-section-number">10.3</span> Adding popup information</a></li>
<li><a href="10-4-dealing-with-too-many-markers.html#dealing-with-too-many-markers"><span class="toc-section-number">10.4</span> Dealing with too many markers</a></li>
<li><a href="10-5-interactive-choropleth-maps.html#interactive-choropleth-maps"><span class="toc-section-number">10.5</span> Interactive choropleth maps</a></li>
</ul></li>
<li><a href="11-r-markdown.html#r-markdown"><span class="toc-section-number">11</span> R Markdown</a>
<ul>
<li><a href="1-1-using-rstudio.html#code"><span class="toc-section-number">11.1</span> Code</a>
<ul>
<li><a href="11-1-code.html#hiding-code-in-the-output"><span class="toc-section-number">11.1.1</span> Hiding code in the output</a></li>
</ul></li>
<li><a href="11-2-inline-code.html#inline-code"><span class="toc-section-number">11.2</span> Inline Code</a></li>
<li><a href="11-3-tables.html#tables"><span class="toc-section-number">11.3</span> Tables</a></li>
<li><a href="11-4-footnotes.html#footnotes"><span class="toc-section-number">11.4</span> Footnotes</a></li>
<li><a href="11-5-citation.html#citation"><span class="toc-section-number">11.5</span> Citation</a></li>
<li><a href="11-6-spell-check.html#spell-check"><span class="toc-section-number">11.6</span> Spell check</a></li>
<li><a href="11-7-making-the-output-file.html#making-the-output-file"><span class="toc-section-number">11.7</span> Making the output file</a></li>
</ul></li>
<li><a href="12-git.html#git"><span class="toc-section-number">12</span> Git</a>
<ul>
<li><a href="12-1-what-is-git-and-why-do-i-need-it.html#what-is-git-and-why-do-i-need-it"><span class="toc-section-number">12.1</span> What is Git and why do I need it?</a></li>
<li><a href="12-2-git-basics.html#git-basics"><span class="toc-section-number">12.2</span> Git basics</a></li>
<li><a href="12-3-when-to-commit.html#when-to-commit"><span class="toc-section-number">12.3</span> When to commit</a></li>
<li><a href="12-4-code-review.html#code-review"><span class="toc-section-number">12.4</span> Code review</a></li>
</ul></li>
<li class="part"><span><b>III Collect</b></span></li>
<li><a href="13-webscraping-with-rvest.html#webscraping-with-rvest"><span class="toc-section-number">13</span> Webscraping with <code>rvest</code></a>
<ul>
<li><a href="13-1-scraping-one-page.html#scraping-one-page"><span class="toc-section-number">13.1</span> Scraping one page</a></li>
<li><a href="13-2-cleaning-the-webscraped-data.html#cleaning-the-webscraped-data"><span class="toc-section-number">13.2</span> Cleaning the webscraped data</a></li>
</ul></li>
<li><a href="14-functions.html#functions"><span class="toc-section-number">14</span> Functions</a>
<ul>
<li><a href="14-1-a-simple-function.html#a-simple-function"><span class="toc-section-number">14.1</span> A simple function</a></li>
<li><a href="14-2-adding-parameters.html#adding-parameters"><span class="toc-section-number">14.2</span> Adding parameters</a></li>
<li><a href="14-3-recipes-function.html#recipes-function"><span class="toc-section-number">14.3</span> Making a function to scrape recipes</a></li>
</ul></li>
<li><a href="15-for-loops.html#for-loops"><span class="toc-section-number">15</span> For loops</a>
<ul>
<li><a href="15-1-basic-for-loops.html#basic-for-loops"><span class="toc-section-number">15.1</span> Basic for loops</a></li>
<li><a href="15-2-scraping-multiple-recipes.html#scraping-multiple-recipes"><span class="toc-section-number">15.2</span> Scraping multiple recipes</a></li>
</ul></li>
<li><a href="16-scrape-table.html#scrape-table"><span class="toc-section-number">16</span> Scraping tables from PDFs</a>
<ul>
<li><a href="16-1-scraping-the-first-table.html#scraping-the-first-table"><span class="toc-section-number">16.1</span> Scraping the first table</a></li>
<li><a href="16-2-making-a-function.html#making-a-function"><span class="toc-section-number">16.2</span> Making a function</a></li>
</ul></li>
<li><a href="17-scrape-table2.html#scrape-table2"><span class="toc-section-number">17</span> More scraping tables from PDFs</a>
<ul>
<li><a href="17-1-pregnant-women-incarcerated.html#pregnant-women-incarcerated"><span class="toc-section-number">17.1</span> Pregnant Women Incarcerated</a></li>
<li><a href="17-2-making-pdf-scraped-data-available-to-others.html#making-pdf-scraped-data-available-to-others"><span class="toc-section-number">17.2</span> Making PDF-scraped data available to others</a></li>
</ul></li>
<li><a href="18-geocoding.html#geocoding"><span class="toc-section-number">18</span> Geocoding</a>
<ul>
<li><a href="18-1-geocoding-a-single-address.html#geocoding-a-single-address"><span class="toc-section-number">18.1</span> Geocoding a single address</a></li>
<li><a href="16-2-making-a-function.html#making-a-function"><span class="toc-section-number">18.2</span> Making a function</a></li>
<li><a href="18-3-geocoding-san-francisco-marijuana-dispensary-locations.html#geocoding-san-francisco-marijuana-dispensary-locations"><span class="toc-section-number">18.3</span> Geocoding San Francisco marijuana dispensary locations</a></li>
</ul></li>
<li class="part"><span><b>IV Data</b></span></li>
<li><a href="19-introduction.html#introduction"><span class="toc-section-number">19</span> Introduction</a></li>
<li><a href="20-ucr.html#ucr"><span class="toc-section-number">20</span> Uniform Crime Report (UCR) - Offenses Known and Clearances by Arrest</a>
<ul>
<li><a href="20-1-exploring-the-ucr-data.html#exploring-the-ucr-data"><span class="toc-section-number">20.1</span> Exploring the UCR data</a></li>
<li><a href="20-2-oris-unique-agency-identifiers.html#oris---unique-agency-identifiers"><span class="toc-section-number">20.2</span> ORIs - Unique agency identifiers</a></li>
<li><a href="20-3-hierarchy-rule.html#hierarchy-rule"><span class="toc-section-number">20.3</span> Hierarchy Rule</a></li>
<li><a href="20-4-which-crimes-are-included.html#which-crimes-are-included"><span class="toc-section-number">20.4</span> Which crimes are included</a>
<ul>
<li><a href="20-4-which-crimes-are-included.html#index-crimes"><span class="toc-section-number">20.4.1</span> Index Crimes</a></li>
<li><a href="20-4-which-crimes-are-included.html#the-problem-with-using-index-crimes"><span class="toc-section-number">20.4.2</span> The problem with using index crimes</a></li>
<li><a href="20-4-which-crimes-are-included.html#rape-definition-change"><span class="toc-section-number">20.4.3</span> Rape definition change</a></li>
</ul></li>
<li><a href="20-5-actual-offenses-clearances-and-unfounded-offenses.html#actual-offenses-clearances-and-unfounded-offenses"><span class="toc-section-number">20.5</span> Actual offenses, clearances, and unfounded offenses</a>
<ul>
<li><a href="20-5-actual-offenses-clearances-and-unfounded-offenses.html#actual"><span class="toc-section-number">20.5.1</span> Actual</a></li>
<li><a href="20-5-actual-offenses-clearances-and-unfounded-offenses.html#total-cleared"><span class="toc-section-number">20.5.2</span> Total Cleared</a></li>
<li><a href="20-5-actual-offenses-clearances-and-unfounded-offenses.html#cleared-where-all-offenders-are-under-18"><span class="toc-section-number">20.5.3</span> Cleared Where All Offenders Are Under 18</a></li>
<li><a href="20-5-actual-offenses-clearances-and-unfounded-offenses.html#unfounded"><span class="toc-section-number">20.5.4</span> Unfounded</a></li>
</ul></li>
<li><a href="20-6-number-of-months-reported.html#number-of-months-reported"><span class="toc-section-number">20.6</span> Number of months reported</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li><a href="A-useful-resources.html#useful-resources"><span class="toc-section-number">A</span> Useful resources</a>
<ul>
<li><a href="A-1-learning-r-and-coding-issues.html#learning-r-and-coding-issues"><span class="toc-section-number">A.1</span> Learning R and coding issues</a></li>
<li><a href="what-you-will-learn.html#data"><span class="toc-section-number">A.2</span> Data</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="choropleth-maps" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Choropleth maps</h1>
<p>In Chapter <a href="8-hotspot-maps.html#hotspot-maps">8</a> we made hotspot maps to show which areas in San Francisco had the most suicides. We made the maps in a number of ways and consistently found that suicides were most prevalent in northeast San Francisco. In this lesson we will make choropleth maps, which are shaded maps where each “unit” is some known area such as a state or neighborhood. Think of election maps where states are colored blue when a Democratic candidate wins that state and red when a Republican candidate wins. These are choropleth maps - each state is colored to indicate something. In this lesson we will continue to work on the suicide data and make choropleth maps shaded by the number of suicides in each neighborhood (we will define this later in the lesson) in the city.</p>
<p>Since we will be working more on the suicide data from San Francisco, let’s read it in now.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="9-choropleth-maps.html#cb218-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb218-2"><a href="9-choropleth-maps.html#cb218-2"></a>suicide &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/san_francisco_suicide_2003_2017.csv&quot;</span>)</span>
<span id="cb218-3"><a href="9-choropleth-maps.html#cb218-3"></a><span class="co">#&gt; Parsed with column specification:</span></span>
<span id="cb218-4"><a href="9-choropleth-maps.html#cb218-4"></a><span class="co">#&gt; cols(</span></span>
<span id="cb218-5"><a href="9-choropleth-maps.html#cb218-5"></a><span class="co">#&gt;   IncidntNum = col_double(),</span></span>
<span id="cb218-6"><a href="9-choropleth-maps.html#cb218-6"></a><span class="co">#&gt;   Category = col_character(),</span></span>
<span id="cb218-7"><a href="9-choropleth-maps.html#cb218-7"></a><span class="co">#&gt;   Descript = col_character(),</span></span>
<span id="cb218-8"><a href="9-choropleth-maps.html#cb218-8"></a><span class="co">#&gt;   DayOfWeek = col_character(),</span></span>
<span id="cb218-9"><a href="9-choropleth-maps.html#cb218-9"></a><span class="co">#&gt;   Date = col_character(),</span></span>
<span id="cb218-10"><a href="9-choropleth-maps.html#cb218-10"></a><span class="co">#&gt;   Time = col_time(format = &quot;&quot;),</span></span>
<span id="cb218-11"><a href="9-choropleth-maps.html#cb218-11"></a><span class="co">#&gt;   PdDistrict = col_character(),</span></span>
<span id="cb218-12"><a href="9-choropleth-maps.html#cb218-12"></a><span class="co">#&gt;   Resolution = col_character(),</span></span>
<span id="cb218-13"><a href="9-choropleth-maps.html#cb218-13"></a><span class="co">#&gt;   Address = col_character(),</span></span>
<span id="cb218-14"><a href="9-choropleth-maps.html#cb218-14"></a><span class="co">#&gt;   X = col_double(),</span></span>
<span id="cb218-15"><a href="9-choropleth-maps.html#cb218-15"></a><span class="co">#&gt;   Y = col_double(),</span></span>
<span id="cb218-16"><a href="9-choropleth-maps.html#cb218-16"></a><span class="co">#&gt;   Location = col_character(),</span></span>
<span id="cb218-17"><a href="9-choropleth-maps.html#cb218-17"></a><span class="co">#&gt;   PdId = col_double(),</span></span>
<span id="cb218-18"><a href="9-choropleth-maps.html#cb218-18"></a><span class="co">#&gt;   year = col_double()</span></span>
<span id="cb218-19"><a href="9-choropleth-maps.html#cb218-19"></a><span class="co">#&gt; )</span></span>
<span id="cb218-20"><a href="9-choropleth-maps.html#cb218-20"></a>suicide &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(suicide)</span></code></pre></div>
<p>The package that we will use to handle geographic data and do most of the work in this lesson is <code>sf</code>. <code>sf</code> is a sophisticated package and does far more than what we will cover in this lesson. For more information about the package’s features please see the website for it <a href="http://r-spatial.github.io/sf/">here</a>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="9-choropleth-maps.html#cb219-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="9-choropleth-maps.html#cb220-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb220-2"><a href="9-choropleth-maps.html#cb220-2"></a><span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1</span></span></code></pre></div>
<p>For this lesson we will need to read in a shapefile that depicts the boundaries of each neighborhood in San Francisco. A shapefile is similar to a data.frame but has information on how to draw a geographic boundary such as a state. The way <code>sf</code> reads in the shapefiles is through the <code>st_read()</code> function. Our input inside the () is a string with the name of the “.shp” file we want to read in (since we are telling R to read a file on the computer rather than an object that exists, it needs to be in quotes). This shapefile contains neighborhoods in San Francisco so we’ll call the object <em>sf_neighborhoods</em>.</p>
<p>I downloaded this data from San Francisco’s Open Data site <a href="https://data.sfgov.org/Geographic-Locations-and-Boundaries/Analysis-Neighborhoods/p5b7-5n3h">here</a>, selecting the Shapefile format in the Export tab. If you do so yourself it’ll give you a zip file with multiple files in there. This is normal with shapefiles, you will have multiple files and only read in the file with the “.shp” extension to R. We still <strong>do</strong> need all of the files and <code>st_read()</code> is using them even if not explicitly called. So make sure every file downloaded is in the same working directory as the .shp file. The files from this site had hard to understand file names so I relabeled them all as “san_francisco_neighborhoods” though that doesn’t matter once it’s read into R.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="9-choropleth-maps.html#cb221-1"></a>sf_neighborhoods &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/san_francisco_neighborhoods.shp&quot;</span>)</span>
<span id="cb221-2"><a href="9-choropleth-maps.html#cb221-2"></a><span class="co">#&gt; Reading layer `san_francisco_neighborhoods&#39; from data source `C:\Users\user\Dropbox\R_project\crimebythenumbers\data\san_francisco_neighborhoods.shp&#39; using driver `ESRI Shapefile&#39;</span></span>
<span id="cb221-3"><a href="9-choropleth-maps.html#cb221-3"></a><span class="co">#&gt; Simple feature collection with 41 features and 1 field</span></span>
<span id="cb221-4"><a href="9-choropleth-maps.html#cb221-4"></a><span class="co">#&gt; geometry type:  MULTIPOLYGON</span></span>
<span id="cb221-5"><a href="9-choropleth-maps.html#cb221-5"></a><span class="co">#&gt; dimension:      XY</span></span>
<span id="cb221-6"><a href="9-choropleth-maps.html#cb221-6"></a><span class="co">#&gt; bbox:           xmin: -122.5149 ymin: 37.70813 xmax: -122.357 ymax: 37.8333</span></span>
<span id="cb221-7"><a href="9-choropleth-maps.html#cb221-7"></a><span class="co">#&gt; geographic CRS: WGS84(DD)</span></span></code></pre></div>
<p>As usual when dealing with a new data set, let’s look at the first 6 rows.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="9-choropleth-maps.html#cb222-1"></a><span class="kw">head</span>(sf_neighborhoods)</span>
<span id="cb222-2"><a href="9-choropleth-maps.html#cb222-2"></a><span class="co">#&gt; Simple feature collection with 6 features and 1 field</span></span>
<span id="cb222-3"><a href="9-choropleth-maps.html#cb222-3"></a><span class="co">#&gt; geometry type:  MULTIPOLYGON</span></span>
<span id="cb222-4"><a href="9-choropleth-maps.html#cb222-4"></a><span class="co">#&gt; dimension:      XY</span></span>
<span id="cb222-5"><a href="9-choropleth-maps.html#cb222-5"></a><span class="co">#&gt; bbox:           xmin: -122.4543 ymin: 37.70822 xmax: -122.357 ymax: 37.80602</span></span>
<span id="cb222-6"><a href="9-choropleth-maps.html#cb222-6"></a><span class="co">#&gt; geographic CRS: WGS84(DD)</span></span>
<span id="cb222-7"><a href="9-choropleth-maps.html#cb222-7"></a><span class="co">#&gt;                            nhood                       geometry</span></span>
<span id="cb222-8"><a href="9-choropleth-maps.html#cb222-8"></a><span class="co">#&gt; 1          Bayview Hunters Point MULTIPOLYGON (((-122.3816 3...</span></span>
<span id="cb222-9"><a href="9-choropleth-maps.html#cb222-9"></a><span class="co">#&gt; 2                 Bernal Heights MULTIPOLYGON (((-122.4036 3...</span></span>
<span id="cb222-10"><a href="9-choropleth-maps.html#cb222-10"></a><span class="co">#&gt; 3            Castro/Upper Market MULTIPOLYGON (((-122.4266 3...</span></span>
<span id="cb222-11"><a href="9-choropleth-maps.html#cb222-11"></a><span class="co">#&gt; 4                      Chinatown MULTIPOLYGON (((-122.4062 3...</span></span>
<span id="cb222-12"><a href="9-choropleth-maps.html#cb222-12"></a><span class="co">#&gt; 5                      Excelsior MULTIPOLYGON (((-122.424 37...</span></span>
<span id="cb222-13"><a href="9-choropleth-maps.html#cb222-13"></a><span class="co">#&gt; 6 Financial District/South Beach MULTIPOLYGON (((-122.3875 3...</span></span></code></pre></div>
<p>The last column is important. In shapefiles, the “geometry” column is the one with the instructions to make the map. This data has a single row for each neighborhood in the city. So the “geometry” column in each row has a list of coordinates which, if connected in order, make up that neighborhood. Since the “geometry” column contains the instructions to map, we can <code>plot()</code> it to show a map of the data.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="9-choropleth-maps.html#cb223-1"></a><span class="kw">plot</span>(sf_neighborhoods<span class="op">$</span>geometry)</span></code></pre></div>
<p><img src="choropleth-maps_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here we have a map of San Francisco broken up into neighborhoods. Is this a perfect representation of the neighborhoods in San Francisco? No. It is simply the city’s attempt to create definitions of neighborhoods. Indeed, you’re likely to find that areas at the border of neighborhoods are more similar to each other than they are to areas at the opposite side of their designated neighborhood. You can read a bit about how San Francisco determined the neighborhood boundaries <a href="https://data.sfgov.org/Geographic-Locations-and-Boundaries/Analysis-Neighborhoods/p5b7-5n3h">here</a> but know that this, like all geographic areas that someone has designated, has some degree of inaccuracy and arbitrariness in it. Like many things in criminology, this is just another limitation we will have to keep in mind.</p>
<p>In the <code>head()</code> results there was a section about something called “epsg” and “proj4string”. Let’s talk about that specifically since they are important for working with spatial data. A way to get just those two results in the <code>st_crs()</code> function which is part of <code>sf</code>. Let’s look at the “coordinate reference system” (CRS) for <code>sf_neighborhoods</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="9-choropleth-maps.html#cb224-1"></a><span class="kw">st_crs</span>(sf_neighborhoods)</span>
<span id="cb224-2"><a href="9-choropleth-maps.html#cb224-2"></a>Coordinate Reference System<span class="op">:</span></span>
<span id="cb224-3"><a href="9-choropleth-maps.html#cb224-3"></a><span class="st">  </span>User input<span class="op">:</span><span class="st"> </span><span class="kw">WGS84</span>(DD) </span>
<span id="cb224-4"><a href="9-choropleth-maps.html#cb224-4"></a>  wkt<span class="op">:</span></span>
<span id="cb224-5"><a href="9-choropleth-maps.html#cb224-5"></a>GEOGCRS[<span class="st">&quot;WGS84(DD)&quot;</span>,</span>
<span id="cb224-6"><a href="9-choropleth-maps.html#cb224-6"></a>    DATUM[<span class="st">&quot;WGS84&quot;</span>,</span>
<span id="cb224-7"><a href="9-choropleth-maps.html#cb224-7"></a>        ELLIPSOID[<span class="st">&quot;WGS84&quot;</span>,<span class="dv">6378137</span>,<span class="fl">298.257223563</span>,</span>
<span id="cb224-8"><a href="9-choropleth-maps.html#cb224-8"></a>            LENGTHUNIT[<span class="st">&quot;metre&quot;</span>,<span class="dv">1</span>,</span>
<span id="cb224-9"><a href="9-choropleth-maps.html#cb224-9"></a>                ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">9001</span>]]]],</span>
<span id="cb224-10"><a href="9-choropleth-maps.html#cb224-10"></a>    PRIMEM[<span class="st">&quot;Greenwich&quot;</span>,<span class="dv">0</span>,</span>
<span id="cb224-11"><a href="9-choropleth-maps.html#cb224-11"></a>        ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>]],</span>
<span id="cb224-12"><a href="9-choropleth-maps.html#cb224-12"></a>    CS[ellipsoidal,<span class="dv">2</span>],</span>
<span id="cb224-13"><a href="9-choropleth-maps.html#cb224-13"></a>        AXIS[<span class="st">&quot;geodetic longitude&quot;</span>,east,</span>
<span id="cb224-14"><a href="9-choropleth-maps.html#cb224-14"></a>            ORDER[<span class="dv">1</span>],</span>
<span id="cb224-15"><a href="9-choropleth-maps.html#cb224-15"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>]],</span>
<span id="cb224-16"><a href="9-choropleth-maps.html#cb224-16"></a>        AXIS[<span class="st">&quot;geodetic latitude&quot;</span>,north,</span>
<span id="cb224-17"><a href="9-choropleth-maps.html#cb224-17"></a>            ORDER[<span class="dv">2</span>],</span>
<span id="cb224-18"><a href="9-choropleth-maps.html#cb224-18"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>]]]</span></code></pre></div>
<p>An issue with working with geographic data is that <a href="https://en.wikipedia.org/wiki/Spherical_Earth">the Earth is not flat</a>. Since the Earth is spherical, there will always be some distortion when trying to plot the data on a flat surface such as a map. To account for this we need to transform the longitude and latitude values we generally have to work properly on a map. We do so by “projecting” our data onto the areas of the Earth we want. This is a complex field with lots of work done on it (both abstractly and for R specifically) so this lesson will be an extremely brief overview of the topic and oversimplify some aspects of it.</p>
<p>If we look at the output of <code>st_crs(sf_neighborhoods)</code> we can see that the EPSG is set to 4326 and the proj4string (which tells us the current map projection) is “+proj=longlat +datum=WGS84 +no_defs”. This CRS, WGS84, is a standard CRS and is the one used whenever you use a GPS to find a location. To find the CRS for certain parts of the world see <a href="https://spatialreference.org/">here</a>. If you search that site for “California” you’ll see that California is broken into 6 zones. The site isn’t that helpful on which zones are which but some Googling can often find state or region maps with the zones depicted there. We want California zone 3 which has the EPSG code 2227. We’ll use this code to project this data properly.</p>
<p>If we want to get the proj4string for 2227 we can use</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="9-choropleth-maps.html#cb225-1"></a><span class="kw">st_crs</span>(<span class="dv">2227</span>)</span>
<span id="cb225-2"><a href="9-choropleth-maps.html#cb225-2"></a><span class="co">#&gt; Coordinate Reference System:</span></span>
<span id="cb225-3"><a href="9-choropleth-maps.html#cb225-3"></a><span class="co">#&gt;   User input: EPSG:2227 </span></span>
<span id="cb225-4"><a href="9-choropleth-maps.html#cb225-4"></a><span class="co">#&gt;   wkt:</span></span>
<span id="cb225-5"><a href="9-choropleth-maps.html#cb225-5"></a><span class="co">#&gt; PROJCRS[&quot;NAD83 / California zone 3 (ftUS)&quot;,</span></span>
<span id="cb225-6"><a href="9-choropleth-maps.html#cb225-6"></a><span class="co">#&gt;     BASEGEOGCRS[&quot;NAD83&quot;,</span></span>
<span id="cb225-7"><a href="9-choropleth-maps.html#cb225-7"></a><span class="co">#&gt;         DATUM[&quot;North American Datum 1983&quot;,</span></span>
<span id="cb225-8"><a href="9-choropleth-maps.html#cb225-8"></a><span class="co">#&gt;             ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101,</span></span>
<span id="cb225-9"><a href="9-choropleth-maps.html#cb225-9"></a><span class="co">#&gt;                 LENGTHUNIT[&quot;metre&quot;,1]]],</span></span>
<span id="cb225-10"><a href="9-choropleth-maps.html#cb225-10"></a><span class="co">#&gt;         PRIMEM[&quot;Greenwich&quot;,0,</span></span>
<span id="cb225-11"><a href="9-choropleth-maps.html#cb225-11"></a><span class="co">#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],</span></span>
<span id="cb225-12"><a href="9-choropleth-maps.html#cb225-12"></a><span class="co">#&gt;         ID[&quot;EPSG&quot;,4269]],</span></span>
<span id="cb225-13"><a href="9-choropleth-maps.html#cb225-13"></a><span class="co">#&gt;     CONVERSION[&quot;SPCS83 California zone 3 (US Survey feet)&quot;,</span></span>
<span id="cb225-14"><a href="9-choropleth-maps.html#cb225-14"></a><span class="co">#&gt;         METHOD[&quot;Lambert Conic Conformal (2SP)&quot;,</span></span>
<span id="cb225-15"><a href="9-choropleth-maps.html#cb225-15"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,9802]],</span></span>
<span id="cb225-16"><a href="9-choropleth-maps.html#cb225-16"></a><span class="co">#&gt;         PARAMETER[&quot;Latitude of false origin&quot;,36.5,</span></span>
<span id="cb225-17"><a href="9-choropleth-maps.html#cb225-17"></a><span class="co">#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],</span></span>
<span id="cb225-18"><a href="9-choropleth-maps.html#cb225-18"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,8821]],</span></span>
<span id="cb225-19"><a href="9-choropleth-maps.html#cb225-19"></a><span class="co">#&gt;         PARAMETER[&quot;Longitude of false origin&quot;,-120.5,</span></span>
<span id="cb225-20"><a href="9-choropleth-maps.html#cb225-20"></a><span class="co">#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],</span></span>
<span id="cb225-21"><a href="9-choropleth-maps.html#cb225-21"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,8822]],</span></span>
<span id="cb225-22"><a href="9-choropleth-maps.html#cb225-22"></a><span class="co">#&gt;         PARAMETER[&quot;Latitude of 1st standard parallel&quot;,38.4333333333333,</span></span>
<span id="cb225-23"><a href="9-choropleth-maps.html#cb225-23"></a><span class="co">#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],</span></span>
<span id="cb225-24"><a href="9-choropleth-maps.html#cb225-24"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,8823]],</span></span>
<span id="cb225-25"><a href="9-choropleth-maps.html#cb225-25"></a><span class="co">#&gt;         PARAMETER[&quot;Latitude of 2nd standard parallel&quot;,37.0666666666667,</span></span>
<span id="cb225-26"><a href="9-choropleth-maps.html#cb225-26"></a><span class="co">#&gt;             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],</span></span>
<span id="cb225-27"><a href="9-choropleth-maps.html#cb225-27"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,8824]],</span></span>
<span id="cb225-28"><a href="9-choropleth-maps.html#cb225-28"></a><span class="co">#&gt;         PARAMETER[&quot;Easting at false origin&quot;,6561666.667,</span></span>
<span id="cb225-29"><a href="9-choropleth-maps.html#cb225-29"></a><span class="co">#&gt;             LENGTHUNIT[&quot;US survey foot&quot;,0.304800609601219],</span></span>
<span id="cb225-30"><a href="9-choropleth-maps.html#cb225-30"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,8826]],</span></span>
<span id="cb225-31"><a href="9-choropleth-maps.html#cb225-31"></a><span class="co">#&gt;         PARAMETER[&quot;Northing at false origin&quot;,1640416.667,</span></span>
<span id="cb225-32"><a href="9-choropleth-maps.html#cb225-32"></a><span class="co">#&gt;             LENGTHUNIT[&quot;US survey foot&quot;,0.304800609601219],</span></span>
<span id="cb225-33"><a href="9-choropleth-maps.html#cb225-33"></a><span class="co">#&gt;             ID[&quot;EPSG&quot;,8827]]],</span></span>
<span id="cb225-34"><a href="9-choropleth-maps.html#cb225-34"></a><span class="co">#&gt;     CS[Cartesian,2],</span></span>
<span id="cb225-35"><a href="9-choropleth-maps.html#cb225-35"></a><span class="co">#&gt;         AXIS[&quot;easting (X)&quot;,east,</span></span>
<span id="cb225-36"><a href="9-choropleth-maps.html#cb225-36"></a><span class="co">#&gt;             ORDER[1],</span></span>
<span id="cb225-37"><a href="9-choropleth-maps.html#cb225-37"></a><span class="co">#&gt;             LENGTHUNIT[&quot;US survey foot&quot;,0.304800609601219]],</span></span>
<span id="cb225-38"><a href="9-choropleth-maps.html#cb225-38"></a><span class="co">#&gt;         AXIS[&quot;northing (Y)&quot;,north,</span></span>
<span id="cb225-39"><a href="9-choropleth-maps.html#cb225-39"></a><span class="co">#&gt;             ORDER[2],</span></span>
<span id="cb225-40"><a href="9-choropleth-maps.html#cb225-40"></a><span class="co">#&gt;             LENGTHUNIT[&quot;US survey foot&quot;,0.304800609601219]],</span></span>
<span id="cb225-41"><a href="9-choropleth-maps.html#cb225-41"></a><span class="co">#&gt;     USAGE[</span></span>
<span id="cb225-42"><a href="9-choropleth-maps.html#cb225-42"></a><span class="co">#&gt;         SCOPE[&quot;unknown&quot;],</span></span>
<span id="cb225-43"><a href="9-choropleth-maps.html#cb225-43"></a><span class="co">#&gt;         AREA[&quot;USA - California - SPCS - 3&quot;],</span></span>
<span id="cb225-44"><a href="9-choropleth-maps.html#cb225-44"></a><span class="co">#&gt;         BBOX[36.73,-123.02,38.71,-117.83]],</span></span>
<span id="cb225-45"><a href="9-choropleth-maps.html#cb225-45"></a><span class="co">#&gt;     ID[&quot;EPSG&quot;,2227]]</span></span></code></pre></div>
<p>Note the text in “prj4string” that says “+units=us-ft”. This means that the units are in feet. Some projections have units in meters so be mindful of this when doing some analysis such as seeing if a point is within X feet of a certain area.</p>
<p>Let’s convert our sf_neighborhoods data to coordinate reference system 2227.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="9-choropleth-maps.html#cb226-1"></a>sf_neighborhoods &lt;-<span class="st"> </span><span class="kw">st_transform</span>(sf_neighborhoods, <span class="dt">crs =</span> <span class="dv">2227</span>)</span>
<span id="cb226-2"><a href="9-choropleth-maps.html#cb226-2"></a><span class="kw">st_crs</span>(sf_neighborhoods)</span>
<span id="cb226-3"><a href="9-choropleth-maps.html#cb226-3"></a>Coordinate Reference System<span class="op">:</span></span>
<span id="cb226-4"><a href="9-choropleth-maps.html#cb226-4"></a><span class="st">  </span>User input<span class="op">:</span><span class="st"> </span>EPSG<span class="op">:</span><span class="dv">2227</span> </span>
<span id="cb226-5"><a href="9-choropleth-maps.html#cb226-5"></a>  wkt<span class="op">:</span></span>
<span id="cb226-6"><a href="9-choropleth-maps.html#cb226-6"></a>PROJCRS[<span class="st">&quot;NAD83 / California zone 3 (ftUS)&quot;</span>,</span>
<span id="cb226-7"><a href="9-choropleth-maps.html#cb226-7"></a>    BASEGEOGCRS[<span class="st">&quot;NAD83&quot;</span>,</span>
<span id="cb226-8"><a href="9-choropleth-maps.html#cb226-8"></a>        DATUM[<span class="st">&quot;North American Datum 1983&quot;</span>,</span>
<span id="cb226-9"><a href="9-choropleth-maps.html#cb226-9"></a>            ELLIPSOID[<span class="st">&quot;GRS 1980&quot;</span>,<span class="dv">6378137</span>,<span class="fl">298.257222101</span>,</span>
<span id="cb226-10"><a href="9-choropleth-maps.html#cb226-10"></a>                LENGTHUNIT[<span class="st">&quot;metre&quot;</span>,<span class="dv">1</span>]]],</span>
<span id="cb226-11"><a href="9-choropleth-maps.html#cb226-11"></a>        PRIMEM[<span class="st">&quot;Greenwich&quot;</span>,<span class="dv">0</span>,</span>
<span id="cb226-12"><a href="9-choropleth-maps.html#cb226-12"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>]],</span>
<span id="cb226-13"><a href="9-choropleth-maps.html#cb226-13"></a>        ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">4269</span>]],</span>
<span id="cb226-14"><a href="9-choropleth-maps.html#cb226-14"></a>    CONVERSION[<span class="st">&quot;SPCS83 California zone 3 (US Survey feet)&quot;</span>,</span>
<span id="cb226-15"><a href="9-choropleth-maps.html#cb226-15"></a>        METHOD[<span class="st">&quot;Lambert Conic Conformal (2SP)&quot;</span>,</span>
<span id="cb226-16"><a href="9-choropleth-maps.html#cb226-16"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">9802</span>]],</span>
<span id="cb226-17"><a href="9-choropleth-maps.html#cb226-17"></a>        PARAMETER[<span class="st">&quot;Latitude of false origin&quot;</span>,<span class="fl">36.5</span>,</span>
<span id="cb226-18"><a href="9-choropleth-maps.html#cb226-18"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>],</span>
<span id="cb226-19"><a href="9-choropleth-maps.html#cb226-19"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">8821</span>]],</span>
<span id="cb226-20"><a href="9-choropleth-maps.html#cb226-20"></a>        PARAMETER[<span class="st">&quot;Longitude of false origin&quot;</span>,<span class="op">-</span><span class="fl">120.5</span>,</span>
<span id="cb226-21"><a href="9-choropleth-maps.html#cb226-21"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>],</span>
<span id="cb226-22"><a href="9-choropleth-maps.html#cb226-22"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">8822</span>]],</span>
<span id="cb226-23"><a href="9-choropleth-maps.html#cb226-23"></a>        PARAMETER[<span class="st">&quot;Latitude of 1st standard parallel&quot;</span>,<span class="fl">38.4333333333333</span>,</span>
<span id="cb226-24"><a href="9-choropleth-maps.html#cb226-24"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>],</span>
<span id="cb226-25"><a href="9-choropleth-maps.html#cb226-25"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">8823</span>]],</span>
<span id="cb226-26"><a href="9-choropleth-maps.html#cb226-26"></a>        PARAMETER[<span class="st">&quot;Latitude of 2nd standard parallel&quot;</span>,<span class="fl">37.0666666666667</span>,</span>
<span id="cb226-27"><a href="9-choropleth-maps.html#cb226-27"></a>            ANGLEUNIT[<span class="st">&quot;degree&quot;</span>,<span class="fl">0.0174532925199433</span>],</span>
<span id="cb226-28"><a href="9-choropleth-maps.html#cb226-28"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">8824</span>]],</span>
<span id="cb226-29"><a href="9-choropleth-maps.html#cb226-29"></a>        PARAMETER[<span class="st">&quot;Easting at false origin&quot;</span>,<span class="fl">6561666.667</span>,</span>
<span id="cb226-30"><a href="9-choropleth-maps.html#cb226-30"></a>            LENGTHUNIT[<span class="st">&quot;US survey foot&quot;</span>,<span class="fl">0.304800609601219</span>],</span>
<span id="cb226-31"><a href="9-choropleth-maps.html#cb226-31"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">8826</span>]],</span>
<span id="cb226-32"><a href="9-choropleth-maps.html#cb226-32"></a>        PARAMETER[<span class="st">&quot;Northing at false origin&quot;</span>,<span class="fl">1640416.667</span>,</span>
<span id="cb226-33"><a href="9-choropleth-maps.html#cb226-33"></a>            LENGTHUNIT[<span class="st">&quot;US survey foot&quot;</span>,<span class="fl">0.304800609601219</span>],</span>
<span id="cb226-34"><a href="9-choropleth-maps.html#cb226-34"></a>            ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">8827</span>]]],</span>
<span id="cb226-35"><a href="9-choropleth-maps.html#cb226-35"></a>    CS[Cartesian,<span class="dv">2</span>],</span>
<span id="cb226-36"><a href="9-choropleth-maps.html#cb226-36"></a>        AXIS[<span class="st">&quot;easting (X)&quot;</span>,east,</span>
<span id="cb226-37"><a href="9-choropleth-maps.html#cb226-37"></a>            ORDER[<span class="dv">1</span>],</span>
<span id="cb226-38"><a href="9-choropleth-maps.html#cb226-38"></a>            LENGTHUNIT[<span class="st">&quot;US survey foot&quot;</span>,<span class="fl">0.304800609601219</span>]],</span>
<span id="cb226-39"><a href="9-choropleth-maps.html#cb226-39"></a>        AXIS[<span class="st">&quot;northing (Y)&quot;</span>,north,</span>
<span id="cb226-40"><a href="9-choropleth-maps.html#cb226-40"></a>            ORDER[<span class="dv">2</span>],</span>
<span id="cb226-41"><a href="9-choropleth-maps.html#cb226-41"></a>            LENGTHUNIT[<span class="st">&quot;US survey foot&quot;</span>,<span class="fl">0.304800609601219</span>]],</span>
<span id="cb226-42"><a href="9-choropleth-maps.html#cb226-42"></a>    USAGE[</span>
<span id="cb226-43"><a href="9-choropleth-maps.html#cb226-43"></a>        SCOPE[<span class="st">&quot;unknown&quot;</span>],</span>
<span id="cb226-44"><a href="9-choropleth-maps.html#cb226-44"></a>        AREA[<span class="st">&quot;USA - California - SPCS - 3&quot;</span>],</span>
<span id="cb226-45"><a href="9-choropleth-maps.html#cb226-45"></a>        BBOX[<span class="fl">36.73</span>,<span class="op">-</span><span class="fl">123.02</span>,<span class="fl">38.71</span>,<span class="op">-</span><span class="fl">117.83</span>]],</span>
<span id="cb226-46"><a href="9-choropleth-maps.html#cb226-46"></a>    ID[<span class="st">&quot;EPSG&quot;</span>,<span class="dv">2227</span>]]</span></code></pre></div>
</div>
<p style="text-align: center;">
<a href="8-3-making-a-hotspot-map.html"><button class="btn btn-default">Previous</button></a>
<a href="9-1-spatial-joins.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
